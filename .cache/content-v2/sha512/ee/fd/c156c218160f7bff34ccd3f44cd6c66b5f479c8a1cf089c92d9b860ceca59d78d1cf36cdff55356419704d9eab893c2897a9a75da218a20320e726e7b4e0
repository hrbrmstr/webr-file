/**
 * Bundled by jsDelivr using Rollup v2.74.1 and Terser v5.15.1.
 * Original file: /npm/@observablehq/plot@0.6.4/dist/index.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{timeSecond as t,timeMinute as n,timeHour as e,timeDay as r,timeWeek as o,timeMonth as i,timeYear as a,timeMonday as l,timeTuesday as s,timeWednesday as c,timeThursday as u,timeFriday as f,timeSaturday as h,timeSunday as d,utcSecond as p,utcMinute as m,utcHour as y,utcDay as g,utcWeek as v,utcMonth as x,utcYear as w,utcMonday as b,utcTuesday as k,utcWednesday as $,utcThursday as M,utcFriday as L,utcSaturday as A,utcSunday as E,quantile as z,range as O,color as N,descending as S,symbolAsterisk as C,symbolCircle as R,symbolCross as T,symbolDiamond as j,symbolDiamond2 as W,symbolPlus as B,symbolSquare as D,symbolSquare2 as F,symbolStar as q,symbolTimes as _,symbolTriangle as I,symbolTriangle2 as P,symbolWye as U,ascending as H,randomLcg as V,sort as Y,group as Z,mode as G,variance as J,mean as K,maxIndex as Q,max as X,minIndex as tt,min as nt,deviation as et,sum as rt,rollup as ot,InternSet as it,median as at,schemeAccent as lt,schemeCategory10 as st,schemeDark2 as ct,schemePaired as ut,schemePastel1 as ft,schemePastel2 as ht,schemeSet1 as dt,schemeSet2 as pt,schemeSet3 as mt,schemeTableau10 as yt,quantize as gt,interpolatePRGn as vt,schemePRGn as xt,interpolatePiYG as wt,schemePiYG as bt,interpolatePuOr as kt,schemePuOr as $t,interpolateRdBu as Mt,schemeRdBu as Lt,interpolateRdGy as At,schemeRdGy as Et,interpolateRdYlBu as zt,schemeRdYlBu as Ot,interpolateRdYlGn as Nt,schemeRdYlGn as St,interpolateSpectral as Ct,schemeSpectral as Rt,interpolateGreens as Tt,schemeGreens as jt,interpolateGreys as Wt,schemeGreys as Bt,interpolateOranges as Dt,schemeOranges as Ft,interpolatePurples as qt,schemePurples as _t,interpolateReds as It,schemeReds as Pt,interpolateViridis as Ut,interpolateMagma as Ht,interpolateInferno as Vt,interpolatePlasma as Yt,interpolateCividis as Zt,interpolateCubehelixDefault as Gt,interpolateWarm as Jt,interpolateCool as Kt,interpolateBuGn as Qt,schemeBuGn as Xt,interpolateBuPu as tn,schemeBuPu as nn,interpolateGnBu as en,schemeGnBu as rn,interpolateOrRd as on,schemeOrRd as an,interpolatePuBu as ln,schemePuBu as sn,interpolatePuBuGn as cn,schemePuBuGn as un,interpolatePuRd as fn,schemePuRd as hn,interpolateRdPu as dn,schemeRdPu as pn,interpolateYlGn as mn,schemeYlGn as yn,interpolateYlGnBu as gn,schemeYlGnBu as vn,interpolateYlOrBr as xn,schemeYlOrBr as wn,interpolateYlOrRd as bn,schemeYlOrRd as kn,interpolateSinebow as $n,interpolateBrBG as Mn,interpolateBlues as Ln,interpolateTurbo as An,interpolateRainbow as En,schemeBrBG as zn,schemeBlues as On,scaleIdentity as Nn,scaleSymlog as Sn,scaleLog as Cn,scalePow as Rn,scaleThreshold as Tn,reverse as jn,scaleLinear as Wn,extent as Bn,interpolateRgb as Dn,interpolateRound as Fn,interpolateNumber as qn,scaleQuantile as _n,ticks as In,interpolateHsl as Pn,interpolateHcl as Un,interpolateLab as Hn,scaleDivergingSymlog as Vn,scaleDivergingLog as Yn,scaleDivergingPow as Zn,scaleDiverging as Gn,piecewise as Jn,scaleTime as Kn,scaleUtc as Qn,scaleBand as Xn,scalePoint as te,scaleOrdinal as ne,symbolsStroke as ee,symbolsFill as re,scaleImplicit as oe,geoTransform as ie,geoPath as ae,geoStereographic as le,geoOrthographic as se,geoMercator as ce,geoGnomonic as ue,geoEquirectangular as fe,geoEqualEarth as he,geoAzimuthalEquidistant as de,geoAzimuthalEqualArea as pe,geoAlbersUsa as me,geoClipRectangle as ye,geoTransverseMercator as ge,geoConicEquidistant as ve,geoConicEqualArea as xe,geoConicConformal as we,geoAlbers as be,select as ke,creator as $e,namespaces as Me,cross as Le,utcFormat as Ae,format as Ee,axisBottom as ze,pathRound as Oe,rgb as Ne,curveLinear as Se,curveBasis as Ce,curveBasisClosed as Re,curveBasisOpen as Te,curveBundle as je,curveBumpX as We,curveBumpY as Be,curveCardinal as De,curveCardinalClosed as Fe,curveCardinalOpen as qe,curveCatmullRom as _e,curveCatmullRomClosed as Ie,curveCatmullRomOpen as Pe,curveLinearClosed as Ue,curveMonotoneX as He,curveMonotoneY as Ve,curveNatural as Ye,curveStep as Ze,curveStepAfter as Ge,curveStepBefore as Je,thresholdSturges as Ke,thresholdScott as Qe,thresholdFreedmanDiaconis as Xe,utcTickInterval as tr,tickIncrement as nr,bisect as er,InternMap as rr,cumsum as or,groupSort as ir,greatest as ar,area as lr,line as sr,rank as cr,count as ur,blurImage as fr,Delaunay as hr,map as dr,blur2 as pr,contours as mr,nice as yr,create as gr,contourDensity as vr,geoGraticule10 as xr,stratify as wr,tree as br,cluster as kr,geoCentroid as $r,least as Mr}from"/npm/d3@7.8.2/+esm";import{parse as Lr,format as Ar}from"/npm/isoformat@0.2.1/+esm";import Er from"/npm/interval-tree-1d@1.0.4/+esm";const zr=new Map([["second",t],["minute",n],["hour",e],["day",r],["week",o],["month",i],["year",a],["monday",l],["tuesday",s],["wednesday",c],["thursday",u],["friday",f],["saturday",h],["sunday",d]]),Or=new Map([["second",p],["minute",m],["hour",y],["day",g],["week",v],["month",x],["year",w],["monday",b],["tuesday",k],["wednesday",$],["thursday",M],["friday",L],["saturday",A],["sunday",E]]);function Nr(t){const n=zr.get(`${t}`.toLowerCase());if(!n)throw new Error(`unknown interval: ${t}`);return n}function Sr(t){const n=Or.get(`${t}`.toLowerCase());if(!n)throw new Error(`unknown interval: ${t}`);return n}const Cr=Object.getPrototypeOf(Uint8Array),Rr=Object.prototype.toString;function Tr(t,n,e){const r=typeof n;return"string"===r?Qr(t,jr(n),e):"function"===r?Qr(t,n,e):"number"===r||n instanceof Date||"boolean"===r?Qr(t,Hr(n),e):n&&"function"==typeof n.transform?Kr(n.transform(t),e):Kr(n,e)}const jr=t=>n=>n[t],Wr=(t,n)=>n,Br={transform:t=>t},Dr=()=>1,Fr=()=>!0,qr=t=>null==t?t:`${t}`,_r=t=>null==t?t:+t,Ir=t=>t?t[0]:void 0,Pr=t=>t?t[1]:void 0,Ur=t=>t?t[2]:void 0,Hr=t=>()=>t;function Vr(t){const n=+`${t}`.slice(1)/100;return(t,e)=>z(t,n,e)}function Yr(t,n){return void 0===t&&(t=n),null===t?[void 0,"none"]:zo(t)?[void 0,t]:[t,void 0]}function Zr(t,n){return void 0===t&&(t=n),null===t||"number"==typeof t?[void 0,t]:[t,void 0]}function Gr(t,n,e){if(null!=t)return Jr(t,n,e)}function Jr(t,n,e){const r=`${t}`.toLowerCase();if(!e.includes(r))throw new Error(`invalid ${n}: ${t}`);return r}function Kr(t,n){return null==t?t:void 0===n?t instanceof Array||t instanceof Cr?t:Array.from(t):t instanceof n?t:n.from(t)}function Qr(t,n,e=Array){return t instanceof e?t.map(n):e.from(t,n)}function Xr(t,n=Array){return t instanceof n?t.slice():n.from(t)}function to(t){return t instanceof Cr}function no(t){return t?.toString===Rr}function eo(t){return no(t)&&(void 0!==t.type||void 0!==t.domain)}function ro(t){return no(t)&&"function"!=typeof t.transform}function oo(t){return ro(t)&&void 0===t.value&&void 0===t.channel}function io(t,n,e,r=Br){return void 0===n&&void 0===e?(n=0,e=void 0===t?r:t):void 0===n?n=void 0===t?0:t:void 0===e&&(e=void 0===t?0:t),[n,e]}function ao(t,n){return void 0===t&&void 0===n?[Ir,Pr]:[t,n]}function lo({z:t,fill:n,stroke:e}={}){return void 0===t&&([t]=Yr(n)),void 0===t&&([t]=Yr(e)),t}function so(t){const n=t.length,e=new Uint32Array(n);for(let t=0;t<n;++t)e[t]=t;return e}function co(t,n){return Qr(n,(n=>t[n]))}function uo(t){return null!==t&&"object"==typeof t?t.valueOf():t}function fo(t,n){if(void 0!==n[t])return n[t];switch(t){case"x1":case"x2":t="x";break;case"y1":case"y2":t="y"}return n[t]}function ho(t){let n;return[{transform:()=>n,label:mo(t)},t=>n=t]}function po(t){return null==t?[t]:ho(t)}function mo(t,n){return"string"==typeof t?t:t&&void 0!==t.label?t.label:n}function yo(t,n){return{transform(e){const r=t.transform(e),o=n.transform(e);return $o(r)||$o(o)?Qr(r,((t,n)=>new Date((+r[n]+ +o[n])/2))):Qr(r,((t,n)=>(+r[n]+ +o[n])/2),Float64Array)},label:t.label}}function go(t,n){if(null!=t){if("number"==typeof t){const n=t;return{floor:t=>n*Math.floor(t/n),offset:t=>t+n,range:(t,e)=>O(Math.ceil(t/n),e/n).map((t=>n*t))}}if("string"==typeof t)return("time"===n?Nr:Sr)(t);if("function"!=typeof t.floor)throw new Error("invalid interval; missing floor method");if("function"!=typeof t.offset)throw new Error("invalid interval; missing offset method");return t}}function vo(t){return void 0===t||ro(t)?t:{value:t}}function xo(t){if(!wo(t))return!1;for(const n of t)if(null!=n)return"object"==typeof n&&"0"in n&&"1"in n}function wo(t){return t&&"function"==typeof t[Symbol.iterator]}function bo(t){for(const n of t)if(null!=n)return"object"!=typeof n||n instanceof Date}function ko(t){for(const n of t){if(null==n)continue;const t=typeof n;return"string"===t||"boolean"===t}}function $o(t){for(const n of t)if(null!=n)return n instanceof Date}function Mo(t){for(const n of t)if(null!=n)return"string"==typeof n&&isNaN(n)&&Lr(n)}function Lo(t){for(const n of t)if(null!=n){if("string"!=typeof n)return!1;if(n.trim())return!isNaN(n)}}function Ao(t){for(const n of t)if(null!=n)return"number"==typeof n}function Eo(t,n){let e;for(const r of t)if(null!=r){if(!n(r))return!1;e=!0}return e}function zo(t){return"string"==typeof t&&("none"===(t=t.toLowerCase().trim())||"currentcolor"===t||t.startsWith("url(")&&t.endsWith(")")||t.startsWith("var(")&&t.endsWith(")")||null!==N(t))}function Oo(t){return null==t||No(t)}function No(t){return/^\s*none\s*$/i.test(t)}function So(t="middle"){return Jr(t,"frameAnchor",["middle","top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"])}function Co(t){if(null==t)return;const n=t[0],e=t[t.length-1];return S(n,e)}function Ro(t){return wo(t)?function(t){console.warn("named iterables are deprecated; please use an object instead");const n=new Set;return Object.fromEntries(Array.from(t,(t=>{const{name:e}=t;if(null==e)throw new Error("missing name");const r=`${e}`;if("__proto__"===r)throw new Error(`illegal name: ${r}`);if(n.has(r))throw new Error(`duplicate name: ${r}`);return n.add(r),[e,t]})))}(t):t}const To=Symbol("position"),jo=Symbol("color"),Wo=Symbol("radius"),Bo=Symbol("length"),Do=Symbol("opacity"),Fo=Symbol("symbol"),qo=new Map([["x",To],["y",To],["fx",To],["fy",To],["r",Wo],["color",jo],["opacity",Do],["symbol",Fo],["length",Bo]]),_o=Math.sqrt(3),Io=2/_o,Po=new Map([["asterisk",C],["circle",R],["cross",T],["diamond",j],["diamond2",W],["hexagon",{draw(t,n){const e=Math.sqrt(n/Math.PI),r=e*Io,o=r/2;t.moveTo(0,r),t.lineTo(e,o),t.lineTo(e,-o),t.lineTo(0,-r),t.lineTo(-e,-o),t.lineTo(-e,o),t.closePath()}}],["plus",B],["square",D],["square2",F],["star",q],["times",_],["triangle",I],["triangle2",P],["wye",U]]);function Uo(t){return t&&"function"==typeof t.draw}function Ho(t){return!!Uo(t)||"string"==typeof t&&Po.has(t.toLowerCase())}function Vo(t){if(null==t||Uo(t))return t;const n=Po.get(`${t}`.toLowerCase());if(n)return n;throw new Error(`invalid symbol: ${t}`)}function Yo(t){return null!=t&&!Number.isNaN(t)}function Zo(t,n){return+Yo(n)-+Yo(t)||H(t,n)}function Go(t,n){return+Yo(n)-+Yo(t)||S(t,n)}function Jo(t){return null!=t&&""!=`${t}`}function Ko(t){return isFinite(t)?t:NaN}function Qo(t){return t>0&&isFinite(t)?t:NaN}function Xo(t){return t<0&&isFinite(t)?t:NaN}function ti(t={},n){let{filter:e,sort:r,reverse:o,transform:i,initializer:a,...l}=t;if(void 0===i&&(null!=e&&(i=ai(e)),null==r||oo(r)||(i=ei(i,fi(r))),o&&(i=ei(i,si))),null!=n&&null!=a)throw new Error("transforms cannot be applied after initializers");return{...l,...(null===r||oo(r))&&{sort:r},transform:ei(i,n)}}function ni(t={},n){let{filter:e,sort:r,reverse:o,initializer:i,...a}=t;return void 0===i&&(null!=e&&(i=ai(e)),null==r||oo(r)||(i=ri(i,fi(r))),o&&(i=ri(i,si))),{...a,...(null===r||oo(r))&&{sort:r},initializer:ri(i,n)}}function ei(t,n){return null==t?null===n?void 0:n:null==n?null===t?void 0:t:function(e,r){return({data:e,facets:r}=t.call(this,e,r)),n.call(this,Kr(e),r)}}function ri(t,n){return null==t?null===n?void 0:n:null==n?null===t?void 0:t:function(e,r,o,...i){let a,l,s,c,u,f;return({data:l=e,facets:s=r,channels:a}=t.call(this,e,r,o,...i)),({data:u=l,facets:f=s,channels:c}=n.call(this,l,s,{...o,...a},...i)),{data:u,facets:f,channels:{...a,...c}}}}function oi(t,n){return(null!=t.initializer?ni:ti)(t,n)}function ii(t,n){return oi(n,ai(t))}function ai(t){return(n,e)=>{const r=Tr(n,t);return{data:n,facets:e.map((t=>t.filter((t=>r[t]))))}}}function li(t){return{...oi(t,si),sort:null}}function si(t,n){return{data:t,facets:n.map((t=>t.slice().reverse()))}}function ci(t={}){const{seed:n,...e}=t;return{...oi(e,di(null==n?Math.random:V(n))),sort:null}}function ui(t,n){return{...(ro(t)&&void 0!==t.channel?ni:oi)(n,fi(t)),sort:null}}function fi(t){return("function"==typeof t&&1!==t.length?hi:di)(t)}function hi(t){return(n,e)=>{const r=(e,r)=>t(n[e],n[r]);return{data:n,facets:e.map((t=>t.slice().sort(r)))}}}function di(t){let n,e;if(({channel:n,value:t,order:e=Zo}={...vo(t)}),"function"!=typeof e)switch(`${e}`.toLowerCase()){case"ascending":e=Zo;break;case"descending":e=Go;break;default:throw new Error(`invalid order: ${e}`)}return(r,o,i)=>{let a;if(void 0===n)a=Tr(r,t);else{if(void 0===i)throw new Error("channel sort requires an initializer");if(a=i[n],!a)return{};a=a.value}const l=(t,n)=>e(a[t],a[n]);return{data:r,facets:o.map((t=>t.slice().sort(l)))}}}function pi(t,n){return vi(null,null,t,n)}function mi(t={y:"count"},n={}){const{x:e=Br}=n;if(null==e)throw new Error("missing channel: x");return vi(e,null,t,n)}function yi(t={x:"count"},n={}){const{y:e=Br}=n;if(null==e)throw new Error("missing channel: y");return vi(null,e,t,n)}function gi(t={fill:"count"},n={}){let{x:e,y:r}=n;if([e,r]=ao(e,r),null==e)throw new Error("missing channel: x");if(null==r)throw new Error("missing channel: y");return vi(e,r,t,n)}function vi(t,n,{data:e=Oi,filter:r,sort:o,reverse:i,...a}={},l={}){a=wi(a,l),e=Mi(e,Br),o=null==o?void 0:bi("sort",o,l),r=null==r?void 0:ki("filter",r,l);const[s,c]=po(t),[u,f]=po(n),{z:h,fill:d,stroke:p,x1:m,x2:y,y1:g,y2:v,...x}=l,[w,b]=po(h),[k]=Yr(d),[$]=Yr(p),[M,L]=po(k),[A,E]=po($);return{..."z"in l&&{z:w||h},..."fill"in l&&{fill:M||d},..."stroke"in l&&{stroke:A||p},...ti(x,((l,s)=>{const u=Tr(l,t),d=Tr(l,n),p=Tr(l,h),m=Tr(l,k),y=Tr(l,$),g=Li(a,{z:p,fill:m,stroke:y}),v=[],x=[],w=u&&c([]),M=d&&f([]),A=p&&b([]),z=m&&L([]),O=y&&E([]);let N=0;for(const t of a)t.initialize(l);o&&o.initialize(l),r&&r.initialize(l);for(const t of s){const n=[];for(const n of a)n.scope("facet",t);o&&o.scope("facet",t),r&&r.scope("facet",t);for(const[i,s]of $i(t,g))for(const[t,c]of $i(s,d))for(const[s,f]of $i(c,u))if(!r||r.reduce(f)){n.push(N++),x.push(e.reduce(f,l)),u&&w.push(s),d&&M.push(t),p&&A.push(g===p?i:p[f[0]]),m&&z.push(g===m?i:m[f[0]]),y&&O.push(g===y?i:y[f[0]]);for(const t of a)t.reduce(f);o&&o.reduce(f)}v.push(n)}return Ai(v,o,i),{data:x,facets:v}})),...!xi(a,"x")&&(s?{x:s}:{x1:m,x2:y}),...!xi(a,"y")&&(u?{y:u}:{y1:g,y2:v}),...Object.fromEntries(a.map((({name:t,output:n})=>[t,n])))}}function xi(t,...n){for(const{name:e}of t)if(n.includes(e))return!0;return!1}function wi(t,n){const e=Object.entries(t);return null!=n.title&&void 0===t.title&&e.push(["title",Si]),null!=n.href&&void 0===t.href&&e.push(["href",Ni]),e.filter((([,t])=>void 0!==t)).map((([t,e])=>null===e?{name:t,initialize(){},scope(){},reduce(){}}:bi(t,e,n)))}function bi(t,n,e){const r=ki(t,n,e),[o,i]=ho(r.label);let a;return{name:t,output:o,initialize(t){r.initialize(t),a=i([])},scope(t,n){r.scope(t,n)},reduce(t,n){a.push(r.reduce(t,n))}}}function ki(t,n,e){const r=fo(t,e),o=Mi(n,r);let i,a;return{label:mo(o===Ri?null:r,o.label),initialize(t){i=void 0===r?t:Tr(t,r),"data"===o.scope&&(a=o.reduce(so(t),i))},scope(t,n){o.scope===t&&(a=o.reduce(n,i))},reduce:(t,n)=>null==o.scope?o.reduce(t,i,n):o.reduce(t,i,a,n)}}function $i(t,n){return n?Y(Z(t,(t=>n[t])),Ir):[[,t]]}function Mi(t,n){if("function"==typeof t?.reduce&&no(t))return t;if("function"==typeof t)return e=t,{reduce:(t,n,r)=>e(co(n,t),r)};var e;if(/^p\d{2}$/i.test(t))return Ei(Vr(t));switch(`${t}`.toLowerCase()){case"first":return Ni;case"last":return Ci;case"count":return Ri;case"distinct":return Ti;case"sum":return null==n?Ri:ji;case"proportion":return Wi(n,"data");case"proportion-facet":return Wi(n,"facet");case"deviation":return Ei(et);case"min":return Ei(nt);case"min-index":return Ei(tt);case"max":return Ei(X);case"max-index":return Ei(Q);case"mean":return zi(K);case"median":return zi(at);case"variance":return Ei(J);case"mode":return Ei(G);case"x":return Di;case"x1":return qi;case"x2":return _i;case"y":return Fi;case"y1":return Ii;case"y2":return Pi}throw new Error(`invalid reduce: ${t}`)}function Li(t,n){for(const e in n){const r=n[e];if(void 0!==r&&!t.some((t=>t.name===e)))return r}}function Ai(t,n,e){if(n){const e=n.output.transform(),r=(t,n)=>Zo(e[t],e[n]);t.forEach((t=>t.sort(r)))}e&&t.forEach((t=>t.reverse()))}function Ei(t){return{reduce:(n,e)=>t(n,(t=>e[t]))}}function zi(t){return{reduce(n,e){const r=t(n,(t=>e[t]));return $o(e)?new Date(r):r}}}const Oi={reduce:(t,n)=>co(n,t)},Ni={reduce:(t,n)=>n[t[0]]},Si={reduce(t,n){const e=Y(ot(t,(t=>t.length),(t=>n[t])),Pr),r=e.slice(-5).reverse();if(r.length<e.length){const t=e.slice(0,-4);r[4]=[`… ${t.length.toLocaleString("en-US")} more`,rt(t,Pr)]}return r.map((([t,n])=>`${t} (${n.toLocaleString("en-US")})`)).join("\n")}},Ci={reduce:(t,n)=>n[t[t.length-1]]},Ri={label:"Frequency",reduce:t=>t.length},Ti={label:"Distinct",reduce:(t,n)=>{const e=new it;for(const r of t)e.add(n[r]);return e.size}},ji=Ei(rt);function Wi(t,n){return null==t?{scope:n,label:"Frequency",reduce:(t,n,e=1)=>t.length/e}:{scope:n,reduce:(t,n,e=1)=>rt(t,(t=>n[t]))/e}}function Bi(t,n){const e=(+t+ +n)/2;return t instanceof Date?new Date(e):e}const Di={reduce:(t,n,{x1:e,x2:r})=>Bi(e,r)},Fi={reduce:(t,n,{y1:e,y2:r})=>Bi(e,r)},qi={reduce:(t,n,{x1:e})=>e},_i={reduce:(t,n,{x2:e})=>e},Ii={reduce:(t,n,{y1:e})=>e},Pi={reduce:(t,n,{y2:e})=>e};function Ui(t,{scale:n,type:e,value:r,filter:o,hint:i},a){return Yi(a,{scale:n,type:e,value:Tr(t,r),label:mo(r),filter:o,hint:i})}function Hi(t,n){return Object.fromEntries(Object.entries(t).map((([t,e])=>[t,Ui(n,e,t)])))}function Vi(t,n){return Object.fromEntries(Object.entries(t).map((([t,{scale:e,value:r}])=>{const o=null==e?null:n[e];return[t,null==o?r:Qr(r,o)]})))}function Yi(t,n){const{scale:e,value:r}=n;if(!0===e||"auto"===e)switch(t){case"fill":case"stroke":case"color":n.scale=Eo(r,zo)?null:"color";break;case"fillOpacity":case"strokeOpacity":n.scale="opacity";break;case"symbol":Eo(r,Ho)?(n.scale=null,n.value=Qr(r,Vo)):n.scale="symbol";break;default:n.scale=qo.has(t)?t:null}else if(null!=e&&!qo.has(e))throw new Error(`unknown scale: ${e}`);return n}function Zi(t,n){for(const e in t){const r=t[e];if(r.scale===n)return r}}function Gi(t,n,e){const r=Ji(t,n);return Qr(Ji(t,e),((t,n)=>Math.abs(t-r[n])),Float64Array)}function Ji(t,n,e){let r=t[n];if(r||void 0===e||(r=t[e]),r)return r.value;throw new Error(`missing channel: ${n}`)}function Ki([t,n],[e,r]){return H(n,r)||H(t,e)}function Qi([t,n],[e,r]){return S(n,r)||H(t,e)}const Xi=new Map([["accent",lt],["category10",st],["dark2",ct],["paired",ut],["pastel1",ft],["pastel2",ht],["set1",dt],["set2",pt],["set3",mt],["tableau10",yt],["brbg",na(zn,Mn)],["prgn",na(xt,vt)],["piyg",na(bt,wt)],["puor",na($t,kt)],["rdbu",na(Lt,Mt)],["rdgy",na(Et,At)],["rdylbu",na(Ot,zt)],["rdylgn",na(St,Nt)],["spectral",na(Rt,Ct)],["burd",ea(Lt,Mt)],["buylrd",ea(Ot,zt)],["blues",ta(On,Ln)],["greens",ta(jt,Tt)],["greys",ta(Bt,Wt)],["oranges",ta(Ft,Dt)],["purples",ta(_t,qt)],["reds",ta(Pt,It)],["turbo",ra(An)],["viridis",ra(Ut)],["magma",ra(Ht)],["inferno",ra(Vt)],["plasma",ra(Yt)],["cividis",ra(Zt)],["cubehelix",ra(Gt)],["warm",ra(Jt)],["cool",ra(Kt)],["bugn",ta(Xt,Qt)],["bupu",ta(nn,tn)],["gnbu",ta(rn,en)],["orrd",ta(an,on)],["pubu",ta(sn,ln)],["pubugn",ta(un,cn)],["purd",ta(hn,fn)],["rdpu",ta(pn,dn)],["ylgn",ta(yn,mn)],["ylgnbu",ta(vn,gn)],["ylorbr",ta(wn,xn)],["ylorrd",ta(kn,bn)],["rainbow",oa(En)],["sinebow",oa($n)]]);function ta(t,n){return({length:e})=>1===e?[t[3][1]]:2===e?[t[3][1],t[3][2]]:(e=Math.max(3,Math.floor(e)))>9?gt(n,e):t[e]}function na(t,n){return({length:e})=>2===e?[t[3][0],t[3][2]]:(e=Math.max(3,Math.floor(e)))>11?gt(n,e):t[e]}function ea(t,n){return({length:e})=>2===e?[t[3][2],t[3][0]]:(e=Math.max(3,Math.floor(e)))>11?gt((t=>n(1-t)),e):t[e].slice().reverse()}function ra(t){return({length:n})=>gt(t,Math.max(2,Math.floor(n)))}function oa(t){return({length:n})=>gt(t,Math.floor(n)+1).slice(0,-1)}function ia(t){const n=`${t}`.toLowerCase();if(!Xi.has(n))throw new Error(`unknown ordinal scheme: ${n}`);return Xi.get(n)}function aa(t,n){const e=ia(t),r="function"==typeof e?e({length:n}):e;return r.length!==n?r.slice(0,n):r}const la=new Map([["brbg",Mn],["prgn",vt],["piyg",wt],["puor",kt],["rdbu",Mt],["rdgy",At],["rdylbu",zt],["rdylgn",Nt],["spectral",Ct],["burd",t=>Mt(1-t)],["buylrd",t=>zt(1-t)],["blues",Ln],["greens",Tt],["greys",Wt],["purples",qt],["reds",It],["oranges",Dt],["turbo",An],["viridis",Ut],["magma",Ht],["inferno",Vt],["plasma",Yt],["cividis",Zt],["cubehelix",Gt],["warm",Jt],["cool",Kt],["bugn",Qt],["bupu",tn],["gnbu",en],["orrd",on],["pubugn",cn],["pubu",ln],["purd",fn],["rdpu",dn],["ylgnbu",gn],["ylgn",mn],["ylorbr",xn],["ylorrd",bn],["rainbow",En],["sinebow",$n]]);function sa(t){const n=`${t}`.toLowerCase();if(!la.has(n))throw new Error(`unknown quantitative scheme: ${n}`);return la.get(n)}const ca=new Set(["brbg","prgn","piyg","puor","rdbu","rdgy","rdylbu","rdylgn","spectral","burd","buylrd"]);function ua(t){return null!=t&&ca.has(`${t}`.toLowerCase())}const fa=t=>n=>t(1-n),ha=[0,1],da=new Map([["number",qn],["rgb",Dn],["hsl",Pn],["hcl",Un],["lab",Hn]]);function pa(t){const n=`${t}`.toLowerCase();if(!da.has(n))throw new Error(`unknown interpolator: ${n}`);return da.get(n)}function ma(t,n,e,{type:r,nice:o,clamp:i,zero:a,domain:l=xa(t,e),unknown:s,round:c,scheme:u,interval:f,range:h=(qo.get(t)===Wo?ba(e,l):qo.get(t)===Bo?ka(e,l):qo.get(t)===Do?ha:void 0),interpolate:d=(qo.get(t)===jo?null==u&&void 0!==h?Dn:sa(void 0!==u?u:"cyclical"===r?"rainbow":"turbo"):c?Fn:qn),reverse:p}){if(f=go(f,r),"cyclical"!==r&&"sequential"!==r||(r="linear"),p=!!p,"function"!=typeof d&&(d=pa(d)),1===d.length?(p&&(d=fa(d),p=!1),void 0===h&&2===(h=Float64Array.from(l,((t,n)=>n/(l.length-1)))).length&&(h=ha),n.interpolate((h===ha?Hr:La)(d))):n.interpolate(d),a){const[t,n]=Bn(l);(t>0||n<0)&&(Co(l=Xr(l))!==Math.sign(t)?l[l.length-1]=0:l[0]=0)}return p&&(l=jn(l)),n.domain(l).unknown(s),o&&(n.nice(!0===o?void 0:o),l=n.domain()),void 0!==h&&n.range(h),i&&n.clamp(i),{type:r,domain:l,range:h,scale:n,interpolate:d,interval:f}}function ya(t,n,{exponent:e=1,...r}){return ma(t,Rn().exponent(e),n,{...r,type:"pow"})}function ga(t,n,{domain:e=[0],unknown:r,scheme:o="rdylbu",interpolate:i,range:a=(void 0!==i?gt(i,e.length+1):qo.get(t)===jo?aa(o,e.length+1):void 0),reverse:l}){const s=Co(e=Kr(e));if(!function(t,n){for(let e=1,r=t.length,o=t[0];e<r;++e){const r=S(o,o=t[e]);if(0!==r&&r!==n)return!1}return!0}(e,s))throw new Error(`the ${t} scale has a non-monotonic domain`);return l&&(a=jn(a)),{type:"threshold",scale:Tn(s<0?jn(e):e,void 0===a?[]:a).unknown(r),domain:e,range:a}}function va(t,n=Ko){return t.length?[nt(t,(({value:t})=>void 0===t?t:nt(t,n))),X(t,(({value:t})=>void 0===t?t:X(t,n)))]:[0,1]}function xa(t,n){const e=qo.get(t);return(e===Wo||e===Do||e===Bo?wa:va)(n)}function wa(t){return[0,t.length?X(t,(({value:t})=>void 0===t?t:X(t,Ko))):1]}function ba(t,n){const e=t.find((({radius:t})=>void 0!==t));if(void 0!==e)return[0,e.radius];const r=z(t,.5,(({value:t})=>void 0===t?NaN:z(t,.25,Qo))),o=n.map((t=>3*Math.sqrt(t/r))),i=30/X(o);return i<1?o.map((t=>t*i)):o}function ka(t,n){const e=at(t,(({value:t})=>void 0===t?NaN:at(t,Math.abs))),r=n.map((t=>12*t/e)),o=60/X(r);return o<1?r.map((t=>t*o)):r}function $a(t){for(const{value:n}of t)if(void 0!==n)for(let e of n){if(e>0)return va(t,Qo);if(e<0)return va(t,Xo)}return[1,10]}function Ma(t){const n=[];for(const{value:e}of t)if(void 0!==e)for(const t of e)n.push(t);return n}function La(t){return(n,e)=>r=>t(n+r*(e-n))}function Aa(t,n,e,r,{type:o,nice:i,clamp:a,domain:l=va(r),unknown:s,pivot:c=0,scheme:u,range:f,symmetric:h=!0,interpolate:d=(qo.get(t)===jo?null==u&&void 0!==f?Dn:sa(void 0!==u?u:"rdbu"):qn),reverse:p}){c=+c;let[m,y]=l;if(S(m,y)<0&&([m,y]=[y,m],p=!p),m=Math.min(m,c),y=Math.max(y,c),"function"!=typeof d&&(d=pa(d)),void 0!==f&&(d=1===d.length?La(d)(...f):Jn(d,f)),p&&(d=fa(d)),h){const t=e.apply(c),n=t-e.apply(m),r=e.apply(y)-t;n<r?m=e.invert(t-r):n>r&&(y=e.invert(t+n))}return n.domain([m,c,y]).unknown(s).interpolator(d),a&&n.clamp(a),i&&n.nice(i),{type:o,domain:[m,y],pivot:c,interpolate:d,scale:n}}function Ea(t,n,{exponent:e=1,...r}){return Aa(t,Zn().exponent(e=+e),function(t){return.5===t?Sa:{apply:n=>Math.sign(n)*Math.pow(Math.abs(n),t),invert:n=>Math.sign(n)*Math.pow(Math.abs(n),1/t)}}(e),n,{...r,type:"diverging-pow"})}function za(t,n,{constant:e=1,...r}){return Aa(t,Vn().constant(e=+e),function(t){return{apply:n=>Math.sign(n)*Math.log1p(Math.abs(n/t)),invert:n=>Math.sign(n)*Math.expm1(Math.abs(n))*t}}(e),n,r)}const Oa={apply:t=>t,invert:t=>t},Na={apply:Math.log,invert:Math.exp},Sa={apply:t=>Math.sign(t)*Math.sqrt(Math.abs(t)),invert:t=>Math.sign(t)*(t*t)};function Ca(t,n,e,r){return ma(t,n,e,r)}const Ra=Symbol("ordinal");function Ta(t,n,e,{type:r,interval:o,domain:i,range:a,reverse:l,hint:s}){return o=go(o,r),void 0===i&&(i=Ba(e,o,t)),"categorical"!==r&&r!==Ra||(r="ordinal"),l&&(i=jn(i)),n.domain(i),void 0!==a&&("function"==typeof a&&(a=a(i)),n.range(a)),{type:r,domain:i,range:a,scale:n,hint:s,interval:o}}function ja(t,n,{type:e,interval:r,domain:o,range:i,scheme:a,unknown:l,...s}){let c;if(r=go(r,e),void 0===o&&(o=Ba(n,r,t)),qo.get(t)===Fo)c=function(t){return{fill:Da(t,"fill"),stroke:Da(t,"stroke")}}(n),i=void 0===i?function(t){return Oo(t.fill)?ee:re}(c):Qr(i,Vo);else if(qo.get(t)===jo&&(void 0!==i||"ordinal"!==e&&e!==Ra||(i=function(t,n="greys"){const e=new Set,[r,o]=aa(n,2);for(const n of t)if(null!=n)if(!0===n)e.add(o);else{if(!1!==n)return;e.add(r)}return[...e]}(o,a),void 0!==i&&(a=void 0)),void 0===a&&void 0===i&&(a="ordinal"===e?"turbo":"tableau10"),void 0!==a))if(void 0!==i){const t=sa(a),n=i[0],e=i[1]-i[0];i=({length:r})=>gt((r=>t(n+e*r)),r)}else i=ia(a);if(l===oe)throw new Error(`implicit unknown on ${t} scale is not supported`);return Ta(t,ne().unknown(l),n,{...s,type:e,domain:o,range:i,hint:c})}function Wa(t,n,e,r){let{round:o}=e;return void 0!==o&&t.round(o=!!o),(t=Ta(r,t,n,e)).round=o,t}function Ba(t,n,e){const r=new it;for(const{value:n,domain:e}of t){if(void 0!==e)return e();if(void 0!==n)for(const t of n)r.add(t)}if(void 0!==n){const[t,e]=Bn(r).map(n.floor,n);return n.range(t,n.offset(e))}if(r.size>1e4&&qo.get(e)===To)throw new Error(`implicit ordinal domain of ${e} scale has more than 10,000 values`);return Y(r,Zo)}function Da(t,n){let e;for(const{hint:r}of t){const t=r?.[n];if(void 0!==t)if(void 0===e)e=t;else if(e!==t)return}return e}let Fa=0;function qa(t){console.warn(t),++Fa}function _a(t,{label:n,inset:e=0,insetTop:r=e,insetRight:o=e,insetBottom:i=e,insetLeft:a=e,round:l,nice:s,clamp:c,zero:u,align:f,padding:h,projection:d,facet:{label:p=n}={},...m}={}){const y={};for(const[e,g]of t){const t=m[e],v=Ka(e,g,{round:qo.get(e)===To?l:void 0,nice:s,clamp:c,zero:u,align:f,padding:h,projection:d,...t});if(v){let{label:l=("fx"===e||"fy"===e?p:n),percent:s,transform:c,inset:u,insetTop:f=(void 0!==u?u:"y"===e?r:0),insetRight:h=(void 0!==u?u:"x"===e?o:0),insetBottom:d=(void 0!==u?u:"y"===e?i:0),insetLeft:m=(void 0!==u?u:"x"===e?a:0)}=t||{};if(null==c)c=void 0;else if("function"!=typeof c)throw new Error("invalid scale transform; not a function");v.percent=!!s,v.label=void 0===l?Pa(g,v):l,v.transform=c,"x"===e||"fx"===e?(v.insetLeft=+m,v.insetRight=+h):"y"!==e&&"fy"!==e||(v.insetTop=+f,v.insetBottom=+d),y[e]=v}}return y}function Ia(t){return Object.fromEntries(Object.entries(t).filter((([,{scale:t}])=>t)).map((([t,{scale:n,type:e,interval:r,label:o}])=>(n.type=e,null!=r&&(n.interval=r),null!=o&&(n.label=o),[t,n]))))}function Pa(t=[],n){let e;for(const{label:n}of t)if(void 0!==n)if(void 0===e)e=n;else if(e!==n)return;if(!(void 0===e||nl(n)&&/^(date|time|year)$/i.test(e)))return!el(n)&&n.percent&&(e=`${e} (%)`),{inferred:!0,toString:()=>e}}function Ua(t){const{marginTop:n,marginRight:e,marginBottom:r,marginLeft:o,width:i,height:a,facet:{marginTop:l,marginRight:s,marginBottom:c,marginLeft:u}}=t;return{marginTop:Math.max(n,l),marginRight:Math.max(e,s),marginBottom:Math.max(r,c),marginLeft:Math.max(o,u),width:i,height:a}}function Ha({fx:t,fy:n},e){const{marginTop:r,marginRight:o,marginBottom:i,marginLeft:a,width:l,height:s}=Ua(e);return{marginTop:r,marginRight:o,marginBottom:i,marginLeft:a,width:t?t.scale.bandwidth()+a+o:l,height:n?n.scale.bandwidth()+r+i:s}}function Va(t,n){if(void 0===t.range){const{insetLeft:e,insetRight:r}=t,{width:o,marginLeft:i=0,marginRight:a=0}=n,l=i+e,s=o-a-r;t.range=[l,Math.max(l,s)],el(t)||(t.range=Ga(t)),t.scale.range(t.range)}Za(t)}function Ya(t,n){if(void 0===t.range){const{insetTop:e,insetBottom:r}=t,{height:o,marginTop:i=0,marginBottom:a=0}=n,l=i+e,s=o-a-r;t.range=[Math.max(l,s),l],el(t)?t.range.reverse():t.range=Ga(t),t.scale.range(t.range)}Za(t)}function Za(t){void 0===t.round&&function({type:t}){return"point"===t||"band"===t}(t)&&function({scale:t}){const n=t.domain().length,[e,r]=t.range(),o=t.paddingInner?t.paddingInner():1,i=t.paddingOuter?t.paddingOuter():t.padding(),a=n-o,l=Math.abs(r-e)/Math.max(1,a+2*i);return(l-Math.floor(l))*a}(t)<=30&&t.scale.round(!0)}function Ga(t){const n=t.scale.domain().length+rl(t);if(!(n>2))return t.range;const[e,r]=t.range;return Array.from({length:n},((t,o)=>e+o/(n-1)*(r-e)))}function Ja(t,n,e){return Ka(t,void 0===e?void 0:[{hint:e}],{...n})}function Ka(t,n=[],e={}){const r=function(t,n,{type:e,domain:r,range:o,scheme:i,pivot:a,projection:l}){if("fx"===t||"fy"===t)return"band";"x"!==t&&"y"!==t||null==l||(e=Xa);for(const{type:t}of n)if(void 0!==t)if(void 0===e)e=t;else if(e!==t)throw new Error(`scale incompatible with channel: ${e} !== ${t}`);if(e===Xa)return;if(void 0!==e)return e;if(void 0===r&&!n.some((({value:t})=>void 0!==t)))return;const s=qo.get(t);if(s===Wo)return"sqrt";if(s===Do||s===Bo)return"linear";if(s===Fo)return"ordinal";if((r||o||[]).length>2)return tl(s);if(void 0!==r)return ko(r)?tl(s):$o(r)?"utc":s!==jo||null==a&&!ua(i)?"linear":"diverging";const c=n.map((({value:t})=>t)).filter((t=>void 0!==t));return c.some(ko)?tl(s):c.some($o)?"utc":s!==jo||null==a&&!ua(i)?"linear":"diverging"}(t,n,e);if(void 0===e.type&&void 0===e.domain&&void 0===e.range&&null==e.interval&&"fx"!==t&&"fy"!==t&&el({type:r})){const e=n.map((({value:t})=>t)).filter((t=>void 0!==t));e.some($o)?qa(`Warning: some data associated with the ${t} scale are dates. Dates are typically associated with a "utc" or "time" scale rather than a "${Qa(r)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can specify the interval of the ${t} scale (e.g., d3.utcDay), or you can suppress this warning by setting the type of the ${t} scale to "${Qa(r)}".`):e.some(Mo)?qa(`Warning: some data associated with the ${t} scale are strings that appear to be dates (e.g., YYYY-MM-DD). If these strings represent dates, you should parse them to Date objects. Dates are typically associated with a "utc" or "time" scale rather than a "${Qa(r)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can suppress this warning by setting the type of the ${t} scale to "${Qa(r)}".`):e.some(Lo)&&qa(`Warning: some data associated with the ${t} scale are strings that appear to be numbers. If these strings represent numbers, you should parse or coerce them to numbers. Numbers are typically associated with a "linear" scale rather than a "${Qa(r)}" scale. If you want to treat this data as ordinal, you can specify the interval of the ${t} scale (e.g., 1 for integers), or you can suppress this warning by setting the type of the ${t} scale to "${Qa(r)}".`)}switch(e.type=r,r){case"diverging":case"diverging-sqrt":case"diverging-pow":case"diverging-log":case"diverging-symlog":case"cyclical":case"sequential":case"linear":case"sqrt":case"threshold":case"quantile":case"pow":case"log":case"symlog":e=il(n,e,sl);break;case"identity":switch(qo.get(t)){case To:e=il(n,e,sl);break;case Fo:e=il(n,e,al)}break;case"utc":case"time":e=il(n,e,ll)}switch(r){case"diverging":return function(t,n,e){return Aa(t,Gn(),Oa,n,e)}(t,n,e);case"diverging-sqrt":return function(t,n,e){return Ea(t,n,{...e,exponent:.5})}(t,n,e);case"diverging-pow":return Ea(t,n,e);case"diverging-log":return function(t,n,{base:e=10,pivot:r=1,domain:o=va(n,r<0?Xo:Qo),...i}){return Aa(t,Yn().base(e=+e),Na,n,{domain:o,pivot:r,...i})}(t,n,e);case"diverging-symlog":return za(t,n,e);case"categorical":case"ordinal":case Ra:return ja(t,n,e);case"cyclical":case"sequential":case"linear":return function(t,n,e){return ma(t,Wn(),n,e)}(t,n,e);case"sqrt":return function(t,n,e){return ya(t,n,{...e,exponent:.5})}(t,n,e);case"threshold":return ga(t,0,e);case"quantile":return function(t,n,{range:e,quantiles:r=(void 0===e?5:(e=[...e]).length),n:o=r,scheme:i="rdylbu",domain:a=Ma(n),interpolate:l,reverse:s}){return void 0===e&&(e=void 0!==l?gt(l,o):qo.get(t)===jo?aa(i,o):void 0),a.length>0&&(a=_n(a,void 0===e?{length:o}:e).quantiles()),ga(t,0,{domain:a,range:e,reverse:s})}(t,n,e);case"quantize":return function(t,n,{range:e,n:r=(void 0===e?5:(e=[...e]).length),scheme:o="rdylbu",domain:i=xa(t,n),unknown:a,interpolate:l,reverse:s}){const[c,u]=Bn(i);let f;return void 0===e?(f=In(c,u,r),f[0]<=c&&f.splice(0,1),f[f.length-1]>=u&&f.pop(),r=f.length+1,e=void 0!==l?gt(l,r):qo.get(t)===jo?aa(o,r):void 0):(f=gt(qn(c,u),r+1).slice(1,-1),c instanceof Date&&(f=f.map((t=>new Date(t))))),Co(Kr(i))<0&&f.reverse(),ga(t,0,{domain:f,range:e,reverse:s,unknown:a})}(t,n,e);case"pow":return ya(t,n,e);case"log":return function(t,n,{base:e=10,domain:r=$a(n),...o}){return ma(t,Cn().base(e),n,{...o,domain:r})}(t,n,e);case"symlog":return function(t,n,{constant:e=1,...r}){return ma(t,Sn().constant(e),n,r)}(t,n,e);case"utc":return function(t,n,e){return Ca(t,Qn(),n,e)}(t,n,e);case"time":return function(t,n,e){return Ca(t,Kn(),n,e)}(t,n,e);case"point":return function(t,n,{align:e=.5,padding:r=.5,...o}){return Wa(te().align(e).padding(r),n,o,t)}(t,n,e);case"band":return function(t,n,{align:e=.5,padding:r=.1,paddingInner:o=r,paddingOuter:i=("fx"===t||"fy"===t?0:r),...a}){return Wa(Xn().align(e).paddingInner(o).paddingOuter(i),n,a,t)}(t,n,e);case"identity":return qo.get(t)===To?{type:"identity",scale:Nn()}:{type:"identity"};case void 0:return;default:throw new Error(`unknown scale type: ${r}`)}}function Qa(t){return"symbol"==typeof t?t.description:t}const Xa={toString:()=>"projection"};function tl(t){switch(t){case To:return"point";case jo:return Ra;default:return"ordinal"}}function nl({type:t}){return"time"===t||"utc"===t}function el({type:t}){return"ordinal"===t||"point"===t||"band"===t||t===Ra}function rl({type:t}){return"threshold"===t}function ol(t){if(void 0===t)return!0;const n=t.domain(),e=t(n[0]);for(let r=1,o=n.length;r<o;++r)if(t(n[r])-e)return!1;return!0}function il(t,{domain:n,...e},r){for(const n of t)void 0!==n.value&&(n.value=r(n.value));return{domain:void 0===n?n:r(n),...e}}function al(t){return Qr(t,Vo)}function ll(t){return Qr(t,ul)}function sl(t){return to(t)?t:Qr(t,cl,Float64Array)}function cl(t){return null==t?NaN:Number(t)}function ul(t){return t instanceof Date&&!isNaN(t)?t:"string"==typeof t?Lr(t):null==t||isNaN(t=+t)?void 0:new Date(t)}function fl(t={}){let n;for(const e in t)if(qo.has(e)&&eo(t[e])){if(void 0!==n)throw new Error("ambiguous scale definition; multiple scales found");n=hl(Ja(e,t[e]))}if(void 0===n)throw new Error("invalid scale definition; no scale found");return n}function hl({scale:t,type:n,domain:e,range:r,interpolate:o,interval:i,transform:a,percent:l,pivot:s}){if("identity"===n)return{type:"identity",apply:t=>t,invert:t=>t};const c=t.unknown?t.unknown():void 0;return{type:n,domain:Xr(e),...void 0!==r&&{range:Xr(r)},...void 0!==a&&{transform:a},...l&&{percent:l},...void 0!==c&&{unknown:c},...void 0!==i&&{interval:i},...void 0!==o&&{interpolate:o},...t.clamp&&{clamp:t.clamp()},...void 0!==s&&{pivot:s,symmetric:!1},...t.base&&{base:t.base()},...t.exponent&&{exponent:t.exponent()},...t.constant&&{constant:t.constant()},...t.align&&{align:t.align(),round:t.round()},...t.padding&&(t.paddingInner?{paddingInner:t.paddingInner(),paddingOuter:t.paddingOuter()}:{padding:t.padding()}),...t.bandwidth&&{bandwidth:t.bandwidth(),step:t.step()},apply:n=>t(n),...t.invert&&{invert:n=>t.invert(n)}}}const dl=Math.PI,pl=2*dl;function ml({projection:t,inset:n=0,insetTop:e=n,insetRight:r=n,insetBottom:o=n,insetLeft:i=n}={},a){if(null==t)return;if("function"==typeof t.stream)return t;let l,s,c="frame";if(no(t)){let n;if(({type:t,domain:s,inset:n,insetTop:e=(void 0!==n?n:e),insetRight:r=(void 0!==n?n:r),insetBottom:o=(void 0!==n?n:o),insetLeft:i=(void 0!==n?n:i),clip:c=c,...l}=t),null==t)return}"function"!=typeof t&&({type:t}=yl(t));const{width:u,height:f,marginLeft:h,marginRight:d,marginTop:p,marginBottom:m}=a,y=u-h-d-i-r,g=f-p-m-e-o;if(t=t?.({width:y,height:g,clip:c,...l}),null==t)return;c=function(t,n,e,r,o){if(!1===t||null==t||"number"==typeof t)return t=>t;!0===t&&(t="frame");if("frame"===`${t}`.toLowerCase())return ye(n,e,r,o);throw new Error(`unknown projection clip type: ${t}`)}(c,h,p,u-d,f-m);let v,x=h+i,w=p+e;if(null!=s){const[[n,e],[r,o]]=ae(t).bounds(s),i=Math.min(y/(r-n),g/(o-e));i>0?(x-=(i*(n+r)-y)/2,w-=(i*(e+o)-g)/2,v=ie({point(t,n){this.stream.point(t*i+x,n*i+w)}})):qa("Warning: the projection could not be fit to the specified domain; using the default scale.")}return v??=0===x&&0===w?xl():ie({point(t,n){this.stream.point(t+x,n+w)}}),{stream:n=>t.stream(v.stream(c(n)))}}function yl(t){switch(`${t}`.toLowerCase()){case"albers-usa":return gl(me,.7463,.4673);case"albers":return vl(be,.7463,.4673);case"azimuthal-equal-area":return gl(pe,4,4);case"azimuthal-equidistant":return gl(de,pl,pl);case"conic-conformal":return vl(we,pl,pl);case"conic-equal-area":return vl(xe,6.1702,2.9781);case"conic-equidistant":return vl(ve,7.312,3.6282);case"equal-earth":return gl(he,5.4133,2.6347);case"equirectangular":return gl(fe,pl,dl);case"gnomonic":return gl(ue,3.4641,3.4641);case"identity":return{type:xl};case"reflect-y":return{type:wl};case"mercator":return gl(ce,pl,pl);case"orthographic":return gl(se,2,2);case"stereographic":return gl(le,2,2);case"transverse-mercator":return gl(ge,pl,pl);default:throw new Error(`unknown projection type: ${t}`)}}function gl(t,n,e){return{type:({width:r,height:o,rotate:i,precision:a=.15,clip:l})=>{const s=t();return null!=a&&s.precision?.(a),null!=i&&s.rotate?.(i),"number"==typeof l&&s.clipAngle?.(l),s.scale(Math.min(r/n,o/e)),s.translate([r/2,o/2]),s},aspectRatio:e/n}}function vl(t,n,e){const{type:r,aspectRatio:o}=gl(t,n,e);return{type:t=>{const{parallels:n,domain:e,width:o,height:i}=t,a=r(t);return null!=n&&(a.parallels(n),void 0===e&&a.fitSize([o,i],{type:"Sphere"})),a},aspectRatio:o}}const xl=Hr({stream:t=>t}),wl=Hr(ie({point(t,n){this.stream.point(t,-n)}}));function bl(t,n,e,r,o){const i=e[t]&&"x"===e[t].scale,a=e[n]&&"y"===e[n].scale;if(i&&a)!function(t,n,e,r){const o=e[t],i=e[n],a=o.length,l=e[t]=new Float64Array(a).fill(NaN),s=e[n]=new Float64Array(a).fill(NaN);let c;const u=r.stream({point(t,n){l[c]=t,s[c]=n}});for(c=0;c<a;++c)u.point(o[c],i[c])}(t,n,r,o.projection);else{if(i)throw new Error(`projection requires paired x and y channels; ${t} is missing ${n}`);if(a)throw new Error(`projection requires paired x and y channels; ${n} is missing ${t}`)}}function kl(t,n,e){const{x:r,y:o}=t;let i={};return r&&(i.x=r),o&&(i.y=o),i=Vi(i,n),e.projection&&bl("x","y",t,i,e),r&&(i.x=sl(i.x)),o&&(i.y=sl(i.y)),i}function $l(t={},n){const{document:e=("undefined"!=typeof window?window.document:void 0)}=t;return{document:e,projection:ml(t,n)}}function Ml(t,{document:n}){return ke($e(t).call(n.documentElement))}function Ll(t){let n,e;return(...r)=>((e?.length!==r.length||e.some(((t,n)=>t!==r[n])))&&(e=r,n=t(...r)),n)}const Al=Ll((t=>new Intl.NumberFormat(t))),El=Ll(((t,n)=>new Intl.DateTimeFormat(t,{timeZone:"UTC",...n&&{month:n}}))),zl=Ll(((t,n)=>new Intl.DateTimeFormat(t,{timeZone:"UTC",...n&&{weekday:n}})));function Ol(t="en-US",n="short"){const e=El(t,n);return t=>null==t||isNaN(t=+new Date(Date.UTC(2e3,+t)))?void 0:e.format(t)}function Nl(t="en-US",n="short"){const e=zl(t,n);return t=>null==t||isNaN(t=+new Date(Date.UTC(2001,0,+t)))?void 0:e.format(t)}function Sl(t){return Ar(t,"Invalid Date")}const Cl=function(t="en-US"){const n=function(t="en-US"){const n=Al(t);return t=>null==t||isNaN(t)?void 0:n.format(t)}(t);return t=>(t instanceof Date?Sl:"number"==typeof t?n:qr)(t)}(),Rl="undefined"!=typeof window&&window.devicePixelRatio>1?0:.5;let Tl=0;function jl(){return"plot-clip-"+ ++Tl}function Wl(t,{title:n,href:e,ariaLabel:r,ariaDescription:o,ariaHidden:i,target:a,fill:l,fillOpacity:s,stroke:c,strokeWidth:u,strokeOpacity:f,strokeLinejoin:h,strokeLinecap:d,strokeMiterlimit:p,strokeDasharray:m,strokeDashoffset:y,opacity:g,mixBlendMode:v,paintOrder:x,pointerEvents:w,shapeRendering:b},{ariaLabel:k,fill:$="currentColor",fillOpacity:M,stroke:L="none",strokeOpacity:A,strokeWidth:E,strokeLinecap:z,strokeLinejoin:O,strokeMiterlimit:N,paintOrder:S}){null===$&&(l=null,s=null),null===L&&(c=null,f=null),Oo($)?Oo(L)||Oo(l)||(L="none"):Oo(L)&&!Oo(c)&&($="none");const[C,R]=Yr(l,$),[T,j]=Zr(s,M),[W,B]=Yr(c,L),[D,F]=Zr(f,A),[q,_]=Zr(g);No(B)||(void 0===u&&(u=E),void 0===d&&(d=z),void 0===h&&(h=O),void 0!==p||/^\s*round\s*$/i.test(h)||(p=N),No(R)||void 0!==x||(x=S));const[I,P]=Zr(u);return null!==$&&(t.fill=Zl(R,"currentColor"),t.fillOpacity=Gl(j,1)),null!==L&&(t.stroke=Zl(B,"none"),t.strokeWidth=Gl(P,1),t.strokeOpacity=Gl(F,1),t.strokeLinejoin=Zl(h,"miter"),t.strokeLinecap=Zl(d,"butt"),t.strokeMiterlimit=Gl(p,4),t.strokeDasharray=Zl(m,"none"),t.strokeDashoffset=Zl(y,"0")),t.target=qr(a),t.ariaLabel=qr(k),t.ariaDescription=qr(o),t.ariaHidden=qr(i),t.opacity=Gl(_,1),t.mixBlendMode=Zl(v,"normal"),t.paintOrder=Zl(x,"normal"),t.pointerEvents=Zl(w,"auto"),t.shapeRendering=Zl(b,"auto"),{title:{value:n,optional:!0},href:{value:e,optional:!0},ariaLabel:{value:r,optional:!0},fill:{value:C,scale:"auto",optional:!0},fillOpacity:{value:T,scale:"opacity",optional:!0},stroke:{value:W,scale:"auto",optional:!0},strokeOpacity:{value:D,scale:"opacity",optional:!0},strokeWidth:{value:I,optional:!0},opacity:{value:q,scale:"opacity",optional:!0}}}function Bl(t,n){n&&t.text((t=>Cl(n[t])))}function Dl(t,n){n&&t.text((([t])=>Cl(n[t])))}function Fl(t,{target:n},{ariaLabel:e,title:r,fill:o,fillOpacity:i,stroke:a,strokeOpacity:l,strokeWidth:s,opacity:c,href:u}){e&&Vl(t,"aria-label",(t=>e[t])),o&&Vl(t,"fill",(t=>o[t])),i&&Vl(t,"fill-opacity",(t=>i[t])),a&&Vl(t,"stroke",(t=>a[t])),l&&Vl(t,"stroke-opacity",(t=>l[t])),s&&Vl(t,"stroke-width",(t=>s[t])),c&&Vl(t,"opacity",(t=>c[t])),u&&Hl(t,(t=>u[t]),n),function(t,n){n&&t.filter((t=>Jo(n[t]))).append("title").call(Bl,n)}(t,r)}function ql(t,{target:n},{ariaLabel:e,title:r,fill:o,fillOpacity:i,stroke:a,strokeOpacity:l,strokeWidth:s,opacity:c,href:u}){e&&Vl(t,"aria-label",(([t])=>e[t])),o&&Vl(t,"fill",(([t])=>o[t])),i&&Vl(t,"fill-opacity",(([t])=>i[t])),a&&Vl(t,"stroke",(([t])=>a[t])),l&&Vl(t,"stroke-opacity",(([t])=>l[t])),s&&Vl(t,"stroke-width",(([t])=>s[t])),c&&Vl(t,"opacity",(([t])=>c[t])),u&&Hl(t,(([t])=>u[t]),n),function(t,n){n&&t.filter((([t])=>Jo(n[t]))).append("title").call(Dl,n)}(t,r)}function _l(t,n,e){const r=Z(t,(t=>n[t]));return void 0===e&&r.size>t.length>>1&&qa("Warning: the implicit z channel has high cardinality. This may occur when the fill or stroke channel is associated with quantitative data rather than ordinal or categorical data. You can suppress this warning by setting the z option explicitly; if this data represents a single series, set z to null."),r.values()}function*Il(t,n,{z:e},r){const{z:o}=r,i=function({ariaLabel:t,title:n,fill:e,fillOpacity:r,stroke:o,strokeOpacity:i,strokeWidth:a,opacity:l,href:s}){return[t,n,e,r,o,i,a,l,s].filter((t=>void 0!==t))}(r),a=[...n,...i];for(const n of o?_l(t,o,e):[t]){let t,e;t:for(const r of n){for(const t of a)if(!Yo(t[r])){e&&e.push(-1);continue t}if(void 0!==t){e.push(r);for(let n=0;n<i.length;++n){if(uo(i[n][r])!==t[n]){yield e,t=i.map((t=>uo(t[r]))),e=[r];continue t}}}else e&&(yield e),t=i.map((t=>uo(t[r]))),e=[r]}e&&(yield e)}}function Pl(t,n,e,r){!function(t,n,e,r){let o;switch(n.clip){case"frame":{const{width:n,height:i,marginLeft:a,marginRight:l,marginTop:s,marginBottom:c}=e,u=jl();o=`url(#${u})`,t=Ml("svg:g",r).call((t=>t.append("svg:clipPath").attr("id",u).append("rect").attr("x",a).attr("y",s).attr("width",n-l-a).attr("height",i-s-c))).each((function(){this.appendChild(t.node()),t.node=()=>this}));break}case"sphere":{const{projection:n}=r;if(!n)throw new Error('the "sphere" clip option requires a projection');const e=jl();o=`url(#${e})`,t.append("clipPath").attr("id",e).append("path").attr("d",ae(n)({type:"Sphere"}));break}}Vl(t,"aria-label",n.ariaLabel),Vl(t,"aria-description",n.ariaDescription),Vl(t,"aria-hidden",n.ariaHidden),Vl(t,"clip-path",o)}(t,n,e,r),Vl(t,"fill",n.fill),Vl(t,"fill-opacity",n.fillOpacity),Vl(t,"stroke",n.stroke),Vl(t,"stroke-width",n.strokeWidth),Vl(t,"stroke-opacity",n.strokeOpacity),Vl(t,"stroke-linejoin",n.strokeLinejoin),Vl(t,"stroke-linecap",n.strokeLinecap),Vl(t,"stroke-miterlimit",n.strokeMiterlimit),Vl(t,"stroke-dasharray",n.strokeDasharray),Vl(t,"stroke-dashoffset",n.strokeDashoffset),Vl(t,"shape-rendering",n.shapeRendering),Vl(t,"paint-order",n.paintOrder),Vl(t,"pointer-events",n.pointerEvents)}function Ul(t,n){!function(t,n,e){null!=e&&t.style(n,e)}(t,"mix-blend-mode",n.mixBlendMode),Vl(t,"opacity",n.opacity)}function Hl(t,n,e){t.each((function(t){const r=n(t);if(null!=r){const t=this.ownerDocument.createElementNS(Me.svg,"a");t.setAttribute("fill","inherit"),t.setAttributeNS(Me.xlink,"href",r),null!=e&&t.setAttribute("target",e),this.parentNode.insertBefore(t,this).appendChild(this)}}))}function Vl(t,n,e){null!=e&&t.attr(n,e)}function Yl(t,n,{x:e,y:r},o=Rl,i=Rl){o+=n.dx,i+=n.dy,e?.bandwidth&&(o+=e.bandwidth()/2),r?.bandwidth&&(i+=r.bandwidth()/2),(o||i)&&t.attr("transform",`translate(${o},${i})`)}function Zl(t,n){if((t=qr(t))!==n)return t}function Gl(t,n){if((t=_r(t))!==n)return t}const Jl=/^-?([_a-z]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])([_a-z0-9-]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])*$/;function Kl(t){if(void 0===t)return`plot-${Math.random().toString(16).slice(2)}`;if(t=`${t}`,!Jl.test(t))throw new Error(`invalid class name: ${t}`);return t}function Ql(t,n){if("string"==typeof n)t.property("style",n);else if(null!=n)for(const e of t)Object.assign(e.style,n)}function Xl({frameAnchor:t},{width:n,height:e,marginTop:r,marginRight:o,marginBottom:i,marginLeft:a}){return[/left$/.test(t)?a:/right$/.test(t)?n-o:(a+n-o)/2,/^top/.test(t)?r:/^bottom/.test(t)?e-i:(r+e-i)/2]}function ts({x:t,y:n,fy:e,fx:r},o,{projection:i,aspectRatio:a},{width:l,marginTopDefault:s,marginRightDefault:c,marginBottomDefault:u,marginLeftDefault:f}){const h=e?e.scale.domain().length:1,d=function(t,n){if("function"==typeof t?.stream)return.618;if(no(t)&&(t=t.type),null==t)return function(t){for(const n of t)if(n.channels.geometry)return!0;return!1}(n)?.618:void 0;if("function"!=typeof t){const{aspectRatio:n}=yl(t);if(n)return n}return.618}(i,o);if(d){const t=(1.1*h-.1)/(1.1*(r?r.scale.domain().length:1)-.1)*d,n=Math.max(.1,Math.min(10,t));return Math.round((l-f-c)*n+s+u)}const p=n?el(n)?n.scale.domain().length:Math.max(7,17/h):1;if(null!=a){if(a=+a,!(isFinite(a)&&a>0))throw new Error(`invalid aspectRatio: ${a}`);const o=ns("y",n)/(ns("x",t)*a),i=r?r.scale.bandwidth():1,h=e?e.scale.bandwidth():1;return(o*(i*(l-f-c)-t.insetLeft-t.insetRight)+n.insetTop+n.insetBottom)/h+s+u}return!(!n&&!e)*Math.max(1,Math.min(60,p*h))*20+30*!!r+60}function ns(t,n){if(!n)throw new Error(`aspectRatio requires ${t} scale`);const{type:e,domain:r}=n;let o;switch(e){case"linear":case"utc":case"time":o=Number;break;case"pow":{const t=n.scale.exponent();o=n=>Math.pow(n,t);break}case"log":o=Math.log;break;case"point":case"band":return r.length;default:throw new Error(`unsupported ${t} scale for aspectRatio: ${e}`)}const[i,a]=Bn(r);return Math.abs(o(a)-o(i))}function es(t,{fx:n,fy:e}){const r=so(t),o=n?.value,i=e?.value;return n&&e?ot(r,(t=>(t.fx=o[t[0]],t.fy=i[t[0]],t)),(t=>o[t]),(t=>i[t])):n?ot(r,(t=>(t.fx=o[t[0]],t)),(t=>o[t])):ot(r,(t=>(t.fy=i[t[0]],t)),(t=>i[t]))}function rs(t){const n=[],e=new Uint32Array(rt(t,(t=>t.length)));for(const r of t){let o=0;for(const n of t)r!==n&&(e.set(n,o),o+=n.length);n.push(e.slice(0,o))}return n}const os=new Map([["top",is],["right",ss],["bottom",as],["left",ls],["top-left",cs(is,ls)],["top-right",cs(is,ss)],["bottom-left",cs(as,ls)],["bottom-right",cs(as,ss)],["top-empty",function(t,{y:n},{x:e,y:r,empty:o}){if(o)return!1;const i=n?.indexOf(r);if(i>0){const r=n[i-1];return t.find((t=>t.x===e&&t.y===r))?.empty}}],["right-empty",function(t,{x:n},{x:e,y:r,empty:o}){if(o)return!1;const i=n?.indexOf(e);if(i<n?.length-1){const e=n[i+1];return t.find((t=>t.x===e&&t.y===r))?.empty}}],["bottom-empty",function(t,{y:n},{x:e,y:r,empty:o}){if(o)return!1;const i=n?.indexOf(r);if(i<n?.length-1){const r=n[i+1];return t.find((t=>t.x===e&&t.y===r))?.empty}}],["left-empty",function(t,{x:n},{x:e,y:r,empty:o}){if(o)return!1;const i=n?.indexOf(e);if(i>0){const e=n[i-1];return t.find((t=>t.x===e&&t.y===r))?.empty}}],["empty",function(t,n,{empty:e}){return e}]]);function is(t,{y:n},{y:e}){return!n||0===n.indexOf(e)}function as(t,{y:n},{y:e}){return!n||n.indexOf(e)===n.length-1}function ls(t,{x:n},{x:e}){return!n||0===n.indexOf(e)}function ss(t,{x:n},{x:e}){return!n||n.indexOf(e)===n.length-1}function cs(t,n){return function(){return t.apply(null,arguments)&&n.apply(null,arguments)}}function us(t,{channels:{fx:n,fy:e},groups:r}){return n&&e?t.map((({x:t,y:n})=>r.get(t)?.get(n)??[])):n?t.map((({x:t})=>r.get(t)??[])):t.map((({y:t})=>r.get(t)??[]))}function fs(t){return el(t)&&void 0===t.interval?void 0:"tabular-nums"}function hs(t,n){if(null==n)return n;const e=t(n);if(!e)throw new Error(`scale not found: ${n}`);return e}function ds(t,n={},e,r){let{columns:o,tickFormat:i,fontVariant:a=fs(t),swatchSize:l=15,swatchWidth:s=l,swatchHeight:c=l,marginLeft:u=0,className:f,style:h,width:d}=n;const p=$l(n);f=Kl(f),i=function(t,n){return void 0===t?$o(n)?Sl:qr:"function"==typeof t?t:("string"==typeof t?$o(n)?Ae:Ee:Hr)(t)}(i,t.domain);const m=Ml("div",p).attr("class",f).attr("style",`\n        --swatchWidth: ${+s}px;\n        --swatchHeight: ${+c}px;\n      `);let y;return null!=o?(y=`\n      .${f}-swatch {\n        display: flex;\n        align-items: center;\n        break-inside: avoid;\n        padding-bottom: 1px;\n      }\n      .${f}-swatch::before {\n        flex-shrink: 0;\n      }\n      .${f}-label {\n        white-space: nowrap;\n        overflow: hidden;\n        text-overflow: ellipsis;\n      }\n    `,m.style("columns",o).selectAll().data(t.domain).enter().append("div").attr("class",`${f}-swatch`).call(e,t).call((t=>t.append("div").attr("class",`${f}-label`).attr("title",i).text(i)))):(y=`\n      .${f} {\n        display: flex;\n        align-items: center;\n        min-height: 33px;\n        flex-wrap: wrap;\n      }\n      .${f}-swatch {\n        display: inline-flex;\n        align-items: center;\n        margin-right: 1em;\n      }\n    `,m.selectAll().data(t.domain).enter().append("span").attr("class",`${f}-swatch`).call(e,t).append((function(){return this.ownerDocument.createTextNode(i.apply(this,arguments))}))),m.call((t=>t.insert("style","*").text(`\n        .${f} {\n          font-family: system-ui, sans-serif;\n          font-size: 10px;\n          margin-bottom: 0.5em;${void 0===u?"":`\n          margin-left: ${+u}px;`}${void 0===d?"":`\n          width: ${d}px;`}\n        }\n        ${r(f)}\n        ${y}\n      `))).style("font-variant",Zl(a,"normal")).call(Ql,h).node()}const ps=new Map([["symbol",function(t,{fill:n=(void 0!==t.hint?.fill?t.hint.fill:"none"),fillOpacity:e=1,stroke:r=(void 0!==t.hint?.stroke?t.hint.stroke:Oo(n)?"currentColor":"none"),strokeOpacity:o=1,strokeWidth:i=1.5,r:a=4.5,...l}={},s){const[c,u]=Yr(n),[f,h]=Yr(r),d=hs(s,c),p=hs(s,f),m=a*a*Math.PI;return e=Zr(e)[1],o=Zr(o)[1],i=Zr(i)[1],ds(t,l,(n=>n.append("svg").attr("viewBox","-8 -8 16 16").attr("fill","color"===c?t=>d.scale(t):null).attr("stroke","color"===f?t=>p.scale(t):null).append("path").attr("d",(n=>{const e=Oe();return t.scale(n).draw(e,m),e}))),(t=>`.${t}-swatch > svg {\n        width: var(--swatchWidth);\n        height: var(--swatchHeight);\n        margin-right: 0.5em;\n        overflow: visible;\n        fill: ${u};\n        fill-opacity: ${e};\n        stroke: ${h};\n        stroke-width: ${i}px;\n        stroke-opacity: ${o};\n      }`))}],["color",gs],["opacity",function({type:t,interpolate:n,...e},{legend:r=!0,color:o=Ne(0,0,0),...i}){if(!n)throw new Error(`${t} opacity scales are not supported`);!0===r&&(r="ramp");if("ramp"!==`${r}`.toLowerCase())throw new Error(`${r} opacity legends are not supported`);return gs({type:t,...e,interpolate:vs(o)},{legend:r,...i})}]]);function ms(t={}){for(const[n,e]of ps){const r=t[n];if(eo(r)){const o=$l(t);let i;if("symbol"===n){const{fill:n,stroke:e=(void 0===n&&eo(t.color)?"color":void 0)}=t;i={fill:n,stroke:e}}return e(Ja(n,r,i),ys(o,r,t),(n=>eo(t[n])?Ja(n,t[n]):null))}}throw new Error("unknown legend type; no scale found")}function ys(t,{label:n,ticks:e,tickFormat:r}={},o){return function(t={},...n){let e=t;for(const r of n)for(const n in r)if(void 0===e[n]){const o=r[n];e===t?e={...e,[n]:o}:e[n]=o}return e}(o,t,{label:n,ticks:e,tickFormat:r})}function gs(t,{legend:n=!0,...e}){if(!0===n&&(n="ordinal"===t.type?"swatches":"ramp"),void 0!==t.domain)switch(`${n}`.toLowerCase()){case"swatches":return function(t,n){if(!el(t)&&!rl(t))throw new Error(`swatches legend requires ordinal or threshold color scale (not ${t.type})`);return ds(t,n,((t,n)=>t.append("svg").attr("fill",n.scale).append("rect").attr("width","100%").attr("height","100%")),(t=>`.${t}-swatch svg {\n        width: var(--swatchWidth);\n        height: var(--swatchHeight);\n        margin-right: 0.5em;\n      }`))}(t,e);case"ramp":return function(t,n){let{label:e=t.label,tickSize:r=6,width:o=240,height:i=44+r,marginTop:a=18,marginRight:l=0,marginBottom:s=16+r,marginLeft:c=0,style:u,ticks:f=(o-c-l)/64,tickFormat:h,fontVariant:d=fs(t),round:p=!0,className:m}=n;const y=$l(n);m=Kl(m),null===h&&(h=()=>null);const g=Ml("svg",y).attr("class",m).attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("width",o).attr("height",i).attr("viewBox",`0 0 ${o} ${i}`).call((t=>t.append("style").text(`\n        .${m} {\n          display: block;\n          background: white;\n          height: auto;\n          height: intrinsic;\n          max-width: 100%;\n          overflow: visible;\n        }\n        .${m} text {\n          white-space: pre;\n        }\n      `))).call(Ql,u);let v,x=t=>t.selectAll(".tick line").attr("y1",a+s-i);const w=p?(t,n)=>t.rangeRound(n):(t,n)=>t.range(n),{type:b,domain:k,range:$,interpolate:M,scale:L,pivot:A}=t;if(M){const t=void 0===$?M:Jn(1===M.length?La(M):M,$);v=w(L.copy(),gt(qn(c,o-l),Math.min(k.length+(void 0!==A),void 0===$?1/0:$.length)));const n=256,e=y.document.createElement("canvas");e.width=n,e.height=1;const r=e.getContext("2d");for(let e=0,o=n-1;e<n;++e)r.fillStyle=t(e/o),r.fillRect(e,0,1,1);g.append("image").attr("x",c).attr("y",a).attr("width",o-c-l).attr("height",i-a-s).attr("preserveAspectRatio","none").attr("xlink:href",e.toDataURL())}else if("threshold"===b){const t=k,n=void 0===h?t=>t:"string"==typeof h?Ee(h):h;v=w(Wn().domain([-1,$.length-1]),[c,o-l]),g.append("g").selectAll().data($).enter().append("rect").attr("x",((t,n)=>v(n-1))).attr("y",a).attr("width",((t,n)=>v(n)-v(n-1))).attr("height",i-a-s).attr("fill",(t=>t)),f=Qr(t,((t,n)=>n)),h=e=>n(t[e],e)}else v=w(Xn().domain(k),[c,o-l]),g.append("g").selectAll().data(k).enter().append("rect").attr("x",v).attr("y",a).attr("width",Math.max(0,v.bandwidth()-1)).attr("height",i-a-s).attr("fill",L),x=()=>{};return g.append("g").attr("transform",`translate(0,${i-s})`).call(ze(v).ticks(Array.isArray(f)?null:f,"string"==typeof h?h:void 0).tickFormat("function"==typeof h?h:void 0).tickSize(r).tickValues(Array.isArray(f)?f:null)).attr("font-size",null).attr("font-family",null).attr("font-variant",Zl(d,"normal")).call(x).call((t=>t.select(".domain").remove())),void 0!==e&&g.append("text").attr("x",c).attr("y",a-6).attr("fill","currentColor").attr("font-weight","bold").text(e),g.node()}(t,e);default:throw new Error(`unknown legend type: ${n}`)}}function vs(t){const{r:n,g:e,b:r}=Ne(t)||Ne(0,0,0);return t=>`rgba(${n},${e},${r},${t})`}class xs{constructor(t,n={},e={},r){const{facet:o="auto",facetAnchor:i,fx:a,fy:l,sort:s,dx:c=0,dy:u=0,margin:f=0,marginTop:h=f,marginRight:d=f,marginBottom:p=f,marginLeft:m=f,clip:y,channels:g}=e;if(this.data=t,this.sort=oo(s)?s:null,this.initializer=ni(e).initializer,this.transform=this.initializer?e.transform:ti(e).transform,null===o||!1===o?this.facet=null:(this.facet=Jr(!0===o?"include":o,"facet",["auto","include","exclude","super"]),this.fx=a,this.fy=l),this.facetAnchor=function(t){if(null==t)return null;const n=os.get(`${t}`.toLowerCase());if(n)return n;throw new Error(`invalid facet anchor: ${t}`)}(i),n=Ro(n),void 0!==g&&(n={...Ro(g),...n}),void 0!==r&&(n={...Wl(this,e,r),...n}),this.channels=Object.fromEntries(Object.entries(n).map((([t,n])=>{const{value:e}=n;return ro(e)&&(n={...n,value:e.value},void 0!==e.scale&&(n.scale=e.scale)),[t,n]})).filter((([t,{value:n,optional:e}])=>{if(null!=n)return!0;if(e)return!1;throw new Error(`missing channel value: ${t}`)}))),this.dx=+c,this.dy=+u,this.marginTop=+h,this.marginRight=+d,this.marginBottom=+p,this.marginLeft=+m,this.clip=function(t){return!0===t?t="frame":!1===t&&(t=null),Gr(t,"clip",["frame","sphere"])}(y),"super"===this.facet){if(a||l)throw new Error("super-faceting cannot use fx or fy");for(const t in this.channels){const{scale:e}=n[t];if("x"===e||"y"===e)throw new Error("super-faceting cannot use x or y")}}}initialize(t,n){let e=Kr(this.data);void 0===t&&null!=e&&(t=[so(e)]),null!=this.transform&&(({facets:t,data:e}=this.transform(e,t)),e=Kr(e));const r=Hi(this.channels,e);return null!=this.sort&&function(t,n,e,r){const{reverse:o,reduce:i=!0,limit:a}=r;for(const l in r){if(!qo.has(l))continue;let{value:s,reverse:c=o,reduce:u=i,limit:f=a}=vo(r[l]);if(void 0===c&&(c="width"===s||"height"===s),null==u||!1===u)continue;const h=Zi(t,l)||n&&Zi(n,l);if(!h)throw new Error(`missing channel for scale: ${l}`);const d=h.value,[p=0,m=1/0]=wo(f)?f:f<0?[f]:[0,f];if(null==s)h.domain=()=>{let t=d;return c&&(t=t.slice().reverse()),0===p&&m===1/0||(t=t.slice(p,m)),t};else{const n="data"===s?e:"height"===s?Gi(t,"y1","y2"):"width"===s?Gi(t,"x1","x2"):Ji(t,s,"y"===s?"y2":"x"===s?"x2":void 0),r=Mi(!0===u?"max":u,n);h.domain=()=>{let t=ot(so(d),(t=>r.reduce(t,n)),(t=>d[t]));return t=Y(t,c?Qi:Ki),0===p&&m===1/0||(t=t.slice(p,m)),t.map(Ir)}}}}(r,n,e,this.sort),{data:e,facets:t,channels:r}}filter(t,n,e){for(const r in n){const{filter:o=Yo}=n[r];if(null!==o){const n=e[r];t=t.filter((t=>o(n[t])))}}return t}project(t,n,e){bl("x","y",t,n,e),bl("x1","y1",t,n,e),bl("x2","y2",t,n,e)}scale(t,n,e){const r=Vi(t,n);return e.projection&&this.project(t,r,e),r}}function ws(...t){return t.plot=xs.prototype.plot,t}const bs=Math.PI/180;function ks({inset:t,insetLeft:n,insetRight:e,...r}={}){return[n,e]=Ms(t,n,e),{inset:t,insetLeft:n,insetRight:e,...r}}function $s({inset:t,insetTop:n,insetBottom:e,...r}={}){return[n,e]=Ms(t,n,e),{inset:t,insetTop:n,insetBottom:e,...r}}function Ms(t,n,e){return void 0===t&&void 0===n&&void 0===e?Rl?[1,0]:[.5,.5]:[n,e]}function Ls(t,{interval:n}){return(t={...vo(t)}).interval=go(void 0===t.interval?n:t.interval),t}function As(t,n,e,r){const{[t]:o,[`${t}1`]:i,[`${t}2`]:a}=e,{value:l,interval:s}=Ls(o,e);if(null==l||null==s&&!r)return e;const c=mo(o);if(null==s){let n;const r={transform:t=>n||(n=Tr(t,l)),label:c};return{...e,[t]:void 0,[`${t}1`]:void 0===i?r:i,[`${t}2`]:void 0===a?r:a}}let u,f;function h(t){return void 0!==f&&t===u?f:f=Qr(Tr(u=t,l),(t=>s.floor(t)))}return n({...e,[t]:void 0,[`${t}1`]:void 0===i?{transform:h,label:c}:i,[`${t}2`]:void 0===a?{transform:t=>h(t).map((t=>s.offset(t))),label:c}:a})}function Es(t,n,e){const{[t]:r}=e,{value:o,interval:i}=Ls(r,e);return null==o||null==i?e:n({...e,[t]:{label:mo(r),transform:t=>{const n=Qr(Tr(t,o),(t=>i.floor(t))),e=n.map((t=>i.offset(t)));return n.map($o(n)?(t,n)=>null==t||isNaN(t=+t)||null==(n=e[n])||isNaN(n=+n)?void 0:new Date((t+n)/2):(t,n)=>null==t||null==(n=e[n])?NaN:(+t+ +n)/2)}}})}function zs(t={}){return As("x",ks,t,!0)}function Os(t={}){return As("y",$s,t,!0)}function Ns(t={}){return As("x",ks,t)}function Ss(t={}){return As("y",$s,t)}function Cs(t={}){return Es("x",ks,t)}function Rs(t={}){return Es("y",$s,t)}const Ts={ariaLabel:"rule",fill:null,stroke:"currentColor"};class js extends xs{constructor(t,n={}){const{x:e,y1:r,y2:o,inset:i=0,insetTop:a=i,insetBottom:l=i}=n;super(t,{x:{value:e,scale:"x",optional:!0},y1:{value:r,scale:"y",optional:!0},y2:{value:o,scale:"y",optional:!0}},n,Ts),this.insetTop=_r(a),this.insetBottom=_r(l)}render(t,n,e,r,o){const{x:i,y:a}=n,{x:l,y1:s,y2:c}=e,{width:u,height:f,marginTop:h,marginRight:d,marginLeft:p,marginBottom:m}=r,{insetTop:y,insetBottom:g}=this;return Ml("svg:g",o).call(Pl,this,r).call(Yl,this,{x:l&&i},Rl,0).call((n=>n.selectAll().data(t).enter().append("line").call(Ul,this).attr("x1",l?t=>l[t]:(p+u-d)/2).attr("x2",l?t=>l[t]:(p+u-d)/2).attr("y1",s&&!ol(a)?t=>s[t]+y:h+y).attr("y2",c&&!ol(a)?a.bandwidth?t=>c[t]+a.bandwidth()-g:t=>c[t]-g:f-m-g).call(Fl,this,e))).node()}}class Ws extends xs{constructor(t,n={}){const{x1:e,x2:r,y:o,inset:i=0,insetRight:a=i,insetLeft:l=i}=n;super(t,{y:{value:o,scale:"y",optional:!0},x1:{value:e,scale:"x",optional:!0},x2:{value:r,scale:"x",optional:!0}},n,Ts),this.insetRight=_r(a),this.insetLeft=_r(l)}render(t,n,e,r,o){const{x:i,y:a}=n,{y:l,x1:s,x2:c}=e,{width:u,height:f,marginTop:h,marginRight:d,marginLeft:p,marginBottom:m}=r,{insetLeft:y,insetRight:g}=this;return Ml("svg:g",o).call(Pl,this,r,o).call(Yl,this,{y:l&&a},0,Rl).call((n=>n.selectAll().data(t).enter().append("line").call(Ul,this).attr("x1",s&&!ol(i)?t=>s[t]+y:p+y).attr("x2",c&&!ol(i)?i.bandwidth?t=>c[t]+i.bandwidth()-g:t=>c[t]-g:u-d-g).attr("y1",l?t=>l[t]:(h+f-m)/2).attr("y2",l?t=>l[t]:(h+f-m)/2).call(Fl,this,e))).node()}}function Bs(t,n){let{x:e=Br,y:r,y1:o,y2:i,...a}=Ss(n);return[o,i]=Fs(r,o,i),new js(t,{...a,x:e,y1:o,y2:i})}function Ds(t,n){let{y:e=Br,x:r,x1:o,x2:i,...a}=Ns(n);return[o,i]=Fs(r,o,i),new Ws(t,{...a,y:e,x1:o,x2:i})}function Fs(t,n,e){if(void 0===t){if(void 0===n){if(void 0!==e)return[0,e]}else if(void 0===e)return[0,n]}else{if(void 0===n)return void 0===e?[0,t]:[t,e];if(void 0===e)return[t,n]}return[n,e]}function qs(t,...n){let e=n.length;for(let r=0,o=!0;r<e;++r)"function"!=typeof n[r]&&(o&&(t=t.slice(),o=!1),t.splice(r,2,t[r]+n[r]+t[r+1]),n.splice(r,1),--r,--e);return r=>{let o=t[0];for(let i=0;i<e;++i)o+=n[i](r)+t[i+1];return o}}const _s={ariaLabel:"text",strokeLinejoin:"round",strokeWidth:3,paintOrder:"stroke"};class Is extends xs{constructor(t,n={}){const{x:e,y:r,text:o=(wo(t)&&bo(t)?Br:Wr),frameAnchor:i,textAnchor:a=(/right$/i.test(i)?"end":/left$/i.test(i)?"start":"middle"),lineAnchor:l=(/^top/i.test(i)?"top":/^bottom/i.test(i)?"bottom":"middle"),lineHeight:s=1,lineWidth:c=1/0,textOverflow:u,monospace:f,fontFamily:h=(f?"ui-monospace, monospace":void 0),fontSize:d,fontStyle:p,fontVariant:m,fontWeight:y,rotate:g}=n,[v,x]=Zr(g,0),[w,b]=function(t){return null==t||"number"==typeof t?[void 0,t]:"string"!=typeof t?[t,void 0]:(t=t.trim().toLowerCase(),Zs.has(t)||/^[+-]?\d*\.?\d+(e[+-]?\d+)?(\w*|%)$/.test(t)?[void 0,t]:[t,void 0])}(d);var k;if(super(t,{x:{value:e,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},fontSize:{value:w,optional:!0},rotate:{value:(k=v,null==k?null:{transform:t=>Tr(t,k,Float64Array),label:mo(k)}),optional:!0},text:{value:o,filter:Jo,optional:!0}},n,_s),this.rotate=x,this.textAnchor=Zl(a,"middle"),this.lineAnchor=Jr(l,"lineAnchor",["top","middle","bottom"]),this.lineHeight=+s,this.lineWidth=+c,this.textOverflow=function(t){return null==t?null:Jr(t,"textOverflow",["clip","ellipsis","clip-start","clip-end","ellipsis-start","ellipsis-middle","ellipsis-end"]).replace(/^(clip|ellipsis)$/,"$1-end")}(u),this.monospace=!!f,this.fontFamily=qr(h),this.fontSize=b,this.fontStyle=qr(p),this.fontVariant=qr(m),this.fontWeight=qr(y),this.frameAnchor=So(i),!(this.lineWidth>=0))throw new Error(`invalid lineWidth: ${c}`);this.splitLines=function({monospace:t,lineWidth:n,textOverflow:e}){if(null!=e||n==1/0)return t=>t.split(/\r\n?|\n/g);const r=t?Ks:Js,o=100*n;return t=>function(t,n,e){const r=[];let o,i=0;for(const[a,l,s]of function*(t){let n=0,e=0;const r=t.length;for(;e<r;){let r=1;switch(t[e]){case"­":case"-":++e,yield[n,e,!1],n=e;break;case" ":for(yield[n,e,!1];" "===t[++e];);n=e;break;case"\r":"\n"===t[e+1]&&++r;case"\n":yield[n,e,!0],e+=r,n=e;break;default:++e}}yield[n,e,!0]}(t))void 0===o&&(o=a),i>o&&e(t,o,l)>n&&(r.push(t.slice(o,i)+("­"===t[i-1]?"-":"")),o=a),s?(r.push(t.slice(o,l)),o=void 0):i=l;return r}(t,o,r)}(this),this.clipLine=function({monospace:t,lineWidth:n,textOverflow:e}){if(null==e||n==1/0)return t=>t;const r=t?Ks:Js,o=100*n;switch(e){case"clip-start":return t=>tc(t,o,r,"");case"clip-end":return t=>Xs(t,o,r,"");case"ellipsis-start":return t=>tc(t,o,r,"…");case"ellipsis-middle":return t=>function(t,n,e,r){t=t.trim();const o=e(t);if(o<=n)return t;const i=e(r)/2,[a,l]=Qs(t,n/2,e,i),[s]=Qs(t,o-n/2-l+i,e,-i);return s<0?r:t.slice(0,a).trimEnd()+r+t.slice(rc(t,s)).trimStart()}(t,o,r,"…");case"ellipsis-end":return t=>Xs(t,o,r,"…")}}(this)}render(t,n,e,r,o){const{x:i,y:a}=n,{x:l,y:s,rotate:c,text:u,title:f,fontSize:h}=e,{rotate:d}=this,[p,m]=Xl(this,r);return Ml("svg:g",o).call(Pl,this,r,o).call(Ys,this,u,r).call(Yl,this,{x:l&&i,y:s&&a}).call((n=>n.selectAll().data(t).enter().append("text").call(Ul,this).call(Ps,this,u,f).attr("transform",qs`translate(${l?t=>l[t]:p},${s?t=>s[t]:m})${c?t=>` rotate(${c[t]})`:d?` rotate(${d})`:""}`).call(Vl,"font-size",h&&(t=>h[t])).call(Fl,this,e))).node()}}function Ps(t,n,e,r){if(!e)return;const{lineAnchor:o,lineHeight:i,textOverflow:a,splitLines:l,clipLine:s}=n;t.each((function(t){const n=l(Cl(e[t])).map(s),c=n.length,u="top"===o?.71:"bottom"===o?1-c:(164-100*c)/200;if(c>1)for(let t=0;t<c;++t){if(!n[t])continue;const e=this.ownerDocument.createElementNS(Me.svg,"tspan");e.setAttribute("x",0),e.setAttribute("y",(u+t)*i+"em"),e.textContent=n[t],this.appendChild(e)}else u&&this.setAttribute("y",u*i+"em"),this.textContent=n[0];if(a&&!r&&n[0]!==e[t]){const n=this.ownerDocument.createElementNS(Me.svg,"title");n.textContent=e[t],this.appendChild(n)}}))}function Us(t,n={}){let{x:e,y:r,...o}=n;return void 0===n.frameAnchor&&([e,r]=ao(e,r)),new Is(t,{...o,x:e,y:r})}function Hs(t,n={}){const{x:e=Br,...r}=n;return new Is(t,Rs({...r,x:e}))}function Vs(t,n={}){const{y:e=Br,...r}=n;return new Is(t,Cs({...r,y:e}))}function Ys(t,n,e){Vl(t,"text-anchor",n.textAnchor),Vl(t,"font-family",n.fontFamily),Vl(t,"font-size",n.fontSize),Vl(t,"font-style",n.fontStyle),Vl(t,"font-variant",void 0===n.fontVariant?function(t){return Ao(t)||$o(t)?"tabular-nums":void 0}(e):n.fontVariant),Vl(t,"font-weight",n.fontWeight)}const Zs=new Set(["inherit","initial","revert","unset","xx-small","x-small","small","medium","large","x-large","xx-large","xxx-large","larger","smaller"]);const Gs={a:56,b:63,c:57,d:63,e:58,f:37,g:62,h:60,i:26,j:26,k:55,l:26,m:88,n:60,o:60,p:62,q:62,r:39,s:54,t:38,u:60,v:55,w:79,x:54,y:55,z:55,A:69,B:67,C:73,D:74,E:61,F:58,G:76,H:75,I:28,J:55,K:67,L:58,M:89,N:75,O:78,P:65,Q:78,R:67,S:65,T:65,U:75,V:69,W:98,X:69,Y:67,Z:67,0:64,1:48,2:62,3:64,4:66,5:63,6:65,7:58,8:65,9:65," ":29,"!":32,'"':49,"'":31,"(":39,")":39,",":31,"-":48,".":31,"/":32,":":31,";":31,"?":52,"‘":31,"’":31,"“":47,"”":47,"…":82};function Js(t,n=0,e=t.length){let r=0;for(let o=n;o<e;o=rc(t,o))r+=Gs[t[o]]??(ic(t,o)?120:Gs.e);return r}function Ks(t,n=0,e=t.length){let r=0;for(let o=n;o<e;o=rc(t,o))r+=ic(t,o)?200:100;return r}function Qs(t,n,e,r){const o=[];let i=0;for(let a=0,l=0,s=t.length;a<s;a=l){l=rc(t,a);const s=e(t,a,l);if(i+s>n){for(i+=r;i>n&&a>0;)l=a,a=o.pop(),i-=e(t,a,l);return[a,n-i]}i+=s,o.push(a)}return[-1,0]}function Xs(t,n,e,r){t=t.trim();const o=e(r),[i]=Qs(t,n,e,o);return i<0?t:t.slice(0,i).trimEnd()+r}function tc(t,n,e,r){const o=e(t=t.trim());if(o<=n)return t;const i=e(r),[a]=Qs(t,o-n+i,e,-i);return a<0?r:r+t.slice(rc(t,a)).trimStart()}const nc=/[\p{Combining_Mark}\p{Emoji_Modifier}]+/uy,ec=/\p{Extended_Pictographic}/uy;function rc(t,n){return n+=function(t,n){const e=t.charCodeAt(n);if(e>=55296&&e<56320){const e=t.charCodeAt(n+1);return e>=56320&&e<57344}return!1}(t,n)?2:1,function(t,n){return!oc(t,n)&&(nc.lastIndex=n,nc.test(t))}(t,n)&&(n=nc.lastIndex),function(t,n){return 8205===t.charCodeAt(n)}(t,n)?rc(t,n+1):n}function oc(t,n){return t.charCodeAt(n)<128}function ic(t,n){return!oc(t,n)&&(ec.lastIndex=n,ec.test(t))}const ac={ariaLabel:"vector",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeLinejoin:"round",strokeLinecap:"round"},lc=3.5,sc=5*lc,cc={draw(t,n,e){const r=n*e/sc;t.moveTo(0,0),t.lineTo(0,-n),t.moveTo(-r,r-n),t.lineTo(0,-n),t.lineTo(r,r-n)}},uc={draw(t,n,e){t.moveTo(-e,0),t.lineTo(0,-n),t.lineTo(e,0)}},fc=new Map([["arrow",cc],["spike",uc]]);class hc extends xs{constructor(t,n={}){const{x:e,y:r,r:o=lc,length:i,rotate:a,shape:l=cc,anchor:s="middle",frameAnchor:c}=n,[u,f]=Zr(i,12),[h,d]=Zr(a,0);super(t,{x:{value:e,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},length:{value:u,scale:"length",optional:!0},rotate:{value:h,optional:!0}},n,ac),this.r=+o,this.length=f,this.rotate=d,this.shape=function(t){if(function(t){return t&&"function"==typeof t.draw}(t))return t;const n=fc.get(`${t}`.toLowerCase());if(n)return n;throw new Error(`invalid shape: ${t}`)}(l),this.anchor=Jr(s,"anchor",["start","middle","end"]),this.frameAnchor=So(c)}render(t,n,e,r,o){const{x:i,y:a}=n,{x:l,y:s,length:c,rotate:u}=e,{length:f,rotate:h,anchor:d,shape:p,r:m}=this,[y,g]=Xl(this,r);return Ml("svg:g",o).call(Pl,this,r,o).call(Yl,this,{x:l&&i,y:s&&a}).call((n=>n.selectAll().data(t).enter().append("path").call(Ul,this).attr("transform",qs`translate(${l?t=>l[t]:y},${s?t=>s[t]:g})${u?t=>` rotate(${u[t]})`:h?` rotate(${h})`:""}${"start"===d?"":"end"===d?c?t=>` translate(0,${c[t]})`:` translate(0,${f})`:c?t=>` translate(0,${c[t]/2})`:` translate(0,${f/2})`}`).attr("d",c?t=>{const n=Oe();return p.draw(n,c[t],m),n}:(()=>{const t=Oe();return p.draw(t,f,m),t})()).call(Fl,this,e))).node()}}function dc(t,n={}){let{x:e,y:r,...o}=n;return void 0===n.frameAnchor&&([e,r]=ao(e,r)),new hc(t,{...o,x:e,y:r})}function pc(t,n={}){const{x:e=Br,...r}=n;return new hc(t,{...r,x:e})}function mc(t,n={}){const{y:e=Br,...r}=n;return new hc(t,{...r,y:e})}function yc(t,n={}){const{shape:e=uc,stroke:r=ac.stroke,strokeWidth:o=1,fill:i=r,fillOpacity:a=.3,anchor:l="start",...s}=n;return dc(t,{...s,shape:e,stroke:r,strokeWidth:o,fill:i,fillOpacity:a,anchor:l})}function gc(t,n){return arguments.length<2&&!wo(t)&&(n=t,t=null),void 0===n&&(n={}),[t,n]}function vc({anchor:t}={},n){return void 0===t?n[0]:Jr(t,"anchor",n)}function xc(t){return vc(t,["left","right"])}function wc(t){return vc(t,["right","left"])}function bc(t){return vc(t,["bottom","top"])}function kc(t){return vc(t,["top","bottom"])}function $c(){const[t,n]=gc(...arguments);return Ec("y",xc(n),t,n)}function Mc(){const[t,n]=gc(...arguments);return Ec("fy",wc(n),t,n)}function Lc(){const[t,n]=gc(...arguments);return zc("x",bc(n),t,n)}function Ac(){const[t,n]=gc(...arguments);return zc("fx",kc(n),t,n)}function Ec(t,n,e,{color:r="currentColor",opacity:o=1,stroke:i=r,strokeOpacity:a=o,strokeWidth:l=1,fill:s=r,fillOpacity:c=o,textAnchor:u,textStroke:f,textStrokeOpacity:h,textStrokeWidth:d,tickSize:p=("y"===t?6:0),tickPadding:m,tickRotate:y,x:g,marginTop:v=20,marginRight:x=("right"===n?40:0),marginBottom:w=20,marginLeft:b=("left"===n?40:0),label:k,labelOffset:$,labelAnchor:M,...L}){return p=_r(p),m=_r(m),y=_r(y),void 0!==M&&(M=Jr(M,"labelAnchor",["center","top","bottom"])),ws(p&&!Oo(i)?function(t,n,e,{strokeWidth:r=1,strokeLinecap:o=null,strokeLinejoin:i=null,facetAnchor:a=n+("y"===t?"-empty":""),frameAnchor:l=n,tickSize:s,inset:c=0,insetLeft:u=c,insetRight:f=c,dx:h=0,y:d=("y"===t?void 0:null),...p}){return Wc(mc,t,`${t}-axis tick`,e,{strokeWidth:r,strokeLinecap:o,strokeLinejoin:i,facetAnchor:a,frameAnchor:l,y:d,...p,dx:"left"===n?+h-Rl+ +u:+h+Rl-f,anchor:"start",length:s,shape:"left"===n?_c:Ic})}(t,n,e,{stroke:i,strokeOpacity:a,strokeWidth:l,tickSize:p,tickPadding:m,tickRotate:y,x:g,...L}):null,Oo(s)?null:function(t,n,e,{facetAnchor:r=n+("y"===t?"-empty":""),frameAnchor:o=n,tickSize:i,tickRotate:a=0,tickPadding:l=Math.max(3,9-i)+(Math.abs(a)>60?4*Math.cos(a*bs):0),tickFormat:s,text:c=("function"==typeof s?s:void 0),textAnchor:u=(Math.abs(a)>60?"middle":"left"===n?"end":"start"),lineAnchor:f=(a>60?"top":a<-60?"bottom":"middle"),fontVariant:h,inset:d=0,insetLeft:p=d,insetRight:m=d,dx:y=0,y:g=("y"===t?void 0:null),...v}){return Wc(Vs,t,`${t}-axis tick label`,e,{facetAnchor:r,frameAnchor:o,text:void 0===c?null:c,textAnchor:u,lineAnchor:f,fontVariant:h,rotate:a,y:g,...v,dx:"left"===n?+y-i-l+ +p:+y+ +i+ +l-m},(function(t,n,e){void 0===h&&(this.fontVariant=Pc(t)),void 0===c&&(e.text=Bc(t,n,s))}))}(t,n,e,{fill:s,fillOpacity:c,stroke:f,strokeOpacity:h,strokeWidth:d,textAnchor:u,tickSize:p,tickPadding:m,tickRotate:y,x:g,marginTop:v,marginRight:x,marginBottom:w,marginLeft:b,...L}),Oo(s)||null===k?null:Us([],{fill:s,fillOpacity:c,...L,lineWidth:void 0,textOverflow:void 0,facet:"super",x:null,y:null,initializer:function(e,r,o,i,a){const l=i[t],{marginTop:s,marginRight:c,marginBottom:u,marginLeft:f}="y"===t&&a.inset||a,h=M??(l.bandwidth?"center":"top"),d=$??("right"===n?c:f)-3;return"center"===h?(this.textAnchor=void 0,this.lineAnchor="right"===n?"bottom":"top",this.frameAnchor=n,this.rotate=-90):(this.textAnchor="right"===n?"end":"start",this.lineAnchor=h,this.frameAnchor=`${h}-${n}`,this.rotate=0),this.dy="top"===h?3-s:"bottom"===h?u-3:0,this.dx="right"===n?d:-d,this.ariaLabel=`${t}-axis label`,{facets:[[0]],channels:{text:{value:[void 0===k?Uc(t,l,h):k]}}}}}))}function zc(t,n,e,{color:r="currentColor",opacity:o=1,stroke:i=r,strokeOpacity:a=o,strokeWidth:l=1,fill:s=r,fillOpacity:c=o,textAnchor:u,textStroke:f,textStrokeOpacity:h,textStrokeWidth:d,tickSize:p=("x"===t?6:0),tickPadding:m,tickRotate:y,y:g,marginTop:v=("top"===n?30:0),marginRight:x=20,marginBottom:w=("bottom"===n?30:0),marginLeft:b=20,label:k,labelAnchor:$,labelOffset:M,...L}){return p=_r(p),m=_r(m),y=_r(y),void 0!==$&&($=Jr($,"labelAnchor",["center","left","right"])),ws(p&&!Oo(i)?function(t,n,e,{strokeWidth:r=1,strokeLinecap:o=null,strokeLinejoin:i=null,facetAnchor:a=n+("x"===t?"-empty":""),frameAnchor:l=n,tickSize:s,inset:c=0,insetTop:u=c,insetBottom:f=c,dy:h=0,x:d=("x"===t?void 0:null),...p}){return Wc(pc,t,`${t}-axis tick`,e,{strokeWidth:r,strokeLinejoin:i,strokeLinecap:o,facetAnchor:a,frameAnchor:l,x:d,...p,dy:"bottom"===n?+h-Rl-f:+h+Rl+ +u,anchor:"start",length:s,shape:"bottom"===n?Fc:qc})}(t,n,e,{stroke:i,strokeOpacity:a,strokeWidth:l,tickSize:p,tickPadding:m,tickRotate:y,y:g,...L}):null,Oo(s)?null:function(t,n,e,{facetAnchor:r=n+("x"===t?"-empty":""),frameAnchor:o=n,tickSize:i,tickRotate:a=0,tickPadding:l=Math.max(3,9-i)+(Math.abs(a)>=10?4*Math.cos(a*bs):0),tickFormat:s,text:c=("function"==typeof s?s:void 0),textAnchor:u=(Math.abs(a)>=10?a<0^"bottom"===n?"start":"end":"middle"),lineAnchor:f=(Math.abs(a)>=10?"middle":"bottom"===n?"top":"bottom"),fontVariant:h,inset:d=0,insetTop:p=d,insetBottom:m=d,dy:y=0,x:g=("x"===t?void 0:null),...v}){return Wc(Hs,t,`${t}-axis tick label`,e,{facetAnchor:r,frameAnchor:o,text:void 0===c?null:c,textAnchor:u,lineAnchor:f,fontVariant:h,rotate:a,x:g,...v,dy:"bottom"===n?+y+ +i+ +l-m:+y-i-l+ +p},(function(t,n,e){void 0===h&&(this.fontVariant=Pc(t)),void 0===c&&(e.text=Bc(t,n,s))}))}(t,n,e,{fill:s,fillOpacity:c,stroke:f,strokeOpacity:h,strokeWidth:d,textAnchor:u,tickSize:p,tickPadding:m,tickRotate:y,y:g,marginTop:v,marginRight:x,marginBottom:w,marginLeft:b,...L}),Oo(s)||null===k?null:Us([],{fill:s,fillOpacity:c,...L,lineWidth:void 0,textOverflow:void 0,facet:"super",x:null,y:null,initializer:function(e,r,o,i,a){const l=i[t],{marginTop:s,marginRight:c,marginBottom:u,marginLeft:f}="x"===t&&a.inset||a,h=$??(l.bandwidth?"center":"right"),d=M??("top"===n?s:u)-3;return"center"===h?(this.frameAnchor=n,this.textAnchor=void 0):(this.frameAnchor=`${n}-${h}`,this.textAnchor="right"===h?"end":"start"),this.lineAnchor=n,this.dy="top"===n?-d:d,this.dx="right"===h?c-3:"left"===h?3-f:0,this.ariaLabel=`${t}-axis label`,{facets:[[0]],channels:{text:{value:[void 0===k?Uc(t,l,h):k]}}}}}))}function Oc(){const[t,n]=gc(...arguments);return Rc("y",xc(n),t,n)}function Nc(){const[t,n]=gc(...arguments);return Rc("fy",wc(n),t,n)}function Sc(){const[t,n]=gc(...arguments);return Tc("x",bc(n),t,n)}function Cc(){const[t,n]=gc(...arguments);return Tc("fx",kc(n),t,n)}function Rc(t,n,e,{y:r=("y"===t?void 0:null),x:o=null,x1:i=("left"===n?o:null),x2:a=("right"===n?o:null),...l}){return Wc(Ds,t,`${t}-grid`,e,{y:r,x1:i,x2:a,...jc(l)})}function Tc(t,n,e,{x:r=("x"===t?void 0:null),y:o=null,y1:i=("top"===n?o:null),y2:a=("bottom"===n?o:null),...l}){return Wc(Bs,t,`${t}-grid`,e,{x:r,y1:i,y2:a,...jc(l)})}function jc({color:t="currentColor",opacity:n=.1,stroke:e=t,strokeOpacity:r=n,strokeWidth:o=1,...i}){return{stroke:e,strokeOpacity:r,strokeWidth:o,...i}}function Wc(t,n,e,r,o,i){let a;const l=t(r,ni(o,(function(t,e,r,l){const{[n]:s}=l;if(!s)throw new Error(`missing scale: ${n}`);let{ticks:c,tickSpacing:u,interval:f}=o;if(nl(s)&&"string"==typeof c&&(f=c,c=void 0),null==t){if(wo(c))t=Kr(c);else if(s.ticks)if(void 0!==c)t=s.ticks(c);else if(f=go(void 0===f?s.interval:f,s.type),void 0!==f){const[n,e]=Bn(s.domain());t=f.range(n,f.offset(f.floor(e)))}else{const[e,r]=Bn(s.range());c=(r-e)/(void 0===u?"x"===n?80:35:u),t=s.ticks(c)}else t=s.domain();"y"===n||"x"===n?e=[so(t)]:(a[n]={scale:n,value:Br},e=void 0)}return i?.call(this,s,c,a),{data:t,facets:e,channels:Object.fromEntries(Object.entries(a).map((([n,e])=>[n,{...e,value:Tr(t,e.value)}])))}})));return null==r?(a=l.channels,l.channels={}):a={},l.ariaLabel=e,l}function Bc(t,n,e){return{value:Dc(t,n,e)}}function Dc(t,n,e){return t.tickFormat?t.tickFormat(wo(n)?null:n,e):void 0===e?Cl:"string"==typeof e?($o(t.domain())?Ae:Ee)(e):Hr(e)}const Fc={draw(t,n){t.moveTo(0,0),t.lineTo(0,n)}},qc={draw(t,n){t.moveTo(0,0),t.lineTo(0,-n)}},_c={draw(t,n){t.moveTo(0,0),t.lineTo(-n,0)}},Ic={draw(t,n){t.moveTo(0,0),t.lineTo(n,0)}};function Pc(t){return t.bandwidth&&void 0===t.interval?void 0:"tabular-nums"}function Uc(t,n,e){const r=n.label;if(n.bandwidth||!r?.inferred)return r;const o=function(t){return Math.sign(Co(t.domain()))*Math.sign(Co(t.range()))}(n);return o?"x"===t||"center"===e?"x"===t==o<0?`← ${r}`:`${r} →`:`${o<0?"↑ ":"↓ "}${r}`:r}const Hc={ariaLabel:"frame",fill:"none",stroke:"currentColor"},Vc={ariaLabel:"frame",fill:null,stroke:"currentColor",strokeLinecap:"square"};class Yc extends xs{constructor(t={}){const{anchor:n=null,inset:e=0,insetTop:r=e,insetRight:o=e,insetBottom:i=e,insetLeft:a=e,rx:l,ry:s}=t;super(void 0,void 0,t,null==n?Hc:Vc),this.anchor=Gr(n,"anchor",["top","right","bottom","left"]),this.insetTop=_r(r),this.insetRight=_r(o),this.insetBottom=_r(i),this.insetLeft=_r(a),this.rx=_r(l),this.ry=_r(s)}render(t,n,e,r,o){const{marginTop:i,marginRight:a,marginBottom:l,marginLeft:s,width:c,height:u}=r,{anchor:f,insetTop:h,insetRight:d,insetBottom:p,insetLeft:m,rx:y,ry:g}=this,v=s+m,x=c-a-d,w=i+h,b=u-l-p;return Ml(f?"svg:line":"svg:rect",o).call(Pl,this,r,o).call(Ul,this).call(Yl,this,{}).call("left"===f?t=>t.attr("x1",v).attr("x2",v).attr("y1",w).attr("y2",b):"right"===f?t=>t.attr("x1",x).attr("x2",x).attr("y1",w).attr("y2",b):"top"===f?t=>t.attr("x1",v).attr("x2",x).attr("y1",w).attr("y2",w):"bottom"===f?t=>t.attr("x1",v).attr("x2",x).attr("y1",b).attr("y2",b):t=>t.attr("x",v).attr("y",w).attr("width",x-v).attr("height",b-w).attr("rx",y).attr("ry",g)).node()}}function Zc(t){return new Yc(t)}function Gc(t={}){const{facet:n,style:e,caption:r,ariaLabel:o,ariaDescription:i}=t,a=Kl(t.className),l=void 0===t.marks?[]:Jc(t.marks),s=function(t,n){if(null==t)return;const{x:e,y:r}=t;if(null==e&&null==r)return;const o=Kr(t.data??e??r);if(void 0===o)throw new Error("missing facet data");const i={};null!=e&&(i.fx=Ui(o,{value:e,scale:"fx"}));null!=r&&(i.fy=Ui(o,{value:r,scale:"fy"}));Xc(i,n);const a=es(o,i);return{channels:i,groups:a,data:t.data}}(n,t),c=new Map;for(const n of l){const e=ru(n,s,t);e&&c.set(n,e)}const u=new Map;s&&eu(u,[s]),eu(u,c);const f=Jc(function(t,n,e){let{projection:r,x:o={},y:i={},fx:a={},fy:l={},axis:s,grid:c,facet:u={},facet:{axis:f=s,grid:h}=u,x:{axis:d=s,grid:p=(null===d?null:c)}=o,y:{axis:m=s,grid:y=(null===m?null:c)}=i,fx:{axis:g=f,grid:v=(null===g?null:h)}=a,fy:{axis:x=f,grid:w=(null===x?null:h)}=l}=e;(r||!eo(o)&&!su("x",t))&&(d=p=null);(r||!eo(i)&&!su("y",t))&&(m=y=null);n.has("fx")||(g=v=null);n.has("fy")||(x=w=null);void 0===d&&(d=!lu(t,"x"));void 0===m&&(m=!lu(t,"y"));void 0===g&&(g=!lu(t,"fx"));void 0===x&&(x=!lu(t,"fy"));!0===d&&(d="bottom");!0===m&&(m="left");!0===g&&(g="top"===d||null===d?"bottom":"top");!0===x&&(x="right"===m||null===m?"left":"right");const b=[];return iu(b,w,Nc,l),ou(b,x,Mc,"right","left",u,l),iu(b,v,Cc,a),ou(b,g,Ac,"top","bottom",u,a),iu(b,y,Oc,i),ou(b,m,$c,"left","right",e,i),iu(b,p,Sc,o),ou(b,d,Lc,"bottom","top",e,o),b}(l,u,t));for(const n of f){const e=ru(n,s,t);e&&c.set(n,e)}l.unshift(...f);const h=function(t,n){const{fx:e,fy:r}=_a(t,n),o=e?.scale.domain(),i=r?.scale.domain();return o&&i?Le(o,i).map((([t,n],e)=>({x:t,y:n,i:e}))):o?o.map(((t,n)=>({x:t,i:n}))):i?i.map(((t,n)=>({y:t,i:n}))):void 0}(u,t);if(void 0!==h){const t=s?us(h,s):void 0;for(const n of l){if(null===n.facet||"super"===n.facet)continue;const e=c.get(n);void 0!==e&&(e.facetsIndex=null!=n.fx||null!=n.fy?us(h,e):t)}const n=new Set;for(const{facetsIndex:t}of c.values())t?.forEach(((t,e)=>{t?.length>0&&n.add(e)}));h.forEach(0<n.size&&n.size<h.length?(t,e)=>t.empty=!n.has(e):t=>t.empty=!1);for(const t of l)if("exclude"===t.facet){const n=c.get(t);void 0!==n&&(n.facetsIndex=rs(n.facetsIndex))}}for(const n of qo.keys())eo(t[n])&&"fx"!==n&&"fy"!==n&&u.set(n,[]);const d=new Map;for(const n of l){if(d.has(n))throw new Error("duplicate mark; each mark must be unique");const{facetsIndex:e,channels:r}=c.get(n)??{},{data:o,facets:i,channels:a}=n.initialize(e,r);Xc(a,t),d.set(n,{data:o,facets:i,channels:a})}const p=_a(eu(u,d),t),m=Ia(p),y=function(t,n,e={}){let r=.5-Rl,o=.5+Rl,i=.5+Rl,a=.5-Rl;for(const{marginTop:t,marginRight:e,marginBottom:l,marginLeft:s}of n)t>r&&(r=t),e>o&&(o=e),l>i&&(i=l),s>a&&(a=s);let{margin:l,marginTop:s=(void 0!==l?l:r),marginRight:c=(void 0!==l?l:o),marginBottom:u=(void 0!==l?l:i),marginLeft:f=(void 0!==l?l:a)}=e;s=+s,c=+c,u=+u,f=+f;let{width:h=640,height:d=ts(t,n,e,{width:h,marginTopDefault:r,marginRightDefault:o,marginBottomDefault:i,marginLeftDefault:a})+Math.max(0,s-r+u-i)}=e;h=+h,d=+d;const p={width:h,height:d,marginTop:s,marginRight:c,marginBottom:u,marginLeft:f};if(t.fx||t.fy){let{margin:t,marginTop:n=(void 0!==t?t:s),marginRight:r=(void 0!==t?t:c),marginBottom:o=(void 0!==t?t:u),marginLeft:i=(void 0!==t?t:f)}=e.facet??{};n=+n,r=+r,o=+o,i=+i,p.facet={marginTop:n,marginRight:r,marginBottom:o,marginLeft:i}}return p}(p,l,t);!function(t,n){const{x:e,y:r,fx:o,fy:i}=t,a=o||i?Ua(n):n;o&&Va(o,a),i&&Ya(i,a);const l=o||i?Ha(t,n):n;e&&Va(e,l),r&&Ya(r,l)}(p,y);const{fx:g,fy:v}=m,x=g||v?Ha(p,y):y,w=g||v?function({fx:t,fy:n},e){const{marginTop:r,marginRight:o,marginBottom:i,marginLeft:a,width:l,height:s}=Ua(e),c=t&&cu(t),u=n&&cu(n);return{marginTop:n?u[0]:r,marginRight:t?l-c[1]:o,marginBottom:n?s-u[1]:i,marginLeft:t?c[0]:a,inset:{marginTop:e.marginTop,marginRight:e.marginRight,marginBottom:e.marginBottom,marginLeft:e.marginLeft},width:l,height:s}}(m,y):y,b=$l(t,x),k=new Set;for(const[n,e]of d)if(null!=n.initializer){const r="super"===n.facet?w:x,o=n.initializer(e.data,e.facets,e.channels,m,r,b);if(void 0!==o.data&&(e.data=o.data),void 0!==o.facets&&(e.facets=o.facets),void 0!==o.channels){nu(o.channels),Object.assign(e.channels,o.channels);for(const n of Object.values(o.channels)){const{scale:e}=n;null!=e&&qo.get(e)!==To&&(tu(n,t),k.add(e))}const{fx:r,fy:i}=o.channels;if(null!=r||null!=i){const t=c.get(n)??{channels:{}};null!=r&&(t.channels.fx=r),null!=i&&(t.channels.fy=i),t.groups=es(e.data,t.channels),t.facetsIndex=e.facets=us(h,t),c.set(n,t)}}}if(k.size){const n=new Map;eu(n,d,(t=>k.has(t))),eu(u,d,(t=>k.has(t)));const e=function(t,n){for(const e in t){const r=t[e],o=n[e];void 0===r.label&&o&&(r.label=o.label)}return t}(_a(n,t),p),r=Ia(e);Object.assign(p,e),Object.assign(m,r)}for(const[t,n]of d)n.values=t.scale(n.channels,m,b);const{width:$,height:M}=y,L=Ml("svg",b).attr("class",a).attr("fill","currentColor").attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("text-anchor","middle").attr("width",$).attr("height",M).attr("viewBox",`0 0 ${$} ${M}`).attr("aria-label",o).attr("aria-description",i).call((t=>t.append("style").text(`\n        .${a} {\n          display: block;\n          background: white;\n          height: auto;\n          height: intrinsic;\n          max-width: 100%;\n        }\n        .${a} text,\n        .${a} tspan {\n          white-space: pre;\n        }\n      `))).call(Ql,e).node();if(void 0!==h){const t={x:g?.domain(),y:v?.domain()};h.sort(function({x:t,y:n}){const e=t&&new Map(t.map(((t,n)=>[t,n]))),r=n&&new Map(n.map(((t,n)=>[t,n])));return t&&n?(t,n)=>e.get(t.x)-e.get(n.x)||r.get(t.y)-r.get(n.y):t?(t,n)=>e.get(t.x)-e.get(n.x):(t,n)=>r.get(t.y)-r.get(n.y)}(t)),ke(L).selectAll().data(h).enter().append("g").attr("aria-label","facet").attr("transform",function(t,n,{marginTop:e,marginLeft:r}){return t&&n?({x:o,y:i})=>`translate(${t(o)-r},${n(i)-e})`:t?({x:n})=>`translate(${t(n)-r},0)`:({y:t})=>`translate(0,${n(t)-e})`}(g,v,y)).each((function(n){let e=!0;for(const r of l){if("super"===r.facet)continue;const{channels:o,values:i,facets:a}=d.get(r);if(!(r.facetAnchor?.(h,t,n)??!n.empty))continue;let l=null;if(a){if(l=a[c.has(r)?n.i:0],l=r.filter(l,o,i),0===l.length)continue;l.fi=n.i}const s=r.render(l,m,i,x,b);null!=s&&(e=!1,this.appendChild(s))}e&&this.remove()}))}for(const t of l){if(void 0!==h&&"super"!==t.facet)continue;const{channels:n,values:e,facets:r}=d.get(t);let o=null;if(r&&(o=r[0],o=t.filter(o,n,e),0===o.length))continue;const i=t.render(o,m,e,w,b);null!=i&&L.appendChild(i)}let A=L;const E=function(t,n,e){const r=[];for(const[o,i]of ps){const a=e[o];if(a?.legend&&o in t){const e=i(t[o],ys(n,t[o],a),(n=>t[n]));null!=e&&r.push(e)}}return r}(p,b,t);if(null!=r||E.length>0){const{document:t}=b;A=t.createElement("figure"),A.style.maxWidth="initial";for(const t of E)A.appendChild(t);if(A.appendChild(L),null!=r){const n=t.createElement("figcaption");n.appendChild(r instanceof Node?r:t.createTextNode(r)),A.appendChild(n)}}A.scale=function(t){return n=>{if(!qo.has(n=`${n}`))throw new Error(`unknown scale: ${n}`);return n in t?hl(t[n]):void 0}}(p),A.legend=function(t,n,e={}){return(r,o)=>{if(!ps.has(r))throw new Error(`unknown legend type: ${r}`);if(r in t)return ps.get(r)(t[r],ys(n,e[r],o),(n=>t[n]))}}(p,b,t);const z=function(){const t=Fa;return Fa=0,t}();return z>0&&ke(L).append("text").attr("x",$).attr("y",20).attr("dy","-1em").attr("text-anchor","end").attr("font-family","initial").text("⚠️").append("title").text(`${z.toLocaleString("en-US")} warning${1===z?"":"s"}. Please check the console.`),A}function Jc(t){return t.flat(1/0).filter((t=>null!=t)).map(Kc)}function Kc(t){return"function"==typeof t.render?t:new Qc(t)}xs.prototype.plot=function({marks:t=[],...n}={}){return Gc({...n,marks:[...t,this]})};class Qc extends xs{constructor(t){if("function"!=typeof t)throw new TypeError("invalid mark; missing render function");super(),this.render=t}render(){}}function Xc(t,n){for(const e in t)tu(t[e],n);return t}function tu(t,n){const{scale:e}=t;if(null==e)return;const{type:r,percent:o,interval:i,transform:a=(o?t=>100*t:go(i,r)?.floor)}=n[e]??{};null!=a&&(t.value=Qr(t.value,a))}function nu(t){for(const n in t)Yi(n,t[n])}function eu(t,n,e=Fr){for(const{channels:r}of n.values())for(const n in r){const o=r[n],{scale:i}=o;if(null!=i&&e(i)){const n=t.get(i);void 0!==n?n.push(o):t.set(i,[o])}}return t}function ru(t,n,e){if(null===t.facet||"super"===t.facet)return;const{fx:r,fy:o}=t;if(null!=r||null!=o){const n=Kr(t.data??r??o);if(void 0===n)throw new Error(`missing facet data in ${t.ariaLabel}`);if(null===n)return;const i={};return null!=r&&(i.fx=Ui(n,{value:r,scale:"fx"})),null!=o&&(i.fy=Ui(n,{value:o,scale:"fy"})),Xc(i,e),{channels:i,groups:es(n,i)}}if(void 0===n)return;const{channels:i,groups:a,data:l}=n;if("auto"!==t.facet||t.data===l)return{channels:i,groups:a};(a.size>1||1===a.size&&i.fx&&i.fy&&[...a][0][1].size>1)&&Kr(t.data)?.length===l.length&&qa(`Warning: the ${t.ariaLabel} mark appears to use faceted data, but isn’t faceted. The mark data has the same length as the facet data and the mark facet option is "auto", but the mark data and facet data are distinct. If this mark should be faceted, set the mark facet option to true; otherwise, suppress this warning by setting the mark facet option to false.`)}function ou(t,n,e,r,o,i,a){if(!n)return;const l=/^\s*both\s*$/i.test(n);a=function(t,n,{line:e=n.line,ticks:r,tickSize:o,tickSpacing:i,tickPadding:a,tickFormat:l,tickRotate:s,fontVariant:c,ariaLabel:u,ariaDescription:f,label:h=n.label,labelAnchor:d,labelOffset:p}){return{anchor:t,line:e,ticks:r,tickSize:o,tickSpacing:i,tickPadding:a,tickFormat:l,tickRotate:s,fontVariant:c,ariaLabel:u,ariaDescription:f,label:h,labelAnchor:d,labelOffset:p}}(l?r:n,i,a);const{line:s}=a;e!==$c&&e!==Lc||!s||No(s)||t.push(Zc(function(t){const{anchor:n,line:e}=t;return{anchor:n,facetAnchor:n+"-empty",stroke:!0===e?void 0:e}}(a))),t.push(e(a)),l&&t.push(e({...a,anchor:o,label:null}))}function iu(t,n,e,r){n&&!No(n)&&t.push(e(function(t,{stroke:n=(zo(t)?t:void 0),ticks:e=(au(t)?t:void 0),tickSpacing:r,ariaLabel:o,ariaDescription:i}){return{stroke:n,ticks:e,tickSpacing:r,ariaLabel:o,ariaDescription:i}}(n,r)))}function au(t){switch(typeof t){case"number":return!0;case"string":return!zo(t)}return wo(t)||"function"==typeof t?.range}function lu(t,n){const e=`${n}-axis `;return t.some((t=>t.ariaLabel?.startsWith(e)))}function su(t,n){for(const e of n)for(const n in e.channels)if(e.channels[n].scale===t)return!0;return!1}function cu(t){const n=t.domain();let e=t(n[0]),r=t(n[n.length-1]);return r<e&&([e,r]=[r,e]),[e,r+t.bandwidth()]}const uu=new Map([["basis",Ce],["basis-closed",Re],["basis-open",Te],["bundle",je],["bump-x",We],["bump-y",Be],["cardinal",De],["cardinal-closed",Fe],["cardinal-open",qe],["catmull-rom",_e],["catmull-rom-closed",Ie],["catmull-rom-open",Pe],["linear",Se],["linear-closed",Ue],["monotone-x",He],["monotone-y",Ve],["natural",Ye],["step",Ze],["step-after",Ge],["step-before",Je]]);function fu(t=Se,n){if("function"==typeof t)return t;const e=uu.get(`${t}`.toLowerCase());if(!e)throw new Error(`unknown curve: ${t}`);if(void 0!==n){if("beta"in e)return e.beta(n);if("tension"in e)return e.tension(n);if("alpha"in e)return e.alpha(n)}return e}function hu(t=du,n){return"function"!=typeof t&&"auto"===`${t}`.toLowerCase()?du:fu(t,n)}function du(t){return Se(t)}function pu(t={y:"count"},n={}){[t,n]=bu(t,n);const{x:e,y:r}=n;return wu(ku(e,n,Br),null,null,r,t,ks(n))}function mu(t={x:"count"},n={}){[t,n]=bu(t,n);const{x:e,y:r}=n;return wu(null,ku(r,n,Br),e,null,t,$s(n))}function yu(t={fill:"count"},n={}){[t,n]=bu(t,n);const{x:e,y:r}=function(t){let{x:n,y:e}=t;return n=ku(n,t),e=ku(e,t),[n.value,e.value]=ao(n.value,e.value),{x:n,y:e}}(n);return wu(e,r,null,null,t,ks($s(n)))}function gu(t,n,e={}){return null==e?.interval?e:t({[n]:void 0===e?.reduce?Ni:e.reduce,filter:null},e)}function vu(t){return gu(pu,"y",t)}function xu(t){return gu(mu,"x",t)}function wu(t,n,e,r,{data:o=Oi,filter:i=Ri,sort:a,reverse:l,...s}={},c={}){t=$u(t),n=$u(n),s=wi(s,c),o=Mi(o,Br),a=null==a?void 0:bi("sort",a,c),i=null==i?void 0:ki("filter",i,c),null!=e&&xi(s,"x","x1","x2")&&(e=null),null!=r&&xi(s,"y","y1","y2")&&(r=null);const[u,f]=po(t),[h,d]=po(t),[p,m]=po(n),[y,g]=po(n),[v,x]=null!=e?[e,"x"]:null!=r?[r,"y"]:[],[w,b]=po(v),{x:k,y:$,z:M,fill:L,stroke:A,x1:E,x2:z,y1:O,y2:N,domain:S,cumulative:C,thresholds:R,interval:T,...j}=c,[W,B]=po(M),[D]=Yr(L),[F]=Yr(A),[q,_]=po(D),[I,P]=po(F);return{..."z"in c&&{z:W||M},..."fill"in c&&{fill:q||L},..."stroke"in c&&{stroke:I||A},...ti(j,((e,r)=>{const c=Tr(e,v),u=Tr(e,M),h=Tr(e,D),p=Tr(e,F),y=Li(s,{z:u,fill:h,stroke:p}),x=[],w=[],k=c&&b([]),$=u&&B([]),L=h&&_([]),A=p&&P([]),E=t&&f([]),z=t&&d([]),O=n&&m([]),N=n&&g([]),S=(C=t?.(e),R=n?.(e),C&&R?function*(t){const n=C.bin(t);for(const[t,[e,r]]of C.entries()){const o=R.bin(n[t]);for(const[t,[n,i]]of R.entries())yield[o[t],{x1:e,y1:n,x2:r,y2:i}]}}:C?function*(t){const n=C.bin(t);for(const[t,[e,r]]of C.entries())yield[n[t],{x1:e,x2:r}]}:function*(t){const n=R.bin(t);for(const[t,[e,r]]of R.entries())yield[n[t],{y1:e,y2:r}]});var C,R;let T=0;for(const t of s)t.initialize(e);a&&a.initialize(e),i&&i.initialize(e);for(const t of r){const n=[];for(const n of s)n.scope("facet",t);a&&a.scope("facet",t),i&&i.scope("facet",t);for(const[r,l]of $i(t,y))for(const[t,f]of $i(l,c))for(const[l,d]of S(f))if(!i||i.reduce(l,d)){n.push(T++),w.push(o.reduce(l,e,d)),c&&k.push(t),u&&$.push(y===u?r:u[l[0]]),h&&L.push(y===h?r:h[l[0]]),p&&A.push(y===p?r:p[l[0]]),E&&(E.push(d.x1),z.push(d.x2)),O&&(O.push(d.y1),N.push(d.y2));for(const t of s)t.reduce(l,d);a&&a.reduce(l)}x.push(n)}return Ai(x,a,l),{data:w,facets:x}})),...!xi(s,"x")&&(u?{x1:u,x2:h,x:yo(u,h)}:{x:k,x1:E,x2:z}),...!xi(s,"y")&&(p?{y1:p,y2:y,y:yo(p,y)}:{y:$,y1:O,y2:N}),...w&&{[x]:w},...Object.fromEntries(s.map((({name:t,output:n})=>[t,n])))}}function bu({cumulative:t,domain:n,thresholds:e,interval:r,...o},i){return[o,{cumulative:t,domain:n,thresholds:e,interval:r,...i}]}function ku(t,{cumulative:n,domain:e,thresholds:r,interval:o},i){return void 0===(t={...vo(t)}).domain&&(t.domain=e),void 0===t.cumulative&&(t.cumulative=n),void 0===t.thresholds&&(t.thresholds=r),void 0===t.interval&&(t.interval=o),void 0===t.value&&(t.value=i),t.thresholds=Mu(t.thresholds,t.interval),t}function $u(t){if(null==t)return;const{value:n,cumulative:e,domain:r=Bn,thresholds:o}=t,i=t=>{let i,a=Tr(t,n);if($o(a)||(function(t){return Au(t)&&"function"==typeof t&&t()instanceof Date}(l=o)||wo(l)&&$o(l))){a=Qr(a,ul,Float64Array);let[t,n]="function"==typeof r?r(a):r,e="function"!=typeof o||Au(o)?o:o(a,t,n);"number"==typeof e&&(e=tr(t,n,e)),Au(e)&&(r===Bn&&(t=e.floor(t),n=e.offset(e.floor(n))),e=e.range(t,e.offset(n))),i=e}else{a=Qr(a,cl,Float64Array);let[t,n]="function"==typeof r?r(a):r,e="function"!=typeof o||Au(o)?o:o(a,t,n);if("number"==typeof e)if(r===Bn){let r=nr(t,n,e);if(isFinite(r))if(r>0){let o=Math.round(t/r),i=Math.round(n/r);o*r<=t||--o,i*r>n||++i;let a=i-o+1;e=new Float64Array(a);for(let t=0;t<a;++t)e[t]=(o+t)*r}else if(r<0){r=-r;let o=Math.round(t*r),i=Math.round(n*r);o/r<=t||--o,i/r>n||++i;let a=i-o+1;e=new Float64Array(a);for(let t=0;t<a;++t)e[t]=(o+t)/r}else e=[t];else e=[t]}else e=In(t,n,e);else Au(e)&&(r===Bn&&(t=e.floor(t),n=e.offset(e.floor(n))),e=e.range(t,e.offset(n)));i=e}var l;const s=[];if(1===i.length)s.push([i[0],i[0]]);else for(let t=1;t<i.length;++t)s.push([i[t-1],i[t]]);return s.bin=(e<0?Ou:e>0?zu:Eu)(s,i,a),s};return i.label=mo(n),i}function Mu(t,n,e=Lu){if(void 0===t)return void 0===n?e:function(t){if(!Au(t=go(t)))throw new Error(`invalid interval: ${t}`);return t}(n);if("string"==typeof t){switch(t.toLowerCase()){case"freedman-diaconis":return Xe;case"scott":return Qe;case"sturges":return Ke;case"auto":return Lu}const n=go(t);if(void 0!==n)return n;throw new Error(`invalid thresholds: ${t}`)}return t}function Lu(t,n,e){return Math.min(200,Qe(t,n,e))}function Au(t){return!!t&&"function"==typeof t.range}function Eu(t,n,e){return n=n.map(cl),r=>{const o=t.map((()=>[]));for(const t of r)o[er(n,e[t])-1]?.push(t);return o}}function zu(t,n,e){const r=Eu(t,n,e);return t=>{const n=r(t);for(let t=1,e=n.length;t<e;++t){const e=n[t-1],r=n[t];for(const t of e)r.push(t)}return n}}function Ou(t,n,e){const r=Eu(t,n,e);return t=>{const n=r(t);for(let t=n.length-2;t>=0;--t){const e=n[t+1],r=n[t];for(const t of e)r.push(t)}return n}}function Nu(t={}){const{x:n,x1:e,x2:r}=t;return void 0===e&&void 0===r&&void 0===n?{...t,x:Br}:t}function Su(t={}){const{y:n,y1:e,y2:r}=t;return void 0===e&&void 0===r&&void 0===n?{...t,y:Br}:t}function Cu(t={},n={}){1===arguments.length&&([t,n]=qu(t));const{y1:e,y:r=e,x:o,...i}=n,[a,l,s,c]=_u(r,o,"x",t,i);return{...a,y1:e,y:l,x1:s,x2:c,x:yo(s,c)}}function Ru(t={},n={}){1===arguments.length&&([t,n]=qu(t));const{y1:e,y:r=e,x:o}=n,[i,a,l]=_u(r,o,"x",t,n);return{...i,y1:e,y:a,x:l}}function Tu(t={},n={}){1===arguments.length&&([t,n]=qu(t));const{y1:e,y:r=e,x:o}=n,[i,a,,l]=_u(r,o,"x",t,n);return{...i,y1:e,y:a,x:l}}function ju(t={},n={}){1===arguments.length&&([t,n]=qu(t));const{x1:e,x:r=e,y:o,...i}=n,[a,l,s,c]=_u(r,o,"y",t,i);return{...a,x1:e,x:l,y1:s,y2:c,y:yo(s,c)}}function Wu(t={},n={}){1===arguments.length&&([t,n]=qu(t));const{x1:e,x:r=e,y:o}=n,[i,a,l]=_u(r,o,"y",t,n);return{...i,x1:e,x:a,y:l}}function Bu(t={},n={}){1===arguments.length&&([t,n]=qu(t));const{x1:e,x:r=e,y:o}=n,[i,a,,l]=_u(r,o,"y",t,n);return{...i,x1:e,x:a,y:l}}function Du({x:t,x1:n,x2:e,...r}={}){return void 0===n&&void 0===e?Cu({x:t,...r}):([n,e]=io(t,n,e),{...r,x1:n,x2:e})}function Fu({y:t,y1:n,y2:e,...r}={}){return void 0===n&&void 0===e?ju({y:t,...r}):([n,e]=io(t,n,e),{...r,y1:n,y2:e})}function qu(t){const{offset:n,order:e,reverse:r,...o}=t;return[{offset:n,order:e,reverse:r},o]}const _u=function(t,n=Dr,e,{offset:r,order:o,reverse:i},a){const l=lo(a),[s,c]=po(t),[u,f]=ho(n),[h,d]=ho(n);return r=function(t){if(null==t)return;if("function"==typeof t)return t;switch(`${t}`.toLowerCase()){case"expand":case"normalize":return Pu;case"center":case"silhouette":return Uu;case"wiggle":return Hu}throw new Error(`unknown offset: ${t}`)}(r),o=function(t,n,e){if(void 0===t&&n===Hu)return Qu;if(null==t)return;if("string"==typeof t){switch(t.toLowerCase()){case"value":case e:return Zu;case"z":return Gu;case"sum":return Ju;case"appearance":return Ku;case"inside-out":return Qu}return Xu(jr(t))}if("function"==typeof t)return Xu(t);if(Array.isArray(t))return r=t,(t,n,e,o)=>tf(o,r);var r;throw new Error(`invalid order: ${t}`)}(o,r,e),[ti(a,((e,a)=>{const s=null==t?void 0:c(Tr(e,t)),u=Tr(e,n,Float64Array),h=Tr(e,l),p=o&&o(e,s,u,h),m=e.length,y=f(new Float64Array(m)),g=d(new Float64Array(m)),v=[];for(const t of a){const n=s?Array.from(Z(t,(t=>s[t])).values()):[t];p&&nf(n,p);for(const t of n){let n=0,e=0;i&&t.reverse();for(const r of t){const t=u[r];t<0?n=g[r]=(y[r]=n)+t:t>0?e=g[r]=(y[r]=e)+t:g[r]=y[r]=e}}v.push(n)}return r&&r(v,y,g,h),{data:e,facets:a}})),s,u,h]};function Iu(t,n){let e=0,r=0;for(const o of t){const t=n[o];t<e&&(e=t),t>r&&(r=t)}return[e,r]}function Pu(t,n,e){for(const r of t)for(const t of r){const[r,o]=Iu(t,e);for(const i of t){const t=1/(o-r||1);n[i]=t*(n[i]-r),e[i]=t*(e[i]-r)}}}function Uu(t,n,e){for(const r of t){for(const t of r){const[r,o]=Iu(t,e);for(const i of t){const t=(o+r)/2;n[i]-=t,e[i]-=t}}Vu(r,n,e)}Yu(t,n,e)}function Hu(t,n,e,r){for(const o of t){const t=new rr;let i=0;for(const a of o){let o=-1;const l=a.map((t=>Math.abs(e[t]-n[t]))),s=a.map((i=>{o=r?r[i]:++o;const a=e[i]-n[i],l=t.has(o)?a-t.get(o):0;return t.set(o,a),l})),c=[0,...or(s)];for(const t of a)n[t]+=i,e[t]+=i;const u=rt(l);u&&(i-=rt(l,((t,n)=>(s[n]/2+c[n])*t))/u)}Vu(o,n,e)}Yu(t,n,e)}function Vu(t,n,e){const r=nt(t,(t=>nt(t,(t=>n[t]))));for(const o of t)for(const t of o)n[t]-=r,e[t]-=r}function Yu(t,n,e){const r=t.length;if(1===r)return;const o=t.map((t=>t.flat())),i=o.map((t=>(nt(t,(t=>n[t]))+X(t,(t=>e[t])))/2)),a=nt(i);for(let t=0;t<r;t++){const r=a-i[t];for(const i of o[t])n[i]+=r,e[i]+=r}}function Zu(t,n,e){return e}function Gu(t,n,e,r){return r}function Ju(t,n,e,r){return tf(r,ir(so(t),(t=>rt(t,(t=>e[t]))),(t=>r[t])))}function Ku(t,n,e,r){return tf(r,ir(so(t),(t=>n[ar(t,(t=>e[t]))]),(t=>r[t])))}function Qu(t,n,e,r){const o=so(t),i=ir(o,(t=>n[ar(t,(t=>e[t]))]),(t=>r[t])),a=ot(o,(t=>rt(t,(t=>e[t]))),(t=>r[t])),l=[],s=[];let c=0;for(const t of i)c<0?(c+=a.get(t),l.push(t)):(c-=a.get(t),s.push(t));return tf(r,s.reverse().concat(l))}function Xu(t){return n=>Tr(n,t)}function tf(t,n){if(!t)throw new Error("missing channel: z");return n=new rr(n.map(((t,n)=>[t,n]))),t.map((t=>n.get(t)))}function nf(t,n){for(const e of t)e.sort(((t,e)=>Zo(n[t],n[e])))}const ef={ariaLabel:"area",strokeWidth:1,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class rf extends xs{constructor(t,n={}){const{x1:e,y1:r,x2:o,y2:i,z:a,curve:l,tension:s}=n;super(t,{x1:{value:e,scale:"x"},y1:{value:r,scale:"y"},x2:{value:o,scale:"x",optional:!0},y2:{value:i,scale:"y",optional:!0},z:{value:lo(n),optional:!0}},n,ef),this.z=a,this.curve=fu(l,s)}filter(t){return t}render(t,n,e,r,o){const{x1:i,y1:a,x2:l=i,y2:s=a}=e;return Ml("svg:g",o).call(Pl,this,r,o).call(Yl,this,n,0,0).call((n=>n.selectAll().data(Il(t,[i,a,l,s],this,e)).enter().append("path").call(Ul,this).call(ql,this,e).attr("d",lr().curve(this.curve).defined((t=>t>=0)).x0((t=>i[t])).y0((t=>a[t])).x1((t=>l[t])).y1((t=>s[t]))))).node()}}function of(t,n){return void 0===n?lf(t,{x:Ir,y:Pr}):new rf(t,n)}function af(t,n){const{y:e=Wr,...r}=xu(n);return new rf(t,Du(Nu({...r,y1:e,y2:void 0})))}function lf(t,n){const{x:e=Wr,...r}=vu(n);return new rf(t,Fu(Su({...r,x1:e,x2:void 0})))}function sf(t,{marker:n,markerStart:e=n,markerMid:r=n,markerEnd:o=n}={}){t.markerStart=cf(e),t.markerMid=cf(r),t.markerEnd=cf(o)}function cf(t){if(null==t||!1===t)return null;if(!0===t)return hf;if("function"==typeof t)return t;switch(`${t}`.toLowerCase()){case"none":return null;case"arrow":return uf;case"dot":return ff;case"circle":case"circle-fill":return hf;case"circle-stroke":return df}throw new Error(`invalid marker: ${t}`)}function uf(t,n){return Ml("svg:marker",n).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("orient","auto").attr("fill","none").attr("stroke",t).attr("stroke-width",1.5).attr("stroke-linecap","round").attr("stroke-linejoin","round").call((t=>t.append("path").attr("d","M-1.5,-3l3,3l-3,3"))).node()}function ff(t,n){return Ml("svg:marker",n).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill",t).attr("stroke","none").call((t=>t.append("circle").attr("r",2.5))).node()}function hf(t,n){return Ml("svg:marker",n).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill",t).attr("stroke","white").attr("stroke-width",1.5).call((t=>t.append("circle").attr("r",3))).node()}function df(t,n){return Ml("svg:marker",n).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill","white").attr("stroke",t).attr("stroke-width",1.5).call((t=>t.append("circle").attr("r",3))).node()}let pf=0;function mf(t,n,{stroke:e}={}){return gf(t,n,e&&(t=>e[t]))}function yf(t,n,{stroke:e}={}){return gf(t,n,e&&(([t])=>e[t]))}function gf(t,{markerStart:n,markerMid:e,markerEnd:r,stroke:o},i=(()=>o)){const a=new Map;function l(t){return function(n){const e=i(n);let r=a.get(t);r||a.set(t,r=new Map);let o=r.get(e);if(!o){const n={document:this.ownerDocument},i=this.parentNode.insertBefore(t(e,n),this),a="plot-marker-"+ ++pf;i.setAttribute("id",a),r.set(e,o=`url(#${a})`)}return o}}n&&t.attr("marker-start",l(n)),e&&t.attr("marker-mid",l(e)),r&&t.attr("marker-end",l(r))}const vf={ariaLabel:"link",fill:"none",stroke:"currentColor",strokeMiterlimit:1};class xf extends xs{constructor(t,n={}){const{x1:e,y1:r,x2:o,y2:i,curve:a,tension:l}=n;super(t,{x1:{value:e,scale:"x"},y1:{value:r,scale:"y"},x2:{value:o,scale:"x",optional:!0},y2:{value:i,scale:"y",optional:!0}},n,vf),this.curve=hu(a,l),sf(this,n)}project(t,n,e){this.curve!==du&&super.project(t,n,e)}render(t,n,e,r,o){const{x1:i,y1:a,x2:l=i,y2:s=a}=e,{curve:c}=this;return Ml("svg:g",o).call(Pl,this,r,o).call(Yl,this,n).call((n=>n.selectAll().data(t).enter().append("path").call(Ul,this).attr("d",c===du&&o.projection?function(t,n,e,r,o){const i=ae(t);return n=sl(n),e=sl(e),r=sl(r),o=sl(o),t=>i({type:"LineString",coordinates:[[n[t],e[t]],[r[t],o[t]]]})}(o.projection,i,a,l,s):t=>{const n=Oe(),e=c(n);return e.lineStart(),e.point(i[t],a[t]),e.point(l[t],s[t]),e.lineEnd(),n}).call(Fl,this,e).call(mf,this,e))).node()}}function wf(t,n={}){let{x:e,x1:r,x2:o,y:i,y1:a,y2:l,...s}=n;return[r,o]=bf(e,r,o),[a,l]=bf(i,a,l),new xf(t,{...s,x1:r,x2:o,y1:a,y2:l})}function bf(t,n,e){if(void 0===t){if(void 0===n){if(void 0!==e)return[e]}else if(void 0===e)return[n]}else{if(void 0===n)return void 0===e?[t]:[t,e];if(void 0===e)return[t,n]}return[n,e]}const kf={ariaLabel:"arrow",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeMiterlimit:1,strokeWidth:1.5};class $f extends xs{constructor(t,n={}){const{x1:e,y1:r,x2:o,y2:i,bend:a=0,headAngle:l=60,headLength:s=8,inset:c=0,insetStart:u=c,insetEnd:f=c}=n;super(t,{x1:{value:e,scale:"x"},y1:{value:r,scale:"y"},x2:{value:o,scale:"x",optional:!0},y2:{value:i,scale:"y",optional:!0}},n,kf),this.bend=!0===a?22.5:Math.max(-90,Math.min(90,a)),this.headAngle=+l,this.headLength=+s,this.insetStart=+u,this.insetEnd=+f}render(t,n,e,r,o){const{x1:i,y1:a,x2:l=i,y2:s=a,SW:c}=e,{strokeWidth:u,bend:f,headAngle:h,headLength:d,insetStart:p,insetEnd:m}=this,y=c?t=>c[t]:Hr(void 0===u?1:u),g=f*bs,v=h*bs/2,x=d/1.5;return Ml("svg:g",o).call(Pl,this,r,o).call(Yl,this,n).call((n=>n.selectAll().data(t).enter().append("path").call(Ul,this).attr("d",(t=>{let n=i[t],e=a[t],r=l[t],o=s[t];const c=Math.hypot(r-n,o-e);if(c<=p+m)return null;let u=Math.atan2(o-e,r-n);const f=Math.min(x*y(t),c/3),h=Math.hypot(c/Math.tan(g),c)/2;if(p||m)if(h<1e5){const t=Math.sign(g),[i,a]=function([t,n],[e,r],o,i){const a=e-t,l=r-n,s=Math.hypot(a,l),c=i*Math.sqrt(o*o-s*s/4)/s;return[(t+e)/2-l*c,(n+r)/2+a*c]}([n,e],[r,o],h,t);if(p&&([n,e]=Mf([i,a,h],[n,e,p],-t*Math.sign(p))),m){const[n,e]=Mf([i,a,h],[r,o,m],t*Math.sign(m));u+=Math.atan2(e-a,n-i)-Math.atan2(o-a,r-i),r=n,o=e}}else{const t=r-n,i=o-e,a=Math.hypot(t,i);p&&(n+=t/a*p,e+=i/a*p),m&&(r-=t/a*m,o-=i/a*m)}const d=u+g,w=d+v,b=d-v,k=r-f*Math.cos(w),$=o-f*Math.sin(w),M=r-f*Math.cos(b),L=o-f*Math.sin(b);return`M${n},${e}${h<1e5?`A${h},${h} 0,0,${g>0?1:0} `:"L"}${r},${o}M${k},${$}L${r},${o}L${M},${L}`})).call(Fl,this,e))).node()}}function Mf([t,n,e],[r,o,i],a){const l=r-t,s=o-n,c=Math.hypot(l,s),u=(l*l+s*s-i*i+e*e)/(2*c),f=a*Math.sqrt(e*e-u*u);return[t+(l*u+s*f)/c,n+(s*u-l*f)/c]}function Lf(t,n={}){let{x:e,x1:r,x2:o,y:i,y1:a,y2:l,...s}=n;return[r,o]=bf(e,r,o),[a,l]=bf(i,a,l),new $f(t,{...s,x1:r,x2:o,y1:a,y2:l})}const Af={ariaLabel:"dot",fill:"none",stroke:"currentColor",strokeWidth:1.5};function Ef(t){return void 0===t.sort&&void 0===t.reverse?ui({channel:"r",order:"descending"},t):t}class zf extends xs{constructor(t,n={}){const{x:e,y:r,r:o,rotate:i,symbol:a=R,frameAnchor:l}=n,[s,c]=Zr(i,0),[u,f]=function(t){if(null==t||Uo(t))return[void 0,t];if("string"==typeof t){const n=Po.get(`${t}`.toLowerCase());if(n)return[void 0,n]}return[t,void 0]}(a),[h,d]=Zr(o,null==u?3:4.5);super(t,{x:{value:e,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},r:{value:h,scale:"r",filter:Qo,optional:!0},rotate:{value:s,optional:!0},symbol:{value:u,scale:"auto",optional:!0}},Ef(n),Af),this.r=d,this.rotate=c,this.symbol=f,this.frameAnchor=So(l);const{channels:p}=this,{symbol:m}=p;if(m){const{fill:t,stroke:n}=p;m.hint={fill:t?t.value===m.value?"color":"currentColor":this.fill,stroke:n?n.value===m.value?"color":"currentColor":this.stroke}}}render(t,n,e,r,o){const{x:i,y:a}=n,{x:l,y:s,r:c,rotate:u,symbol:f}=e,{r:h,rotate:d,symbol:p}=this,[m,y]=Xl(this,r),g=this.symbol===R,v=c?void 0:h*h*Math.PI;return Xo(h)&&(t=[]),Ml("svg:g",o).call(Pl,this,r,o).call(Yl,this,{x:l&&i,y:s&&a}).call((n=>n.selectAll().data(t).enter().append(g?"circle":"path").call(Ul,this).call(g?t=>{t.attr("cx",l?t=>l[t]:m).attr("cy",s?t=>s[t]:y).attr("r",c?t=>c[t]:h)}:t=>{t.attr("transform",qs`translate(${l?t=>l[t]:m},${s?t=>s[t]:y})${u?t=>` rotate(${u[t]})`:d?` rotate(${d})`:""}`).attr("d",c&&f?t=>{const n=Oe();return f[t].draw(n,c[t]*c[t]*Math.PI),n}:c?t=>{const n=Oe();return p.draw(n,c[t]*c[t]*Math.PI),n}:f?t=>{const n=Oe();return f[t].draw(n,v),n}:(()=>{const t=Oe();return p.draw(t,v),t})())}).call(Fl,this,e))).node()}}function Of(t,n={}){let{x:e,y:r,...o}=n;return void 0===n.frameAnchor&&([e,r]=ao(e,r)),new zf(t,{...o,x:e,y:r})}function Nf(t,n={}){const{x:e=Br,...r}=n;return new zf(t,Rs({...r,x:e}))}function Sf(t,n={}){const{y:e=Br,...r}=n;return new zf(t,Cs({...r,y:e}))}function Cf(t,n){return Of(t,{...n,symbol:"circle"})}function Rf(t,n){return Of(t,{...n,symbol:"hexagon"})}const Tf={ariaLabel:"line",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class jf extends xs{constructor(t,n={}){const{x:e,y:r,z:o,curve:i,tension:a}=n;super(t,{x:{value:e,scale:"x"},y:{value:r,scale:"y"},z:{value:lo(n),optional:!0}},n,Tf),this.z=o,this.curve=hu(i,a),sf(this,n)}filter(t){return t}project(t,n,e){this.curve!==du&&super.project(t,n,e)}render(t,n,e,r,o){const{x:i,y:a}=e,{curve:l}=this;return Ml("svg:g",o).call(Pl,this,r,o).call(Yl,this,n).call((n=>n.selectAll().data(Il(t,[i,a],this,e)).enter().append("path").call(Ul,this).call(ql,this,e).call(yf,this,e).attr("d",l===du&&o.projection?function(t,n,e){const r=ae(t);return n=sl(n),e=sl(e),t=>{let o=[];const i=[o];for(const r of t)-1===r?(o=[],i.push(o)):o.push([n[r],e[r]]);return r({type:"MultiLineString",coordinates:i})}}(o.projection,i,a):sr().curve(l).defined((t=>t>=0)).x((t=>i[t])).y((t=>a[t]))))).node()}}function Wf(t,n={}){let{x:e,y:r,...o}=n;return[e,r]=ao(e,r),new jf(t,{...o,x:e,y:r})}function Bf(t,n={}){const{x:e=Br,y:r=Wr,...o}=n;return new jf(t,xu({...o,x:e,y:r}))}function Df(t,n={}){const{x:e=Wr,y:r=Br,...o}=n;return new jf(t,vu({...o,x:e,y:r}))}class Ff extends xs{constructor(t,n,e={},r){super(t,n,e,r);const{inset:o=0,insetTop:i=o,insetRight:a=o,insetBottom:l=o,insetLeft:s=o,rx:c,ry:u}=e;this.insetTop=_r(i),this.insetRight=_r(a),this.insetBottom=_r(l),this.insetLeft=_r(s),this.rx=Zl(c,"auto"),this.ry=Zl(u,"auto")}render(t,n,e,r,o){const{rx:i,ry:a}=this;return Ml("svg:g",o).call(Pl,this,r,o).call(this._transform,this,n).call((o=>o.selectAll().data(t).enter().append("rect").call(Ul,this).attr("x",this._x(n,e,r)).attr("width",this._width(n,e,r)).attr("y",this._y(n,e,r)).attr("height",this._height(n,e,r)).call(Vl,"rx",i).call(Vl,"ry",a).call(Fl,this,e))).node()}_x(t,{x:n},{marginLeft:e}){const{insetLeft:r}=this;return n?t=>n[t]+r:e+r}_y(t,{y:n},{marginTop:e}){const{insetTop:r}=this;return n?t=>n[t]+r:e+r}_width({x:t},{x:n},{marginRight:e,marginLeft:r,width:o}){const{insetLeft:i,insetRight:a}=this,l=n&&t?t.bandwidth():o-e-r;return Math.max(0,l-i-a)}_height({y:t},{y:n},{marginTop:e,marginBottom:r,height:o}){const{insetTop:i,insetBottom:a}=this,l=n&&t?t.bandwidth():o-e-r;return Math.max(0,l-i-a)}}const qf={ariaLabel:"bar"};class _f extends Ff{constructor(t,n={}){const{x1:e,x2:r,y:o}=n;super(t,{x1:{value:e,scale:"x"},x2:{value:r,scale:"x"},y:{value:o,scale:"y",type:"band",optional:!0}},n,qf)}_transform(t,n,{x:e}){t.call(Yl,n,{x:e},0,0)}_x({x:t},{x1:n,x2:e},{marginLeft:r}){const{insetLeft:o}=this;return ol(t)?r+o:t=>Math.min(n[t],e[t])+o}_width({x:t},{x1:n,x2:e},{marginRight:r,marginLeft:o,width:i}){const{insetLeft:a,insetRight:l}=this;return ol(t)?i-r-o-a-l:t=>Math.max(0,Math.abs(e[t]-n[t])-a-l)}}class If extends Ff{constructor(t,n={}){const{x:e,y1:r,y2:o}=n;super(t,{y1:{value:r,scale:"y"},y2:{value:o,scale:"y"},x:{value:e,scale:"x",type:"band",optional:!0}},n,qf)}_transform(t,n,{y:e}){t.call(Yl,n,{y:e},0,0)}_y({y:t},{y1:n,y2:e},{marginTop:r}){const{insetTop:o}=this;return ol(t)?r+o:t=>Math.min(n[t],e[t])+o}_height({y:t},{y1:n,y2:e},{marginTop:r,marginBottom:o,height:i}){const{insetTop:a,insetBottom:l}=this;return ol(t)?i-r-o-a-l:t=>Math.max(0,Math.abs(e[t]-n[t])-a-l)}}function Pf(t,n={y:Wr,x2:Br}){return new _f(t,Du(Ns(Nu(n))))}function Uf(t,n={x:Wr,y2:Br}){return new If(t,Fu(Ss(Su(n))))}const Hf={ariaLabel:"rect"};class Vf extends xs{constructor(t,n={}){const{x1:e,y1:r,x2:o,y2:i,inset:a=0,insetTop:l=a,insetRight:s=a,insetBottom:c=a,insetLeft:u=a,rx:f,ry:h}=n;super(t,{x1:{value:e,scale:"x",optional:!0},y1:{value:r,scale:"y",optional:!0},x2:{value:o,scale:"x",optional:!0},y2:{value:i,scale:"y",optional:!0}},n,Hf),this.insetTop=_r(l),this.insetRight=_r(s),this.insetBottom=_r(c),this.insetLeft=_r(u),this.rx=Zl(f,"auto"),this.ry=Zl(h,"auto")}render(t,n,e,r,o){const{x:i,y:a}=n,{x1:l,y1:s,x2:c,y2:u}=e,{marginTop:f,marginRight:h,marginBottom:d,marginLeft:p,width:m,height:y}=r,{projection:g}=o,{insetTop:v,insetRight:x,insetBottom:w,insetLeft:b,rx:k,ry:$}=this;return Ml("svg:g",o).call(Pl,this,r,o).call(Yl,this,{x:l&&c&&i,y:s&&u&&a},0,0).call((n=>n.selectAll().data(t).enter().append("rect").call(Ul,this).attr("x",l&&c&&(g||!ol(i))?t=>Math.min(l[t],c[t])+b:p+b).attr("y",s&&u&&(g||!ol(a))?t=>Math.min(s[t],u[t])+v:f+v).attr("width",l&&c&&(g||!ol(i))?t=>Math.max(0,Math.abs(c[t]-l[t])-b-x):m-h-p-x-b).attr("height",s&&u&&(g||!ol(a))?t=>Math.max(0,Math.abs(s[t]-u[t])-v-w):y-f-d-v-w).call(Vl,"rx",k).call(Vl,"ry",$).call(Fl,this,e))).node()}}function Yf(t,n){return new Vf(t,zs(Os(n)))}function Zf(t,n={y:Wr,interval:1,x2:Br}){return new Vf(t,Du(Os(Nu(n))))}function Gf(t,n={x:Wr,interval:1,y2:Br}){return new Vf(t,Fu(zs(Su(n))))}const Jf={ariaLabel:"cell"};class Kf extends Ff{constructor(t,{x:n,y:e,...r}={}){super(t,{x:{value:n,scale:"x",type:"band",optional:!0},y:{value:e,scale:"y",type:"band",optional:!0}},r,Jf)}_transform(t,n){t.call(Yl,n,{},0,0)}}function Qf(t,n={}){let{x:e,y:r,...o}=n;return[e,r]=ao(e,r),new Kf(t,{...o,x:e,y:r})}function Xf(t,n={}){let{x:e=Wr,fill:r,stroke:o,...i}=n;return void 0===r&&void 0===Yr(o)[0]&&(r=Br),new Kf(t,{...i,x:e,fill:r,stroke:o})}function th(t,n={}){let{y:e=Wr,fill:r,stroke:o,...i}=n;return void 0===r&&void 0===Yr(o)[0]&&(r=Br),new Kf(t,{...i,y:e,fill:r,stroke:o})}function nh(t,n){n=oh(n);let{fx:e,fy:r,x:{value:o,reduce:i,zero:a,...l},y:{value:s,reduce:c,zero:u,...f},color:{value:h,color:d,reduce:p},size:{value:m,reduce:y},mark:g}=n;const{x:v,y:x}=n;let w,b;if(void 0===i&&(i=null==c&&null==o&&null==m&&null!=s?"count":null),void 0===c&&(c=null==i&&null==s&&null==m&&null!=o?"count":null),void 0!==y||null!=m||null!=p||null!=i||null!=c||null!=o&&!ko(w??=ih(t,v))||null!=s&&!ko(b??=ih(t,x))||(y="count"),void 0===a&&(a=!!lh(i)||void 0),void 0===u&&(u=!!lh(c)||void 0),null==o&&null==s)throw new Error("must specify x or y");if(null!=i&&null==s)throw new Error("reducing x requires y");if(null!=c&&null==o)throw new Error("reducing y requires x");return void 0===g&&(g=null!=m||null!=y?"dot":a||u||null!=p?"bar":null!=o&&null!=s?ko(w??=ih(t,v))||ko(b??=ih(t,x))||null==i&&null==c&&!rh(w)&&!rh(b)?"dot":"line":null!=o||null!=s?"rule":null),{fx:e??null,fy:r??null,x:{value:o??null,reduce:i??null,...void 0!==a&&{zero:a},...l},y:{value:s??null,reduce:c??null,...void 0!==u&&{zero:u},...f},color:{value:h??null,reduce:p??null,...void 0!==d&&{color:d}},size:{value:m??null,reduce:y??null},mark:g}}function eh(t,n){n=oh(n);const{x:e,y:r,color:o,size:i}=n,a=ih(t,e),l=ih(t,r),s=ih(t,o),c=ih(t,i);let u,f,{fx:h,fy:d,x:{reduce:p,zero:m,...y},y:{reduce:g,zero:v,...x},color:{color:w,reduce:b},size:{reduce:k},mark:$}=nh(t,{...n,x:{...e,value:a},y:{...r,value:l},color:{...o,value:s},size:{...i,value:c}});if(null!=$)switch(`${$}`.toLowerCase()){case"dot":$=Of,f="stroke";break;case"line":$=a&&l?Wf:a?Bf:Df,f="stroke",ch(s)&&(u=null);break;case"area":$=v?lf:m||l&&rh(l)?af:lf,f="fill",ch(s)&&(u=null);break;case"rule":$=a?Bs:Ds,f="stroke";break;case"bar":$=v?sh(p,a)?Uf:Gf:m?sh(g,l)?Pf:Zf:sh(p,a)&&sh(g,l)?Qf:sh(p,a)?Uf:sh(g,l)?Pf:Yf,f="fill";break;default:throw new Error(`invalid mark: ${$}`)}let M,L={fx:h,fy:d,x:a??void 0,y:l??void 0,[f]:s??w,z:u,r:c??void 0},A={[f]:b??void 0,r:k??void 0};if(null!=p&&null!=g)throw new Error("cannot reduce both x and y");null!=g?(A.y=g,M=ko(a)?mi:pu):null!=p?(A.x=p,M=ko(l)?yi:mu):null==b&&null==k||(a&&l?M=ko(a)&&ko(l)?gi:ko(a)?mu:ko(l)?pu:yu:a?M=ko(a)?mi:pu:l&&(M=ko(l)?yi:mu)),M&&(M!==yu&&M!==pu||(L.x={value:a,...y}),M!==yu&&M!==mu||(L.y={value:l,...x}),L=M(A,L)),void 0===m&&(m=M!==pu&&($===Pf||$===af||$===Zf)),void 0===v&&(v=M!==mu&&($===Uf||$===lf||$===Gf));const E=null!=h||null!=d?Zc({strokeOpacity:.1}):null,z=[m?Bs([0]):null,v?Ds([0]):null];return $=$(t,L),"stroke"===f?ws(E,z,$):ws(E,$,z)}function rh(t){let n,e;for(const r of t){if(null==r)continue;if(void 0===n){n=r;continue}const t=Math.sign(H(n,r));if(t){if(void 0!==e&&t!==e)return!1;n=r,e=t}}return!0}function oh({x:t,y:n,color:e,size:r,fx:o,fy:i,mark:a}={}){return ro(t)||(t=ah(t)),ro(n)||(n=ah(n)),ro(e)||(e=zo(e)?{color:e}:ah(e)),ro(r)||(r=ah(r)),ro(o)&&({value:o}=ah(o)),ro(i)&&({value:i}=ah(i)),{x:t,y:n,color:e,size:r,fx:o,fy:i,mark:a}}function ih(t,n){const e=Tr(t,n.value);return e&&(e.label=mo(n.value)),e}function ah(t){return function(t){if("function"==typeof t?.reduce&&no(t))return!0;if(/^p\d{2}$/i.test(t))return!0;switch(`${t}`.toLowerCase()){case"first":case"last":case"count":case"distinct":case"sum":case"proportion":case"proportion-facet":case"deviation":case"min":case"min-index":case"max":case"max-index":case"mean":case"median":case"variance":case"mode":return!0}return!1}(t)?{reduce:t}:{value:t}}function lh(t){return/^(?:distinct|count|sum|proportion)$/i.test(t)}function sh(t,n){return!(null!=t&&!function(t){return/^(?:first|last|mode)$/i.test(t)}(t)||!n)&&ko(n)}function ch(t){return!!t&&new it(t).size>t.length>>1}function uh(t,n={}){return dh(Object.fromEntries(["x","x1","x2"].filter((t=>null!=n[t])).map((n=>[n,t]))),n)}function fh(t,n={}){return dh(Object.fromEntries(["y","y1","y2"].filter((t=>null!=n[t])).map((n=>[n,t]))),n)}function hh(t={},n={}){const e=lo(n),r=Object.entries(t).map((([t,e])=>{const r=fo(t,n);if(null==r)throw new Error(`missing channel: ${t}`);const[o,i]=ho(r);return{key:t,input:r,output:o,setOutput:i,map:ph(e)}}));return{...ti(n,((t,n)=>{const o=Tr(t,e),i=r.map((({input:n})=>Tr(t,n))),a=r.map((({setOutput:n})=>n(new Array(t.length))));for(const t of n)for(const n of o?Z(t,(t=>o[t])).values():[t])r.forEach((({map:t},e)=>t.map(n,i[e],a[e])));return{data:t,facets:n}})),...Object.fromEntries(r.map((({key:t,output:n})=>[t,n])))}}const dh=hh;function ph(t){if(t&&"function"==typeof t.map)return t;if("function"==typeof t)return yh(t);switch(`${t}`.toLowerCase()){case"cumsum":return gh;case"rank":return yh(cr);case"quantile":return yh(mh)}throw new Error(`invalid map: ${t}`)}function mh(t){const n=ur(t)-1;return cr(t).map((t=>t/n))}function yh(t){return{map(n,e,r){const o=t(co(e,n));if(o.length!==n.length)throw new Error("map function returned a mismatched length");for(let t=0,e=n.length;t<e;++t)r[n[t]]=o[t]}}}const gh={map(t,n,e){let r=0;for(const o of t)e[o]=r+=n[o]}},vh={ariaLabel:"tick",fill:null,stroke:"currentColor"};class xh extends xs{constructor(t,n,e){super(t,n,e,vh)}render(t,n,e,r,o){return Ml("svg:g",o).call(Pl,this,r,o).call(this._transform,this,n).call((o=>o.selectAll().data(t).enter().append("line").call(Ul,this).attr("x1",this._x1(n,e,r)).attr("x2",this._x2(n,e,r)).attr("y1",this._y1(n,e,r)).attr("y2",this._y2(n,e,r)).call(Fl,this,e))).node()}}class wh extends xh{constructor(t,n={}){const{x:e,y:r,inset:o=0,insetTop:i=o,insetBottom:a=o}=n;super(t,{x:{value:e,scale:"x"},y:{value:r,scale:"y",type:"band",optional:!0}},n),this.insetTop=_r(i),this.insetBottom=_r(a)}_transform(t,n,{x:e}){t.call(Yl,n,{x:e},Rl,0)}_x1(t,{x:n}){return t=>n[t]}_x2(t,{x:n}){return t=>n[t]}_y1({y:t},{y:n},{marginTop:e}){const{insetTop:r}=this;return n&&t?t=>n[t]+r:e+r}_y2({y:t},{y:n},{height:e,marginBottom:r}){const{insetBottom:o}=this;return n&&t?e=>n[e]+t.bandwidth()-o:e-r-o}}class bh extends xh{constructor(t,n={}){const{x:e,y:r,inset:o=0,insetRight:i=o,insetLeft:a=o}=n;super(t,{y:{value:r,scale:"y"},x:{value:e,scale:"x",type:"band",optional:!0}},n),this.insetRight=_r(i),this.insetLeft=_r(a)}_transform(t,n,{y:e}){t.call(Yl,n,{y:e},0,Rl)}_x1({x:t},{x:n},{marginLeft:e}){const{insetLeft:r}=this;return n&&t?t=>n[t]+r:e+r}_x2({x:t},{x:n},{width:e,marginRight:r}){const{insetRight:o}=this;return n&&t?e=>n[e]+t.bandwidth()-o:e-r-o}_y1(t,{y:n}){return t=>n[t]}_y2(t,{y:n}){return t=>n[t]}}function kh(t,n={}){const{x:e=Br,...r}=n;return new wh(t,{...r,x:e})}function $h(t,n={}){const{y:e=Br,...r}=n;return new bh(t,{...r,y:e})}function Mh(t,n={}){const{x:e={transform:t=>t},y:r=null,fill:o="#ccc",fillOpacity:i,stroke:a="currentColor",strokeOpacity:l,strokeWidth:s=2,sort:c,...u}=n,f=null!=r?yi:pi;return ws(Ds(t,f({x1:Eh,x2:zh},{x:e,y:r,stroke:a,strokeOpacity:l,...u})),Pf(t,f({x1:"p25",x2:"p75"},{x:e,y:r,fill:o,fillOpacity:i,...u})),kh(t,f({x:"p50"},{x:e,y:r,stroke:a,strokeOpacity:l,strokeWidth:s,sort:c,...u})),Of(t,hh({x:Ah},{x:e,y:r,z:r,stroke:a,strokeOpacity:l,...u})))}function Lh(t,n={}){const{y:e={transform:t=>t},x:r=null,fill:o="#ccc",fillOpacity:i,stroke:a="currentColor",strokeOpacity:l,strokeWidth:s=2,sort:c,...u}=n,f=null!=r?mi:pi;return ws(Bs(t,f({y1:Eh,y2:zh},{x:r,y:e,stroke:a,strokeOpacity:l,...u})),Uf(t,f({y1:"p25",y2:"p75"},{x:r,y:e,fill:o,fillOpacity:i,...u})),$h(t,f({y:"p50"},{x:r,y:e,stroke:a,strokeOpacity:l,strokeWidth:s,sort:c,...u})),Of(t,hh({y:Ah},{x:r,y:e,z:r,stroke:a,strokeOpacity:l,...u})))}function Ah(t){const n=Eh(t),e=zh(t);return t.map((t=>t<n||t>e?t:NaN))}function Eh(t,n){const e=2.5*Oh(t,n)-1.5*Nh(t,n);return nt(t,(t=>t>=e?t:NaN))}function zh(t,n){const e=2.5*Nh(t,n)-1.5*Oh(t,n);return X(t,(t=>t<=e?t:NaN))}function Oh(t,n){return z(t,.25,n)}function Nh(t,n){return z(t,.75,n)}const Sh={ariaLabel:"raster",stroke:null,pixelSize:1};function Ch(t,n){const e=+t;if(isNaN(e))throw new Error(`invalid ${n}: ${t}`);return e}function Rh(t,n){const e=Math.floor(t);if(isNaN(e))throw new Error(`invalid ${n}: ${t}`);return e}class Th extends xs{constructor(t,n,e={},r){let{width:o,height:i,x:a,y:l,x1:s=(null==a?0:void 0),y1:c=(null==l?0:void 0),x2:u=(null==a?o:void 0),y2:f=(null==l?i:void 0),pixelSize:h=r.pixelSize,blur:d=0,interpolate:p}=e;if(null!=o&&(o=Rh(o,"width")),null!=i&&(i=Rh(i,"height")),null!=s&&(s=Ch(s,"x1")),null!=c&&(c=Ch(c,"y1")),null!=u&&(u=Ch(u,"x2")),null!=f&&(f=Ch(f,"y2")),null==a&&(null==s||null==u))throw new Error("missing x");if(null==l&&(null==c||null==f))throw new Error("missing y");null!=t&&null!=o&&null!=i&&(void 0===a&&null!=s&&null!=u&&(a=function(t,n,e){return{transform(r){const o=r.length,i=new Float64Array(o),a=(n-t)/e,l=t+a/2;for(let t=0;t<o;++t)i[t]=t%e*a+l;return i}}}(s,u,o)),void 0===l&&null!=c&&null!=f&&(l=function(t,n,e,r){return{transform(o){const i=o.length,a=new Float64Array(i),l=(n-t)/r,s=t+l/2;for(let t=0;t<i;++t)a[t]=Math.floor(t/e)%r*l+s;return a}}}(c,f,o,i))),super(t,{x:{value:a,scale:"x",optional:!0},y:{value:l,scale:"y",optional:!0},x1:{value:null==s?null:[s],scale:"x",optional:!0,filter:null},y1:{value:null==c?null:[c],scale:"y",optional:!0,filter:null},x2:{value:null==u?null:[u],scale:"x",optional:!0,filter:null},y2:{value:null==f?null:[f],scale:"y",optional:!0,filter:null},...n},e,r),this.width=o,this.height=i,this.pixelSize=Ch(h,"pixelSize"),this.blur=Ch(d,"blur"),this.interpolate=null==a||null==l?null:function(t){if("function"==typeof t)return t;if(null==t)return _h;switch(`${t}`.toLowerCase()){case"none":return _h;case"nearest":return Ph;case"barycentric":return Ih();case"random-walk":return Uh()}throw new Error(`invalid interpolate: ${t}`)}(p)}}class jh extends Th{constructor(t,n={}){const{imageRendering:e}=n;if(null==t){const{fill:t,fillOpacity:e}=n;void 0!==Zr(e)[0]&&(n=qh("fillOpacity",n)),void 0!==Yr(t)[0]&&(n=qh("fill",n))}super(t,void 0,n,Sh),this.imageRendering=Zl(e,"auto")}scale(t,{color:n,...e},r){return super.scale(t,e,r)}render(t,n,e,r,o){const i=n.color??(t=>t),{x:a,y:l}=e,{document:s}=o,[c,u,f,h]=Dh(e,r,o),d=f-c,p=h-u,{pixelSize:m,width:y=Math.round(Math.abs(d)/m),height:g=Math.round(Math.abs(p)/m)}=this,v=y*g;let{fill:x,fillOpacity:w}=e,b=0;if(this.interpolate){const n=y/d,e=g/p,r=Qr(a,(t=>(t-c)*n),Float64Array),o=Qr(l,(t=>(t-u)*e),Float64Array);x&&(x=this.interpolate(t,y,g,r,o,x)),w&&(w=this.interpolate(t,y,g,r,o,w))}else null==this.data&&t&&(b=t.fi*v);const k=s.createElement("canvas");k.width=y,k.height=g;const $=k.getContext("2d"),M=$.createImageData(y,g),L=M.data;let{r:A,g:E,b:z}=Ne(this.fill)??{r:0,g:0,b:0},O=255*(this.fillOpacity??1);for(let t=0;t<v;++t){const n=t<<2;if(x){const e=i(x[t+b]);if(null==e){L[n+3]=0;continue}({r:A,g:E,b:z}=Ne(e))}w&&(O=255*w[t+b]),L[n+0]=A,L[n+1]=E,L[n+2]=z,L[n+3]=O}return this.blur>0&&fr(M,this.blur),$.putImageData(M,0,0),Ml("svg:g",o).call(Pl,this,r,o).call(Yl,this,n).call((t=>t.append("image").attr("transform",`translate(${c},${u}) scale(${Math.sign(f-c)},${Math.sign(h-u)})`).attr("width",Math.abs(d)).attr("height",Math.abs(p)).attr("preserveAspectRatio","none").call(Vl,"image-rendering",this.imageRendering).call(Ul,this).attr("xlink:href",k.toDataURL()))).node()}}function Wh(t,n,e){arguments.length<3&&(e=n,n=null);let{x:r,y:o,[t]:i,...a}=e;return void 0===r&&void 0===o&&xo(n)&&(r=Ir,o=Pr,void 0===i&&(i=Ur)),[n,{...a,x:r,y:o,[t]:i}]}function Bh(){const[t,n]=Wh("fill",...arguments);return new jh(t,null==t||void 0!==n.fill||void 0!==n.fillOpacity?n:{...n,fill:Br})}function Dh({x1:t,y1:n,x2:e,y2:r},o,{projection:i}){const{width:a,height:l,marginTop:s,marginRight:c,marginBottom:u,marginLeft:f}=o;return[t&&null==i?t[0]:f,n&&null==i?n[0]:s,e&&null==i?e[0]:a-c,r&&null==i?r[0]:l-u]}function Fh({x1:t,y1:n,x2:e,y2:r},o,i,a){const l={};return t&&(l.x1=t),n&&(l.y1=n),e&&(l.x2=e),r&&(l.y2=r),Dh(Vi(l,o),i,a)}function qh(t,n={}){const{[t]:e}=n;if("function"!=typeof e)throw new Error(`invalid ${t}: not a function`);return ni({...n,[t]:void 0},(function(r,o,i,a,l,s){const{x:c,y:u}=a;if(!c)throw new Error("missing scale: x");if(!u)throw new Error("missing scale: y");const[f,h,d,p]=Fh(i,a,l,s),m=d-f,y=p-h,{pixelSize:g}=this,{width:v=Math.round(Math.abs(m)/g),height:x=Math.round(Math.abs(y)/g)}=n,w=new Array(v*x*(o?o.length:1)),b=m/v,k=y/x;let $=0;for(const t of o??[void 0])for(let n=.5;n<x;++n)for(let r=.5;r<v;++r,++$)w[$]=e(c.invert(f+r*b),u.invert(h+n*k),t);return{data:w,facets:o,channels:{[t]:{value:w,scale:!0}}}}))}function _h(t,n,e,r,o,i){const a=new Array(n*e);for(const l of t)r[l]<0||r[l]>=n||o[l]<0||o[l]>=e||(a[Math.floor(o[l])*n+Math.floor(r[l])]=i[l]);return a}function Ih({random:t=V(42)}={}){return(n,e,r,o,i,a)=>{const l=n.length,s=e>>2,c=(r>>2)-1,u=l+2*s+2*c,f=new Float64Array(2*u);for(let t=0;t<l;++t)f[2*t]=o[n[t]],f[2*t+1]=i[n[t]];let h=l;const d=(t,n)=>(f[2*h]=t,f[2*h+1]=n,h++);for(let t=0;t<=s;++t)d(t/s*e,0),d(t/s*e,r);for(let t=0;t<c;++t)d(e,t/c*r),d(0,t/c*r);a=co(a,n);const p=new hr(f.subarray(0,2*l));for(let t,n=l;n<u;++n)a[n]=a[t=p.find(f[2*n],f[2*n+1],t)];const{points:m,triangles:y}=new hr(f),g=new a.constructor(e*r),v=function(t,n){return Ao(t)||$o(t)?Hh:function(t){return(n,e,r,o,i,a,l,s)=>{const c=t(l,s);return c<e?n:c<e+o?r:i}}(n)}(a,t);for(let t=0;t<y.length;t+=3){const n=y[t],o=y[t+1],i=y[t+2],l=m[2*n],s=m[2*o],c=m[2*i],u=m[2*n+1],f=m[2*o+1],h=m[2*i+1],d=Math.min(l,s,c),p=Math.max(l,s,c),x=Math.min(u,f,h),w=Math.max(u,f,h),b=(f-h)*(l-c)+(u-h)*(c-s);if(!b)continue;const k=a[n],$=a[o],M=a[i];for(let t=Math.floor(d);t<p;++t)for(let n=Math.floor(x);n<w;++n){if(t<0||t>=e||n<0||n>=r)continue;const o=t+.5,i=n+.5,a=((f-h)*(o-c)+(i-h)*(c-s))/b;if(a<0)continue;const d=((h-u)*(o-c)+(i-h)*(l-c))/b;if(d<0)continue;const p=1-a-d;p<0||(g[t+e*n]=v(k,a,$,d,M,p,t,n))}}return g}}function Ph(t,n,e,r,o,i){const a=new i.constructor(n*e),l=hr.from(t,(t=>r[t]),(t=>o[t]));let s,c;for(let r=.5,o=0;r<e;++r){c=s;for(let e=.5;e<n;++e,++o)c=l.find(e,r,c),.5===e&&(s=c),a[o]=i[t[c]]}return a}function Uh({random:t=V(42),minDistance:n=.5,maxSteps:e=2}={}){return(r,o,i,a,l,s)=>{const c=new s.constructor(o*i),u=hr.from(r,(t=>a[t]),(t=>l[t]));let f,h,d;for(let p=.5,m=0;p<i;++p){h=f;for(let i=.5;i<o;++i,++m){let o,y=i,g=p;d=h=u.find(y,g,h),.5===i&&(f=h);let v=0;for(;(o=Math.hypot(a[r[d]]-y,l[r[d]]-g))>n&&v<e;){const n=2*t(i,p,v)*Math.PI;y+=Math.cos(n)*o,g+=Math.sin(n)*o,d=u.find(y,g,d),++v}c[m]=s[r[d]]}}return c}}function Hh(t,n,e,r,o,i){return n*t+r*e+i*o}const Vh={ariaLabel:"contour",fill:"none",stroke:"currentColor",strokeMiterlimit:1,pixelSize:2};class Yh extends Th{constructor(t,{smooth:n=!0,value:e,...r}={}){const o=Wl({},r,Vh);if(void 0===e)for(const t in o)if(null!=o[t].value){if(void 0!==e)throw new Error("ambiguous contour value");e=r[t],r[t]="value"}if(null!=e){const t={transform:t=>t.map((t=>t.value)),label:mo(e)};for(const n in o)"value"===r[n]&&(r[n]=t)}if(null==t){if(null==e)throw new Error("missing contour value");r=qh("value",{value:e,...r}),e=null}else{let{interpolate:t}=r;void 0===e&&(e=Br),void 0===t&&(r.interpolate="nearest")}super(t,{value:{value:e,optional:!0}},function({thresholds:t,interval:n,...e}){return t=Mu(t,n,Ke),ni(e,(function(n,e,r,o,i,a){const[l,s,c,u]=Fh(r,o,i,a),f=c-l,h=u-s,{pixelSize:d,width:p=Math.round(Math.abs(f)/d),height:m=Math.round(Math.abs(h)/d)}=this,y=p/f,g=m/h,v=r.value.value,x=[];if(this.interpolate){const{x:t,y:n}=kl(r,o,a),i=dr(t,(t=>(t-l)*y),Float64Array),c=dr(n,(t=>(t-s)*g),Float64Array),u=[r.x,r.y,r.value],f=[i,c,v];for(const t of e){const n=this.filter(t,u,f);x.push(this.interpolate(n,p,m,i,c,v))}}else if(e){const t=p*m,n=e.length;for(let e=0;e<n;++e)x.push(v.slice(e*t,e*t+t))}else x.push(v);if(this.blur>0)for(const t of x)pr({data:t,width:p,height:m},this.blur);const w=function(t,n,e,r){if("function"==typeof t?.range)return t.range(t.floor(e),r);"function"==typeof t&&(t=t(n,e,r));if("number"!=typeof t)return Kr(t,Array);const o=In(...yr(e,r,t),t);for(;o[o.length-1]>=r;)o.pop();for(;o[1]<e;)o.shift();return o}(t,v,...function(t){return[nt(t,(t=>nt(t,Gh))),X(t,(t=>X(t,Gh)))]}(x));if(null===w)throw new Error(`unsupported thresholds: ${t}`);const{contour:b}=mr().size([p,m]).smooth(this.smooth),k=[],$=[];for(const t of x)$.push(O(k.length,k.push(...w.map((n=>b(t,n))))));for(const{coordinates:t}of k)for(const n of t)for(const t of n)for(const n of t)n[0]=n[0]/y+l,n[1]=n[1]/g+s;return{data:k,facets:$,channels:Hi(this.contourChannels,k)}}))}(r),Vh);const i={geometry:{value:Br}};for(const t in this.channels){const n=this.channels[t],{scale:e}=n;"x"!==e&&"y"!==e&&"value"!==t&&(i[t]=n,delete this.channels[t])}this.contourChannels=i,this.smooth=!!n}filter(t,{x:n,y:e,value:r,...o},i){return super.filter(t,o,i)}render(t,n,e,r,o){const{geometry:i}=e,a=ae();return Ml("svg:g",o).call(Pl,this,r,o).call(Yl,this,n).call((n=>{n.selectAll().data(t).enter().append("path").call(Ul,this).attr("d",(t=>a(i[t]))).call(Fl,this,e)})).node()}}function Zh(){return new Yh(...Wh("value",...arguments))}function Gh(t){return isFinite(t)?t:NaN}const Jh={ariaLabel:"delaunay link",fill:"none",stroke:"currentColor",strokeMiterlimit:1},Kh={ariaLabel:"delaunay mesh",fill:null,stroke:"currentColor",strokeOpacity:.2},Qh={ariaLabel:"hull",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeMiterlimit:1},Xh={ariaLabel:"voronoi",fill:"none",stroke:"currentColor",strokeMiterlimit:1},td={ariaLabel:"voronoi mesh",fill:null,stroke:"currentColor",strokeOpacity:.2};class nd extends xs{constructor(t,n={}){const{x:e,y:r,z:o,curve:i,tension:a}=n;super(t,{x:{value:e,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},z:{value:o,optional:!0}},n,Jh),this.curve=fu(i,a),sf(this,n)}render(t,n,e,r,o){const{x:i,y:a}=n,{x:l,y:s,z:c}=e,{curve:u}=this,[f,h]=Xl(this,r),d=l?t=>l[t]:Hr(f),p=s?t=>s[t]:Hr(h),m=this;function y(t){let n=-1;const r=[],o={};for(const t in e)o[t]=[];const i=[],a=[],l=[],s=[];function c(c,u){c=t[c],u=t[u],r.push(++n),i[n]=d(c),l[n]=p(c),a[n]=d(u),s[n]=p(u);for(const t in e)o[t].push(e[t][u])}const{halfedges:f,hull:h,triangles:y}=hr.from(t,d,p);for(let t=0;t<f.length;++t){const n=f[t];n>t&&c(y[t],y[n])}for(let t=0;t<h.length;++t)c(h[t],h[(t+1)%h.length]);ke(this).selectAll().data(r).join("path").call(Ul,m).attr("d",(t=>{const n=Oe(),e=u(n);return e.lineStart(),e.point(i[t],l[t]),e.point(a[t],s[t]),e.lineEnd(),n})).call(Fl,m,o).call(mf,m,o)}return Ml("svg:g",o).call(Pl,this,r,o).call(Yl,this,{x:l&&i,y:s&&a}).call(c?n=>n.selectAll().data(Z(t,(t=>c[t])).values()).enter().append("g").each(y):n=>n.datum(t).each(y)).node()}}class ed extends xs{constructor(t,n={},e,r=(({z:t})=>t)){const{x:o,y:i}=n;super(t,{x:{value:o,scale:"x",optional:!0},y:{value:i,scale:"y",optional:!0},z:{value:r(n),optional:!0}},n,e)}render(t,n,e,r,o){const{x:i,y:a}=n,{x:l,y:s,z:c}=e,[u,f]=Xl(this,r),h=l?t=>l[t]:Hr(u),d=s?t=>s[t]:Hr(f),p=this;function m(t){const n=hr.from(t,h,d);ke(this).append("path").datum(t[0]).call(Ul,p).attr("d",p._render(n,r)).call(Fl,p,e)}return Ml("svg:g",o).call(Pl,this,r,o).call(Yl,this,{x:l&&i,y:s&&a}).call(c?n=>n.selectAll().data(Z(t,(t=>c[t])).values()).enter().append("g").each(m):n=>n.datum(t).each(m)).node()}}class rd extends ed{constructor(t,n={}){super(t,n,Kh),this.fill="none"}_render(t){return t.render()}}class od extends ed{constructor(t,n={}){super(t,n,Qh,lo)}_render(t){return t.renderHull()}}class id extends xs{constructor(t,n={}){const{x:e,y:r,z:o}=n;super(t,{x:{value:e,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},z:{value:o,optional:!0}},n,Xh)}render(t,n,e,r,o){const{x:i,y:a}=n,{x:l,y:s,z:c}=e,[u,f]=Xl(this,r),h=l?t=>l[t]:Hr(u),d=s?t=>s[t]:Hr(f),p=this;function m(t){const n=ld(hr.from(t,h,d),r);ke(this).selectAll().data(t).enter().append("path").call(Ul,p).attr("d",((t,e)=>n.renderCell(e))).call(Fl,p,e)}return Ml("svg:g",o).call(Pl,this,r,o).call(Yl,this,{x:l&&i,y:s&&a}).call(c?n=>n.selectAll().data(Z(t,(t=>c[t])).values()).enter().append("g").each(m):n=>n.datum(t).each(m)).node()}}class ad extends ed{constructor(t,n){super(t,n,td),this.fill="none"}_render(t,n){return ld(t,n).render()}}function ld(t,n){const{width:e,height:r,marginTop:o,marginRight:i,marginBottom:a,marginLeft:l}=n;return t.voronoi([l,o,e-i,r-a])}function sd(t,n,{x:e,y:r,...o}={}){return[e,r]=ao(e,r),new t(n,{...o,x:e,y:r})}function cd(t,n){return sd(nd,t,n)}function ud(t,n){return sd(rd,t,n)}function fd(t,n){return sd(od,t,n)}function hd(t,n){return sd(id,t,n)}function dd(t,n){return sd(ad,t,n)}const pd={ariaLabel:"density",fill:"none",stroke:"currentColor",strokeMiterlimit:1};class md extends xs{constructor(t,{x:n,y:e,z:r,weight:o,fill:i,stroke:a,...l}={}){const s=vd(i)&&(i="currentColor",!0),c=vd(a)&&(a="currentColor",!0);super(t,{x:{value:n,scale:"x",optional:!0},y:{value:e,scale:"y",optional:!0},z:{value:lo({z:r,fill:i,stroke:a}),optional:!0},weight:{value:o,optional:!0}},function(t,n,e){const r=100;let{bandwidth:o,thresholds:i}=t;return o=void 0===o?20:+o,i=void 0===i?20:"function"==typeof i?.[Symbol.iterator]?sl(i):+i,ni(t,(function(t,a,l,s,c,u){const f=l.weight?sl(l.weight.value):null,h=l.z?.value,{z:d}=this,[p,m]=Xl(this,c),{width:y,height:g}=c,{x:v,y:x}=kl(l,s,u),w=Object.fromEntries(Object.entries(l).filter((([t])=>!gd.has(t))).map((([t,n])=>[t,{...n,value:[]}]))),b=n&&[],k=e&&[],$=vr().x(v?t=>v[t]:p).y(x?t=>x[t]:m).weight(f?t=>f[t]:1).size([y,g]).bandwidth(o),M=[];for(const t of a){const n=[];M.push(n);for(const e of h?_l(t,h,d):[t]){const t=$.contours(e);n.push([e,t])}}let L=i;if(!to(L)){let t=0;for(const n of M)for(const[,e]of n){const n=e.max;n>t&&(t=n)}L=Float64Array.from({length:i-1},((n,e)=>t*r*(e+1)/i))}const A=[],E=[];for(const t of M){const n=[];A.push(n);for(const[e,o]of t)for(const t of L){n.push(E.length),E.push(o(t/r)),b&&b.push(t),k&&k.push(t);for(const t in w)w[t].value.push(l[t].value[e[0]])}}return b&&b.push(0),k&&k.push(0),{data:t,facets:A,channels:{...w,...b&&{fill:{value:b,scale:"color"}},...k&&{stroke:{value:k,scale:"color"}},contours:{value:E}}}}))}({...l,fill:i,stroke:a},s,c),pd),s&&(this.fill=void 0),c&&(this.stroke=void 0),this.z=r}filter(t){return t}render(t,n,e,r,o){const{contours:i}=e,a=ae();return gr("svg:g",o).call(Pl,this,r,o).call(Yl,this,{}).call((n=>n.selectAll().data(t).enter().append("path").call(Ul,this).call(Fl,this,e).attr("d",(t=>a(i[t]))))).node()}}function yd(t,n={}){let{x:e,y:r,...o}=n;return[e,r]=ao(e,r),new md(t,{...o,x:e,y:r})}const gd=new Set(["x","y","z","weight"]);function vd(t){return/^density$/i.test(t)}const xd={ariaLabel:"geo",fill:"none",stroke:"currentColor",strokeWidth:1,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class wd extends xs{constructor(t,n={}){const[e,r]=Zr(n.r,3);super(t,{geometry:{value:n.geometry},r:{value:e,scale:"r",filter:Qo,optional:!0}},Ef(n),xd),this.r=r}render(t,n,e,r,o){const{geometry:i,r:a}=e,l=ae(o.projection??function({x:t,y:n}){if(t||n)return t??=t=>t,n??=t=>t,ie({point(e,r){this.stream.point(t(e),n(r))}})}(n)),{r:s}=this;return Xo(s)?t=[]:void 0!==s&&l.pointRadius(s),Ml("svg:g",o).call(Pl,this,r,o).call(Yl,this,n).call((n=>{n.selectAll().data(t).enter().append("path").call(Ul,this).attr("d",a?t=>l.pointRadius(a[t])(i[t]):t=>l(i[t])).call(Fl,this,e)})).node()}}function bd(t,{geometry:n=Br,...e}={}){switch(t?.type){case"FeatureCollection":t=t.features;break;case"GeometryCollection":t=t.geometries;break;case"Feature":case"LineString":case"MultiLineString":case"MultiPoint":case"MultiPolygon":case"Point":case"Polygon":case"Sphere":t=[t]}return new wd(t,{geometry:n,...e})}function kd({strokeWidth:t=1.5,...n}={}){return bd({type:"Sphere"},{strokeWidth:t,...n})}function $d({strokeOpacity:t=.1,...n}={}){return bd(xr(),{strokeOpacity:t,...n})}function Md(t={fill:"count"},{binWidth:n,...e}={}){n=void 0===n?20:_r(n),t=wi(t,e);const{z:r,fill:o,stroke:i}=e;return void 0===i&&Oo(o)&&xi(t,"fill")&&(e.stroke="none"),void 0===e.symbol&&(e.symbol="hexagon"),void 0!==e.r||xi(t,"r")||(e.r=n/2),ni(e,((e,o,i,a,l,s)=>{let{x:c,y:u,z:f,fill:h,stroke:d,symbol:p}=i;if(void 0===c)throw new Error("missing channel: x");if(void 0===u)throw new Error("missing channel: y");({x:c,y:u}=kl(i,a,s)),f=f?f.value:Tr(e,r),h=h?.value,d=d?.value,p=p?.value;const m=Li(t,{z:f,fill:h,stroke:d,symbol:p}),y=f&&[],g=h&&[],v=d&&[],x=p&&[],w=[],b=[],k=[];let $=-1;for(const n of t)n.initialize(e);for(const e of o){const r=[];for(const n of t)n.scope("facet",e);for(const[o,i]of $i(e,m))for(const e of Ld(i,c,u,n)){r.push(++$),b.push(e.x),k.push(e.y),f&&y.push(m===f?o:f[e[0]]),h&&g.push(m===h?o:h[e[0]]),d&&v.push(m===d?o:d[e[0]]),p&&x.push(m===p?o:p[e[0]]);for(const n of t)n.reduce(e)}w.push(r)}return{data:e,facets:w,channels:{x:{value:b},y:{value:k},...f&&{z:{value:y}},...h&&{fill:{value:g,scale:!0}},...d&&{stroke:{value:v,scale:!0}},...p&&{symbol:{value:x,scale:!0}},...Object.fromEntries(t.map((({name:t,output:e})=>[t,{scale:!0,radius:"r"===t?n/2:void 0,value:e.transform()}])))}}}))}function Ld(t,n,e,r){const o=r*(1.5/_o),i=new Map;for(const a of t){let t=n[a],l=e[a];if(isNaN(t)||isNaN(l))continue;let s=Math.round(l=(l-0)/o),c=Math.round(t=(t-.5)/r-(1&s)/2),u=l-s;if(3*Math.abs(u)>1){let n=t-c,e=c+(t<c?-1:1)/2,r=s+(l<s?-1:1),o=t-e,i=l-r;n*n+u*u>o*o+i*i&&(c=e+(1&s?1:-1)/2,s=r)}const f=`${c},${s}`;let h=i.get(f);void 0===h&&(i.set(f,h=[]),h.x=(c+(1&s)/2)*r+.5,h.y=s*o+0),h.push(a)}return i.values()}const Ad={ariaLabel:"hexgrid",fill:"none",stroke:"currentColor",strokeOpacity:.1};function Ed(t){return new zd(t)}class zd extends xs{constructor({binWidth:t=20,clip:n=!0,...e}={}){super(void 0,void 0,{clip:n,...e},Ad),this.binWidth=_r(t)}render(t,n,e,r,o){const{binWidth:i}=this,{marginTop:a,marginRight:l,marginBottom:s,marginLeft:c,width:u,height:f}=r,h=c-.5,d=u-l-.5,p=a-0,m=f-s-0,y=i/2,g=y*Io,v=g/2,x=2*y,w=1.5*g,b=Math.floor(h/x),k=Math.ceil(d/x),$=Math.floor((p+v)/w),M=Math.ceil((m-v)/w)+1,L=`m0,${Od(-g)}l${Od(y)},${Od(v)}v${Od(g)}l${Od(-y)},${Od(v)}`;let A=L;for(let t=$;t<M;++t)for(let n=b;n<k;++n)A+=`M${Od(n*x+(1&t)*y)},${Od(t*w)}${L}`;return Ml("svg:g",o).call(Pl,this,r,o).call(Yl,this,{},Rl+.5,Rl+0).call((t=>t.append("path").call(Ul,this).attr("d",A))).node()}}function Od(t){return Math.round(1e3*t)/1e3}const Nd={ariaLabel:"image",fill:null,stroke:null};class Sd extends xs{constructor(t,n={}){let{x:e,y:r,width:o,height:i,src:a,preserveAspectRatio:l,crossOrigin:s,frameAnchor:c,imageRendering:u}=n;void 0===o&&void 0!==i?o=i:void 0===i&&void 0!==o&&(i=o);const[f,h]="string"==typeof(d=a)&&(function(t){return/^\.*\//.test(t)}(d)||function(t){return/^(blob|data|file|http|https):/i.test(t)}(d))?[void 0,d]:[d,void 0];var d;const[p,m]=Zr(o,16),[y,g]=Zr(i,16);super(t,{x:{value:e,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},width:{value:p,filter:Qo,optional:!0},height:{value:y,filter:Qo,optional:!0},src:{value:f,optional:!0}},n,Nd),this.src=h,this.width=m,this.height=g,this.preserveAspectRatio=Zl(l,"xMidYMid"),this.crossOrigin=qr(s),this.frameAnchor=So(c),this.imageRendering=Zl(u,"auto")}render(t,n,e,r,o){const{x:i,y:a}=n,{x:l,y:s,width:c,height:u,src:f}=e,[h,d]=Xl(this,r);return Ml("svg:g",o).call(Pl,this,r,o).call(Yl,this,{x:l&&i,y:s&&a}).call((n=>n.selectAll().data(t).enter().append("image").call(Ul,this).attr("x",c&&l?t=>l[t]-c[t]/2:c?t=>h-c[t]/2:l?t=>l[t]-this.width/2:h-this.width/2).attr("y",u&&s?t=>s[t]-u[t]/2:u?t=>d-u[t]/2:s?t=>s[t]-this.height/2:d-this.height/2).attr("width",c?t=>c[t]:this.width).attr("height",u?t=>u[t]:this.height).call(Vl,"href",f?t=>f[t]:this.src).call(Vl,"preserveAspectRatio",this.preserveAspectRatio).call(Vl,"crossorigin",this.crossOrigin).call(Vl,"image-rendering",this.imageRendering).call(Fl,this,e))).node()}}function Cd(t,n={}){let{x:e,y:r,...o}=n;return void 0===n.frameAnchor&&([e,r]=ao(e,r)),new Sd(t,{...o,x:e,y:r})}function Rd(t,n,e){var r=0===t||1===t?0:Math.exp(jd(n+e)-jd(n)-jd(e)+n*Math.log(t)+e*Math.log(1-t));return!(t<0||t>1)&&(t<(n+1)/(n+e+2)?r*Td(t,n,e)/n:1-r*Td(1-t,e,n)/e)}function Td(t,n,e){var r,o,i,a,l=1e-30,s=1,c=n+e,u=n+1,f=n-1,h=1,d=1-c*t/u;for(Math.abs(d)<l&&(d=l),a=d=1/d;s<=100&&(d=1+(o=s*(e-s)*t/((f+(r=2*s))*(n+r)))*d,Math.abs(d)<l&&(d=l),h=1+o/h,Math.abs(h)<l&&(h=l),a*=(d=1/d)*h,d=1+(o=-(n+s)*(c+s)*t/((n+r)*(u+r)))*d,Math.abs(d)<l&&(d=l),h=1+o/h,Math.abs(h)<l&&(h=l),a*=i=(d=1/d)*h,!(Math.abs(i-1)<3e-7));s++);return a}function jd(t){var n,e,r,o=0,i=[76.18009172947146,-86.5053203294167,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],a=1.000000000190015;for(r=(e=n=t)+5.5,r-=(n+.5)*Math.log(r);o<6;o++)a+=i[o]/++e;return Math.log(2.506628274631*a/n)-r}function Wd(t,n){var e=function(t,n,e){var r,o,i,a,l,s,c,u,f,h,d=n-1,p=e-1,m=0;if(t<=0)return 0;if(t>=1)return 1;for(n>=1&&e>=1?(i=t<.5?t:1-t,s=(2.30753+.27061*(a=Math.sqrt(-2*Math.log(i))))/(1+a*(.99229+.04481*a))-a,t<.5&&(s=-s),c=(s*s-3)/6,u=2/(1/(2*n-1)+1/(2*e-1)),f=s*Math.sqrt(c+u)/u-(1/(2*e-1)-1/(2*n-1))*(c+5/6-2/(3*u)),s=n/(n+e*Math.exp(2*f))):(r=Math.log(n/(n+e)),o=Math.log(e/(n+e)),s=t<(a=Math.exp(n*r)/n)/(f=a+(l=Math.exp(e*o)/e))?Math.pow(n*f*t,1/n):1-Math.pow(e*f*(1-t),1/e)),h=-jd(n)-jd(e)+jd(n+e);m<10;m++){if(0===s||1===s)return s;if((s-=a=(l=(Rd(s,n,e)-t)/(a=Math.exp(d*Math.log(s)+p*Math.log(1-s)+h)))/(1-.5*Math.min(1,l*(d/s-p/(1-s)))))<=0&&(s=.5*(s+a)),s>=1&&(s=.5*(s+a+1)),Math.abs(a)<1e-8*s&&m>0)break}return s}(2*Math.min(t,1-t),.5*n,.5);return e=Math.sqrt(n*(1-e)/e),t>.5?e:-e}const Bd={ariaLabel:"linear-regression",fill:"currentColor",fillOpacity:.1,stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class Dd extends xs{constructor(t,n={}){const{x:e,y:r,z:o,ci:i=.95,precision:a=4}=n;if(super(t,{x:{value:e,scale:"x"},y:{value:r,scale:"y"},z:{value:lo(n),optional:!0}},n,Bd),this.z=o,this.ci=+i,this.precision=+a,!(0<=this.ci&&this.ci<1))throw new Error(`invalid ci; not in [0, 1): ${i}`);if(!(this.precision>0))throw new Error(`invalid precision: ${a}`)}render(t,n,e,r,o){const{x:i,y:a,z:l}=e,{ci:s}=this;return Ml("svg:g",o).call(Pl,this,r,o).call(Yl,this,n).call((n=>n.selectAll().data(l?_l(t,l,this.z):[t]).enter().call((t=>t.append("path").attr("fill","none").call(Ul,this).call(ql,this,{...e,fill:null,fillOpacity:null}).attr("d",(t=>this._renderLine(t,i,a))).call(s&&!No(this.fill)?t=>t.select(Fd).attr("stroke","none").call(Ul,this).call(ql,this,{...e,stroke:null,strokeOpacity:null,strokeWidth:null}).attr("d",(t=>this._renderBand(t,i,a))):()=>{}))))).node()}}function Fd(){return this.parentNode.insertBefore(this.ownerDocument.createElementNS(Me.svg,"path"),this)}class qd extends Dd{constructor(t,n){super(t,n)}_renderBand(t,n,e){const{ci:r,precision:o}=this,[i,a]=Bn(t,(t=>e[t])),l=Ud(t,e,n),s=Hd(t,e,n,(1-r)/2,l);return lr().y((t=>t)).x0((t=>s(t,-1))).x1((t=>s(t,1)))(O(i,a-o/2,o).concat(a))}_renderLine(t,n,e){const[r,o]=Bn(t,(t=>e[t])),i=Ud(t,e,n);return`M${i(r)},${r}L${i(o)},${o}`}}class _d extends Dd{constructor(t,n){super(t,n)}_renderBand(t,n,e){const{ci:r,precision:o}=this,[i,a]=Bn(t,(t=>n[t])),l=Ud(t,n,e),s=Hd(t,n,e,(1-r)/2,l);return lr().x((t=>t)).y0((t=>s(t,-1))).y1((t=>s(t,1)))(O(i,a-o/2,o).concat(a))}_renderLine(t,n,e){const[r,o]=Bn(t,(t=>n[t])),i=Ud(t,n,e);return`M${r},${i(r)}L${o},${i(o)}`}}function Id(t,n={}){const{y:e=Wr,x:r=Br,stroke:o,fill:i=(Oo(o)?"currentColor":o),...a}=n;return new qd(t,xu({...a,x:r,y:e,fill:i,stroke:o}))}function Pd(t,n={}){const{x:e=Wr,y:r=Br,stroke:o,fill:i=(Oo(o)?"currentColor":o),...a}=n;return new _d(t,vu({...a,x:e,y:r,fill:i,stroke:o}))}function Ud(t,n,e){let r=0,o=0,i=0,a=0;for(const l of t){const t=n[l],s=e[l];r+=t,o+=s,i+=t*s,a+=t*t}const l=t.length,s=(l*i-r*o)/(l*a-r*r),c=(o-s*r)/l;return t=>s*t+c}function Hd(t,n,e,r,o){const i=rt(t,(t=>n[t]))/t.length;let a=0,l=0;for(const r of t)a+=(n[r]-i)**2,l+=(e[r]-o(n[r]))**2;const s=Math.sqrt(l/(t.length-2)),c=Wd(r,t.length-2);return(n,e)=>{const r=o(n),l=s*Math.sqrt(1/t.length+(n-i)**2/a);return r+e*c*l}}function Vd(t={}){let{path:n=Br,delimiter:e,frameAnchor:r,treeLayout:o=br,treeSort:i,treeSeparation:a,treeAnchor:l,...s}=t;l=Zd(l),i=Kd(i),void 0===r&&(r=l.frameAnchor);const c=Xd(e),u=dp(s,np),[f,h]=ho(),[d,p]=ho();return{x:f,y:d,frameAnchor:r,...ti(s,((t,e)=>{const r=c(Tr(t,n)),s=h([]),f=p([]);let d=-1;const m=[],y=[],g=wr().path((t=>r[t])),v=o();v.nodeSize&&v.nodeSize([1,1]),v.separation&&void 0!==a&&v.separation(a??Dr);for(const t of u)t[hp]=t[up]([]);for(const n of e){const e=[],o=g(n.filter((t=>null!=r[t]))).each((n=>n.data=t[n.data]));null!=i&&o.sort(i),v(o);for(const t of o.descendants()){e.push(++d),m[d]=t.data,l.position(t,d,s,f);for(const n of u)n[hp][d]=n[fp](t)}y.push(e)}return{data:m,facets:y}})),...Object.fromEntries(u)}}function Yd(t={}){let{path:n=Br,delimiter:e,curve:r="bump-x",stroke:o="#555",strokeWidth:i=1.5,strokeOpacity:a=.5,treeLayout:l=br,treeSort:s,treeSeparation:c,treeAnchor:u,...f}=t;u=Zd(u),s=Kd(s),f={curve:r,stroke:o,strokeWidth:i,strokeOpacity:a,...f};const h=Xd(e),d=dp(f,ep),[p,m]=ho(),[y,g]=ho(),[v,x]=ho(),[w,b]=ho();return{x1:p,x2:y,y1:v,y2:w,...ti(f,((t,e)=>{const r=h(Tr(t,n)),o=m([]),i=g([]),a=x([]),f=b([]);let p=-1;const y=[],v=[],w=wr().path((t=>r[t])),k=l();k.nodeSize&&k.nodeSize([1,1]),k.separation&&void 0!==c&&k.separation(c??Dr);for(const t of d)t[hp]=t[up]([]);for(const n of e){const e=[],l=w(n.filter((t=>null!=r[t]))).each((n=>n.data=t[n.data]));null!=s&&l.sort(s),k(l);for(const{source:t,target:n}of l.links()){e.push(++p),y[p]=n.data,u.position(t,p,o,a),u.position(n,p,i,f);for(const e of d)e[hp][p]=e[fp](n,t)}v.push(e)}return{data:y,facets:v}})),...Object.fromEntries(d)}}function Zd(t="left"){switch(`${t}`.trim().toLowerCase()){case"left":return Gd;case"right":return Jd}throw new Error(`invalid tree anchor: ${t}`)}const Gd={frameAnchor:"left",dx:6,position({x:t,y:n},e,r,o){r[e]=n,o[e]=-t}},Jd={frameAnchor:"right",dx:-6,position({x:t,y:n},e,r,o){r[e]=-n,o[e]=-t}};function Kd(t){return null==t||"function"==typeof t?t:`${t}`.trim().toLowerCase().startsWith("node:")?Qd(np(t)):Qd(function(t){return n=>n.data?.[t]}(t))}function Qd(t){return(n,e)=>Zo(t(n),t(e))}function Xd(t="/"){return"/"==`${t}`?t=>t:n=>{return n.map((e=t,r="/",e=new RegExp(function(t){return`${t}`.replace(/[\\^$*+?.()|[\]{}]/g,"\\$&")}(e),"g"),t=>null==t?null:`${t}`.replace(e,r)));var e,r}}function tp(t){return no(t)&&"function"==typeof t.node}function np(t){if(tp(t))return t.node;if((t=`${t}`.trim().toLowerCase()).startsWith("node:")){switch(t){case"node:name":return op;case"node:path":return rp;case"node:internal":return lp;case"node:depth":return ip;case"node:height":return ap}throw new Error(`invalid node value: ${t}`)}}function ep(t){if(tp(t))return t.node;if(no(n=t)&&"function"==typeof n.link)return t.link;var n;if((t=`${t}`.trim().toLowerCase()).startsWith("node:")||t.startsWith("parent:")){switch(t){case"parent:name":return sp(op);case"parent:path":return sp(rp);case"parent:depth":return sp(ip);case"parent:height":return sp(ap);case"node:name":return op;case"node:path":return rp;case"node:internal":return lp;case"node:depth":return ip;case"node:height":return ap}throw new Error(`invalid link value: ${t}`)}}function rp(t){return t.id}function op(t){return function(t){let n=t.length;for(;--n>0&&!cp(t,n););return t.slice(n+1)}(t.id)}function ip(t){return t.depth}function ap(t){return t.height}function lp(t){return!!t.children}function sp(t){return(n,e)=>null==e?void 0:t(e)}function cp(t,n){if("/"===t[n]){let e=0;for(;n>0&&"\\"===t[--n];)++e;if(0==(1&e))return!0}return!1}const up=2,fp=3,hp=4;function dp(t,n){const e=[];for(const r in t){const o=t[r],i=n(o);void 0!==i&&e.push([r,...ho(o),i])}return e}function pp(t,n={}){let{fill:e,stroke:r,strokeWidth:o,strokeOpacity:i,strokeLinejoin:a,strokeLinecap:l,strokeMiterlimit:s,strokeDasharray:c,strokeDashoffset:u,marker:f,markerStart:h=f,markerEnd:d=f,dot:p=Oo(h)&&Oo(d),text:m="node:name",textStroke:y="white",title:g="node:path",dx:v,dy:x,...w}=n;return void 0===v&&(v=Zd(w.treeAnchor).dx),ws(wf(t,Yd({markerStart:h,markerEnd:d,stroke:void 0!==r?r:void 0===e?"node:internal":e,strokeWidth:o,strokeOpacity:i,strokeLinejoin:a,strokeLinecap:l,strokeMiterlimit:s,strokeDasharray:c,strokeDashoffset:u,...w})),p?Of(t,Vd({fill:void 0===e?"node:internal":e,title:g,...w})):null,null!=m?Us(t,Vd({text:m,fill:void 0===e?"currentColor":e,stroke:y,dx:v,dy:x,title:g,...w})):null)}function mp(t,n){return pp(t,{...n,treeLayout:kr})}function yp({geometry:t=Br,...n}={}){return ni({...n,x:null,y:null},((n,e,r,o,i,{projection:a})=>{const l=Tr(n,t),s=l.length,c=new Float64Array(s),u=new Float64Array(s),f=ae(a);for(let t=0;t<s;++t)[c[t],u[t]]=f.centroid(l[t]);return{data:n,facets:e,channels:{x:{value:c},y:{value:u}}}}))}function gp({geometry:t=Br,...n}={}){let e;return{...n,x:{transform:n=>Float64Array.from(e=Tr(Tr(n,t),$r),(([t])=>t))},y:{transform:()=>Float64Array.from(e,(([,t])=>t))}}}const vp=({marginLeft:t})=>[1,t],xp=({width:t,marginRight:n})=>[-1,t-n],wp=({width:t,marginLeft:n,marginRight:e})=>[0,(n+t-e)/2],bp=({marginTop:t})=>[1,t],kp=({height:t,marginBottom:n})=>[-1,t-n],$p=({height:t,marginTop:n,marginBottom:e})=>[0,(n+t-e)/2];function Mp(t){return"string"==typeof t?{anchor:t}:t}function Lp(t={},n={}){1===arguments.length&&([t,n]=Ep(t));let{anchor:e="left",padding:r=1}=Mp(t);switch(`${e}`.toLowerCase()){case"left":e=vp;break;case"right":e=xp;break;case"middle":e=wp;break;default:throw new Error(`unknown dodge anchor: ${e}`)}return zp("x","y",e,_r(r),n)}function Ap(t={},n={}){1===arguments.length&&([t,n]=Ep(t));let{anchor:e="bottom",padding:r=1}=Mp(t);switch(`${e}`.toLowerCase()){case"top":e=bp;break;case"bottom":e=kp;break;case"middle":e=$p;break;default:throw new Error(`unknown dodge anchor: ${e}`)}return zp("y","x",e,_r(r),n)}function Ep(t){const{anchor:n,padding:e,...r}=t;return[{anchor:n,padding:e},r]}function zp(t,n,e,r,o){const{r:i}=o;if(null!=i&&"number"!=typeof i){const{channels:t,sort:n,reverse:e}=o;o={...o,channels:{r:{value:i,scale:"r"},...Ro(t)}},void 0===n&&void 0===e&&(o.sort={channel:"r",order:"descending"})}return ni(o,(function(i,a,l,s,c,u){let{[n]:f,r:h}=l;if(!l[n])throw new Error(`missing channel: ${n}`);({[n]:f}=kl(l,s,u));const d=h?void 0:void 0!==this.r?this.r:void 0!==o.r?_r(o.r):3;h&&(h=sl(Tr(h.value,s[h.scale]||Br)));let[p,m]=e(c);const y=p?Np:Op,g=new Float64Array(f.length),v=h?t=>h[t]:()=>d;for(let t of a){const n=Er();t=t.filter(h?t=>Ko(f[t])&&Qo(h[t]):t=>Ko(f[t]));const e=new Float64Array(2*t.length+2);for(const o of t){const t=v(o),i=p?t+r:0,a=f[o]-t,l=f[o]+t;let s=2;n.queryInterval(a-r,l+r,(([,,t])=>{const n=g[t]-i,a=f[o]-f[t],l=r+(h?h[o]+h[t]:2*d),c=Math.sqrt(l*l-a*a);e[s++]=n-c,e[s++]=n+c}));let c=e.slice(0,s);p&&(c=c.filter((t=>t>=0)));t:for(const t of c.sort(y)){for(let n=0;n<s;n+=2)if(e[n]+1e-6<t&&t<e[n+1]-1e-6)continue t;g[o]=t+i;break}n.insert([a,l,o])}}p||(p=1);for(const t of a)for(const n of t)g[n]=g[n]*p+m;return{data:i,facets:a,channels:{[n]:{value:f},[t]:{value:g},...h&&{r:{value:h}}}}}))}function Op(t,n){return Math.abs(t)-Math.abs(n)}function Np(t,n){return t-n}function Sp(t,n){return 1===arguments.length&&({basis:t,...n}=t),uh(Rp(t),n)}function Cp(t,n){return 1===arguments.length&&({basis:t,...n}=t),fh(Rp(t),n)}function Rp(t){if(void 0===t)return Bp;if("function"==typeof t)return Tp(((n,e)=>t(co(e,n))));if(/^p\d{2}$/i.test(t))return jp(Vr(t));switch(`${t}`.toLowerCase()){case"deviation":return Fp;case"first":return Bp;case"last":return Dp;case"max":return qp;case"mean":return _p;case"median":return Ip;case"min":return Pp;case"sum":return Up;case"extent":return Wp}throw new Error(`invalid basis: ${t}`)}function Tp(t){return{map(n,e,r){const o=+t(n,e);for(const t of n)r[t]=null===e[t]?NaN:e[t]/o}}}function jp(t){return Tp(((n,e)=>t(n,(t=>e[t]))))}const Wp={map(t,n,e){const[r,o]=Bn(t,(t=>n[t])),i=o-r;for(const o of t)e[o]=null===n[o]?NaN:(n[o]-r)/i}},Bp=Tp(((t,n)=>{for(let e=0;e<t.length;++e){const r=n[t[e]];if(Yo(r))return r}})),Dp=Tp(((t,n)=>{for(let e=t.length-1;e>=0;--e){const r=n[t[e]];if(Yo(r))return r}})),Fp={map(t,n,e){const r=K(t,(t=>n[t])),o=et(t,(t=>n[t]));for(const i of t)e[i]=null===n[i]?NaN:o?(n[i]-r)/o:0}},qp=jp(X),_p=jp(K),Ip=jp(at),Pp=jp(nt),Up=jp(rt);function Hp(t={},n){return 1===arguments.length&&(n=t),uh(Yp(t),n)}function Vp(t={},n){return 1===arguments.length&&(n=t),fh(Yp(t),n)}function Yp(t={}){"number"==typeof t&&(t={k:t});let{k:n,reduce:e,shift:r,anchor:o,strict:i}=t;if(void 0===o&&void 0!==r&&(o=function(t){switch(`${t}`.toLowerCase()){case"centered":return"middle";case"leading":return"start";case"trailing":return"end"}throw new Error(`invalid shift: ${t}`)}(r),qa(`Warning: the shift option is deprecated; please use anchor "${o}" instead.`)),!((n=Math.floor(n))>0))throw new Error(`invalid k: ${n}`);return function(t="mean"){if("string"==typeof t){if(/^p\d{2}$/i.test(t))return Gp(Vr(t));switch(t.toLowerCase()){case"deviation":return Gp(et);case"max":return Jp(X);case"mean":return Qp;case"median":return Gp(at);case"min":return Jp(nt);case"mode":return Jp(G);case"sum":return Kp;case"variance":return Gp(J);case"difference":return rm;case"ratio":return om;case"first":return im;case"last":return am}}if("function"!=typeof t)throw new Error(`invalid reduce: ${t}`);return Jp(t)}(e)(n,function(t="middle",n){switch(`${t}`.toLowerCase()){case"middle":return n-1>>1;case"start":return 0;case"end":return n-1}throw new Error(`invalid anchor: ${t}`)}(o,n),i)}function Zp(t,n,e){return t.subarray?t.subarray(n,e):t.slice(n,e)}function Gp(t){return(n,e,r)=>r?{map(r,o,i){const a=Float64Array.from(r,(t=>null===o[t]?NaN:o[t]));let l=0;for(let t=0;t<n-1;++t)isNaN(a[t])&&++l;for(let o=0,s=r.length-n+1;o<s;++o)isNaN(a[o+n-1])&&++l,i[r[o+e]]=0===l?t(a.subarray(o,o+n)):NaN,isNaN(a[o])&&--l}}:{map(r,o,i){const a=Float64Array.from(r,(t=>null===o[t]?NaN:o[t]));for(let o=-e;o<0;++o)i[r[o+e]]=t(a.subarray(0,o+n));for(let o=0,l=r.length-e;o<l;++o)i[r[o+e]]=t(a.subarray(o,o+n))}}}function Jp(t){return(n,e,r)=>r?{map(r,o,i){let a=0;for(let t=0;t<n-1;++t)a+=Yo(o[r[t]]);for(let l=0,s=r.length-n+1;l<s;++l)a+=Yo(o[r[l+n-1]]),a===n&&(i[r[l+e]]=t(co(o,Zp(r,l,l+n)))),a-=Yo(o[r[l]])}}:{map(r,o,i){for(let a=-e;a<0;++a)i[r[a+e]]=t(co(o,Zp(r,0,a+n)));for(let a=0,l=r.length-e;a<l;++a)i[r[a+e]]=t(co(o,Zp(r,a,a+n)))}}}function Kp(t,n,e){return e?{map(e,r,o){let i=0,a=0;for(let n=0;n<t-1;++n){const t=r[e[n]];null===t||isNaN(t)?++i:a+=+t}for(let l=0,s=e.length-t+1;l<s;++l){const s=r[e[l]],c=r[e[l+t-1]];null===c||isNaN(c)?++i:a+=+c,o[e[l+n]]=0===i?a:NaN,null===s||isNaN(s)?--i:a-=+s}}}:{map(e,r,o){let i=0;const a=e.length;for(let o=0,l=Math.min(a,t-n-1);o<l;++o)i+=+r[e[o]]||0;for(let l=-n,s=a-n;l<s;++l)i+=+r[e[l+t-1]]||0,o[e[l+n]]=i,i-=+r[e[l]]||0}}}function Qp(t,n,e){if(e){const r=Kp(t,n,e);return{map(e,o,i){r.map(e,o,i);for(let r=0,o=e.length-t+1;r<o;++r)i[e[r+n]]/=t}}}return{map(e,r,o){let i=0,a=0;const l=e.length;for(let o=0,s=Math.min(l,t-n-1);o<s;++o){let t=r[e[o]];null===t||isNaN(t=+t)||(i+=t,++a)}for(let s=-n,c=l-n;s<c;++s){let l=r[e[s+t-1]],c=r[e[s]];null===l||isNaN(l=+l)||(i+=l,++a),o[e[s+n]]=i/a,null===c||isNaN(c=+c)||(i-=c,--a)}}}}function Xp(t,n,e,r){for(let o=e+r;e<o;++e){const r=t[n[e]];if(Yo(r))return r}}function tm(t,n,e,r){for(let o=e+r-1;o>=e;--o){const e=t[n[o]];if(Yo(e))return e}}function nm(t,n,e,r){for(let o=e+r;e<o;++e){let r=t[n[e]];if(null!==r&&!isNaN(r=+r))return r}}function em(t,n,e,r){for(let o=e+r-1;o>=e;--o){let e=t[n[o]];if(null!==e&&!isNaN(e=+e))return e}}function rm(t,n,e){return e?{map(e,r,o){for(let i=0,a=e.length-t;i<a;++i){const a=r[e[i]],l=r[e[i+t-1]];o[e[i+n]]=null===a||null===l?NaN:l-a}}}:{map(e,r,o){for(let i=-n,a=e.length-t+n+1;i<a;++i)o[e[i+n]]=em(r,e,i,t)-nm(r,e,i,t)}}}function om(t,n,e){return e?{map(e,r,o){for(let i=0,a=e.length-t;i<a;++i){const a=r[e[i]],l=r[e[i+t-1]];o[e[i+n]]=null===a||null===l?NaN:l/a}}}:{map(e,r,o){for(let i=-n,a=e.length-t+n+1;i<a;++i)o[e[i+n]]=em(r,e,i,t)/nm(r,e,i,t)}}}function im(t,n,e){return e?{map(e,r,o){for(let i=0,a=e.length-t;i<a;++i)o[e[i+n]]=r[e[i]]}}:{map(e,r,o){for(let i=-n,a=e.length-t+n+1;i<a;++i)o[e[i+n]]=Xp(r,e,i,t)}}}function am(t,n,e){return e?{map(e,r,o){for(let i=0,a=e.length-t;i<a;++i)o[e[i+n]]=r[e[i+t-1]]}}:{map(e,r,o){for(let i=-n,a=e.length-t+n+1;i<a;++i)o[e[i+n]]=tm(r,e,i,t)}}}function lm(t,n={}){if("string"==typeof t)switch(t.toLowerCase()){case"first":return cm(n);case"last":return um(n)}if("function"==typeof t)return xm(null,t,n);let e,r;for(e in t){if(void 0!==r)throw new Error("ambiguous selector; multiple inputs");r=sm(t[e])}if(void 0===r)throw new Error(`invalid selector: ${t}`);return xm(e,r,n)}function sm(t){if("function"==typeof t)return t;switch(`${t}`.toLowerCase()){case"min":return gm;case"max":return vm}throw new Error(`unknown selector: ${t}`)}function cm(t){return xm(null,mm,t)}function um(t){return xm(null,ym,t)}function fm(t){return xm("x",gm,t)}function hm(t){return xm("y",gm,t)}function dm(t){return xm("x",vm,t)}function pm(t){return xm("y",vm,t)}function*mm(t){yield t[0]}function*ym(t){yield t[t.length-1]}function*gm(t,n){yield Mr(t,(t=>n[t]))}function*vm(t,n){yield ar(t,(t=>n[t]))}function xm(t,n,e){if(null!=t){if(null==e[t])throw new Error(`missing channel: ${t}`);t=e[t]}const r=lo(e);return ti(e,((e,o)=>{const i=Tr(e,r),a=Tr(e,t),l=[];for(const t of o){const e=[];for(const r of i?Z(t,(t=>i[t])).values():[t])for(const t of n(r,a))e.push(t);l.push(e)}return{data:e,facets:l}}))}export{rf as Area,$f as Arrow,_f as BarX,If as BarY,Kf as Cell,Yh as Contour,md as Density,zf as Dot,Yc as Frame,wd as Geo,zd as Hexgrid,Sd as Image,jf as Line,xf as Link,xs as Mark,jh as Raster,Vf as Rect,js as RuleX,Ws as RuleY,Is as Text,wh as TickX,bh as TickY,hc as Vector,of as area,af as areaX,lf as areaY,Lf as arrow,eh as auto,nh as autoSpec,Ac as axisFx,Mc as axisFy,Lc as axisX,$c as axisY,Pf as barX,Uf as barY,yu as bin,pu as binX,mu as binY,Mh as boxX,Lh as boxY,Qf as cell,Xf as cellX,th as cellY,yp as centroid,Cf as circle,mp as cluster,ho as column,Zh as contour,cd as delaunayLink,ud as delaunayMesh,yd as density,Lp as dodgeX,Ap as dodgeY,Of as dot,Nf as dotX,Sf as dotY,ii as filter,Sl as formatIsoDate,Ol as formatMonth,Nl as formatWeekday,Zc as frame,bd as geo,gp as geoCentroid,$d as graticule,Cc as gridFx,Nc as gridFy,Sc as gridX,Oc as gridY,gi as group,mi as groupX,yi as groupY,pi as groupZ,Rf as hexagon,Md as hexbin,Ed as hexgrid,fd as hull,Br as identity,Cd as image,ni as initializer,Ph as interpolateNearest,_h as interpolateNone,Ih as interpolatorBarycentric,Uh as interpolatorRandomWalk,ms as legend,Wf as line,Bf as lineX,Df as lineY,Id as linearRegressionX,Pd as linearRegressionY,wf as link,hh as map,uh as mapX,fh as mapY,ws as marks,Rp as normalize,Sp as normalizeX,Cp as normalizeY,Gc as plot,Bh as raster,Yf as rect,Zf as rectX,Gf as rectY,li as reverse,Bs as ruleX,Ds as ruleY,fl as scale,lm as select,cm as selectFirst,um as selectLast,dm as selectMaxX,pm as selectMaxY,fm as selectMinX,hm as selectMinY,ci as shuffle,ui as sort,kd as sphere,yc as spike,Cu as stackX,Ru as stackX1,Tu as stackX2,ju as stackY,Wu as stackY1,Bu as stackY2,Us as text,Hs as textX,Vs as textY,kh as tickX,$h as tickY,ti as transform,pp as tree,Yd as treeLink,Vd as treeNode,Tr as valueof,dc as vector,pc as vectorX,mc as vectorY,hd as voronoi,dd as voronoiMesh,Yp as window,Hp as windowX,Vp as windowY};export default null;
//# sourceMappingURL=/sm/0904f0e4bc42ead3bef318fddc4ef90c8b1a43330a472040629ef1dfd832cc52.map