/**
 * Bundled by jsDelivr using Rollup v2.74.1 and Terser v5.15.1.
 * Original file: /npm/d3-brush@3.0.0/src/index.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{dispatch as t}from"/npm/d3-dispatch@3.0.1/+esm";import{dragDisable as e,dragEnable as n}from"/npm/d3-drag@3.0.0/+esm";import{interpolate as r}from"/npm/d3-interpolate@3.0.1/+esm";import{select as s,pointer as i}from"/npm/d3-selection@3.0.0/+esm";import{interrupt as u}from"/npm/d3-transition@3.0.1/+esm";var o=t=>()=>t;function a(t,{sourceEvent:e,target:n,selection:r,mode:s,dispatch:i}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},selection:{value:r,enumerable:!0,configurable:!0},mode:{value:s,enumerable:!0,configurable:!0},_:{value:i}})}function l(t){t.stopImmediatePropagation()}function c(t){t.preventDefault(),t.stopImmediatePropagation()}var h={name:"drag"},f={name:"space"},p={name:"handle"},m={name:"center"};const{abs:d,max:v,min:y}=Math;function b(t){return[+t[0],+t[1]]}function w(t){return[b(t[0]),b(t[1])]}var g={name:"x",handles:["w","e"].map(P),input:function(t,e){return null==t?null:[[+t[0],e[0][1]],[+t[1],e[1][1]]]},output:function(t){return t&&[t[0][0],t[1][0]]}},_={name:"y",handles:["n","s"].map(P),input:function(t,e){return null==t?null:[[e[0][0],+t[0]],[e[1][0],+t[1]]]},output:function(t){return t&&[t[0][1],t[1][1]]}},x={name:"xy",handles:["n","w","e","s","nw","ne","sw","se"].map(P),input:function(t){return null==t?null:w(t)},output:function(t){return t}},k={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},z={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},A={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},E={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},K={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function P(t){return{type:t}}function T(t){return!t.ctrlKey&&!t.button}function V(){var t=this.ownerSVGElement||this;return t.hasAttribute("viewBox")?[[(t=t.viewBox.baseVal).x,t.y],[t.x+t.width,t.y+t.height]]:[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]}function B(){return navigator.maxTouchPoints||"ontouchstart"in this}function C(t){for(;!t.__brush;)if(!(t=t.parentNode))return;return t.__brush}function I(t){return t[0][0]===t[1][0]||t[0][1]===t[1][1]}function M(t){var e=t.__brush;return e?e.dim.output(e.selection):null}function S(){return G(g)}function j(){return G(_)}function D(){return G(x)}function G(b){var x,M=V,S=T,j=B,D=!0,G=t("start","brush","end"),N=6;function O(t){var e=t.property("__brush",R).selectAll(".overlay").data([P("overlay")]);e.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",k.overlay).merge(e).each((function(){var t=C(this).extent;s(this).attr("x",t[0][0]).attr("y",t[0][1]).attr("width",t[1][0]-t[0][0]).attr("height",t[1][1]-t[0][1])})),t.selectAll(".selection").data([P("selection")]).enter().append("rect").attr("class","selection").attr("cursor",k.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var n=t.selectAll(".handle").data(b.handles,(function(t){return t.type}));n.exit().remove(),n.enter().append("rect").attr("class",(function(t){return"handle handle--"+t.type})).attr("cursor",(function(t){return k[t.type]})),t.each(q).attr("fill","none").attr("pointer-events","all").on("mousedown.brush",J).filter(j).on("touchstart.brush",J).on("touchmove.brush",L).on("touchend.brush touchcancel.brush",Q).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function q(){var t=s(this),e=C(this).selection;e?(t.selectAll(".selection").style("display",null).attr("x",e[0][0]).attr("y",e[0][1]).attr("width",e[1][0]-e[0][0]).attr("height",e[1][1]-e[0][1]),t.selectAll(".handle").style("display",null).attr("x",(function(t){return"e"===t.type[t.type.length-1]?e[1][0]-N/2:e[0][0]-N/2})).attr("y",(function(t){return"s"===t.type[0]?e[1][1]-N/2:e[0][1]-N/2})).attr("width",(function(t){return"n"===t.type||"s"===t.type?e[1][0]-e[0][0]+N:N})).attr("height",(function(t){return"e"===t.type||"w"===t.type?e[1][1]-e[0][1]+N:N}))):t.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function F(t,e,n){var r=t.__brush.emitter;return!r||n&&r.clean?new H(t,e,n):r}function H(t,e,n){this.that=t,this.args=e,this.state=t.__brush,this.active=0,this.clean=n}function J(t){if((!x||t.touches)&&S.apply(this,arguments)){var r,o,a,w,P,T,V,B,M,j,G,N=this,O=t.target.__data__.type,H="selection"===(D&&t.metaKey?O="overlay":O)?h:D&&t.altKey?m:p,J=b===_?null:E[O],L=b===g?null:K[O],Q=C(N),R=Q.extent,U=Q.selection,W=R[0][0],X=R[0][1],Y=R[1][0],Z=R[1][1],$=0,tt=0,et=J&&L&&D&&t.shiftKey,nt=Array.from(t.touches||[t],(t=>{const e=t.identifier;return(t=i(t,N)).point0=t.slice(),t.identifier=e,t}));u(N);var rt=F(N,arguments,!0).beforestart();if("overlay"===O){U&&(M=!0);const e=[nt[0],nt[1]||nt[0]];Q.selection=U=[[r=b===_?W:y(e[0][0],e[1][0]),a=b===g?X:y(e[0][1],e[1][1])],[P=b===_?Y:v(e[0][0],e[1][0]),V=b===g?Z:v(e[0][1],e[1][1])]],nt.length>1&&at(t)}else r=U[0][0],a=U[0][1],P=U[1][0],V=U[1][1];o=r,w=a,T=P,B=V;var st=s(N).attr("pointer-events","none"),it=st.selectAll(".overlay").attr("cursor",k[O]);if(t.touches)rt.moved=ot,rt.ended=lt;else{var ut=s(t.view).on("mousemove.brush",ot,!0).on("mouseup.brush",lt,!0);D&&ut.on("keydown.brush",ct,!0).on("keyup.brush",ht,!0),e(t.view)}q.call(N),rt.start(t,H.name)}function ot(t){for(const e of t.changedTouches||[t])for(const t of nt)t.identifier===e.identifier&&(t.cur=i(e,N));if(et&&!j&&!G&&1===nt.length){const t=nt[0];d(t.cur[0]-t[0])>d(t.cur[1]-t[1])?G=!0:j=!0}for(const t of nt)t.cur&&(t[0]=t.cur[0],t[1]=t.cur[1]);M=!0,c(t),at(t)}function at(t){const e=nt[0],n=e.point0;var s;switch($=e[0]-n[0],tt=e[1]-n[1],H){case f:case h:J&&($=v(W-r,y(Y-P,$)),o=r+$,T=P+$),L&&(tt=v(X-a,y(Z-V,tt)),w=a+tt,B=V+tt);break;case p:nt[1]?(J&&(o=v(W,y(Y,nt[0][0])),T=v(W,y(Y,nt[1][0])),J=1),L&&(w=v(X,y(Z,nt[0][1])),B=v(X,y(Z,nt[1][1])),L=1)):(J<0?($=v(W-r,y(Y-r,$)),o=r+$,T=P):J>0&&($=v(W-P,y(Y-P,$)),o=r,T=P+$),L<0?(tt=v(X-a,y(Z-a,tt)),w=a+tt,B=V):L>0&&(tt=v(X-V,y(Z-V,tt)),w=a,B=V+tt));break;case m:J&&(o=v(W,y(Y,r-$*J)),T=v(W,y(Y,P+$*J))),L&&(w=v(X,y(Z,a-tt*L)),B=v(X,y(Z,V+tt*L)))}T<o&&(J*=-1,s=r,r=P,P=s,s=o,o=T,T=s,O in z&&it.attr("cursor",k[O=z[O]])),B<w&&(L*=-1,s=a,a=V,V=s,s=w,w=B,B=s,O in A&&it.attr("cursor",k[O=A[O]])),Q.selection&&(U=Q.selection),j&&(o=U[0][0],T=U[1][0]),G&&(w=U[0][1],B=U[1][1]),U[0][0]===o&&U[0][1]===w&&U[1][0]===T&&U[1][1]===B||(Q.selection=[[o,w],[T,B]],q.call(N),rt.brush(t,H.name))}function lt(t){if(l(t),t.touches){if(t.touches.length)return;x&&clearTimeout(x),x=setTimeout((function(){x=null}),500)}else n(t.view,M),ut.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);st.attr("pointer-events","all"),it.attr("cursor",k.overlay),Q.selection&&(U=Q.selection),I(U)&&(Q.selection=null,q.call(N)),rt.end(t,H.name)}function ct(t){switch(t.keyCode){case 16:et=J&&L;break;case 18:H===p&&(J&&(P=T-$*J,r=o+$*J),L&&(V=B-tt*L,a=w+tt*L),H=m,at(t));break;case 32:H!==p&&H!==m||(J<0?P=T-$:J>0&&(r=o-$),L<0?V=B-tt:L>0&&(a=w-tt),H=f,it.attr("cursor",k.selection),at(t));break;default:return}c(t)}function ht(t){switch(t.keyCode){case 16:et&&(j=G=et=!1,at(t));break;case 18:H===m&&(J<0?P=T:J>0&&(r=o),L<0?V=B:L>0&&(a=w),H=p,at(t));break;case 32:H===f&&(t.altKey?(J&&(P=T-$*J,r=o+$*J),L&&(V=B-tt*L,a=w+tt*L),H=m):(J<0?P=T:J>0&&(r=o),L<0?V=B:L>0&&(a=w),H=p),it.attr("cursor",k[O]),at(t));break;default:return}c(t)}}function L(t){F(this,arguments).moved(t)}function Q(t){F(this,arguments).ended(t)}function R(){var t=this.__brush||{selection:null};return t.extent=w(M.apply(this,arguments)),t.dim=b,t}return O.move=function(t,e,n){t.tween?t.on("start.brush",(function(t){F(this,arguments).beforestart().start(t)})).on("interrupt.brush end.brush",(function(t){F(this,arguments).end(t)})).tween("brush",(function(){var t=this,n=t.__brush,s=F(t,arguments),i=n.selection,u=b.input("function"==typeof e?e.apply(this,arguments):e,n.extent),o=r(i,u);function a(e){n.selection=1===e&&null===u?null:o(e),q.call(t),s.brush()}return null!==i&&null!==u?a:a(1)})):t.each((function(){var t=this,r=arguments,s=t.__brush,i=b.input("function"==typeof e?e.apply(t,r):e,s.extent),o=F(t,r).beforestart();u(t),s.selection=null===i?null:i,q.call(t),o.start(n).brush(n).end(n)}))},O.clear=function(t,e){O.move(t,null,e)},H.prototype={beforestart:function(){return 1==++this.active&&(this.state.emitter=this,this.starting=!0),this},start:function(t,e){return this.starting?(this.starting=!1,this.emit("start",t,e)):this.emit("brush",t),this},brush:function(t,e){return this.emit("brush",t,e),this},end:function(t,e){return 0==--this.active&&(delete this.state.emitter,this.emit("end",t,e)),this},emit:function(t,e,n){var r=s(this.that).datum();G.call(t,this.that,new a(t,{sourceEvent:e,target:O,selection:b.output(this.state.selection),mode:n,dispatch:G}),r)}},O.extent=function(t){return arguments.length?(M="function"==typeof t?t:o(w(t)),O):M},O.filter=function(t){return arguments.length?(S="function"==typeof t?t:o(!!t),O):S},O.touchable=function(t){return arguments.length?(j="function"==typeof t?t:o(!!t),O):j},O.handleSize=function(t){return arguments.length?(N=+t,O):N},O.keyModifiers=function(t){return arguments.length?(D=!!t,O):D},O.on=function(){var t=G.on.apply(G,arguments);return t===G?O:t},O}export{D as brush,M as brushSelection,S as brushX,j as brushY};export default null;
//# sourceMappingURL=/sm/e797d759f34497cbc9ff12a1ae6197d1942b9136fbe8acf127d98439c5d7c6d6.map